;; -*- lexical-binding: t -*-
;; Local Variables:
;; byte-compile-warnings: (not redefine callargs free-vars unresolved obsolete noruntime cl-functions interactive-only make-local mapcar constants suspicious lexical)
;; End:
(require 'shen-primitives)
(setq max-lisp-eval-depth 60000)
(setq max-specpdl-size 13000)
(defun shen/shen\.shen nil
  (shen/do
   (shen/shen\.credits)
   (shen/shen\.loop)))
(defun shen/shen\.loop nil
  (cl-flet
      ((tail-trampoline nil
                        (shen/do
                         (shen/shen\.initialise_environment)
                         (shen/do
                          (shen/shen\.prompt)
                          (shen/do
                           (shen/trap-error
                            (shen/shen\.read-evaluate-print)
                            (shen/lambda E
                                         (shen/pr
                                          (shen/error-to-string E)
                                          (shen/stoutput))))
                           (vector
                            (list)))))))
    (let
        ((result
          (funcall #'tail-trampoline)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.credits nil
  (shen/do
   (shen/shen\.prhush "\nShen, copyright (C) 2010-2015 Mark Tarver\n"
                      (shen/stoutput))
   (shen/do
    (shen/shen\.prhush
     (shen/cn "www.shenlanguage.org, "
              (shen/shen\.app
               (shen/value '*version*)
               "\n" 'shen\.a))
     (shen/stoutput))
    (shen/do
     (shen/shen\.prhush
      (shen/cn "running under "
               (shen/shen\.app
                (shen/value '*language*)
                (shen/cn ", implementation: "
                         (shen/shen\.app
                          (shen/value '*implementation*)
                          "" 'shen\.a))
                'shen\.a))
      (shen/stoutput))
     (shen/shen\.prhush
      (shen/cn "\nport "
               (shen/shen\.app
                (shen/value '*port*)
                (shen/cn " ported by "
                         (shen/shen\.app
                          (shen/value '*porters*)
                          "\n" 'shen\.a))
                'shen\.a))
      (shen/stoutput))))))
(defun shen/shen\.initialise_environment nil
  (shen/shen\.multiple-set
   (list 'shen\.*call* 0 'shen\.*infs* 0 'shen\.*process-counter* 0 'shen\.*catch* 0)))
(defun shen/shen\.multiple-set
    (V15590)
  (cl-flet
      ((tail-trampoline
        (V15590)
        (shen/cond
         ((shen/predicate->shen
           (null V15590))
          nil)
         ((shen/and
           (shen/cons\? V15590)
           (shen/cons\?
            (nthcdr 1 V15590)))
          (shen/do
           (shen/set
            (shen/hd V15590)
            (shen/hd
             (nthcdr 1 V15590)))
           (vector
            (list
             (nthcdr 2 V15590)))))
         (shen/true
          (shen/shen\.f_error 'shen\.multiple-set)))))
    (let
        ((result
          (funcall #'tail-trampoline V15590)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/destroy
    (V15592)
  (shen/declare V15592 'symbol))
(shen/set 'shen\.*history* nil)
(defun shen/shen\.read-evaluate-print nil
  (shen/let Lineread
            (shen/shen\.toplineread)
            (shen/let History
                      (shen/value 'shen\.*history*)
                      (shen/let NewLineread
                                (shen/shen\.retrieve-from-history-if-needed Lineread History)
                                (shen/let NewHistory
                                          (shen/shen\.update_history NewLineread History)
                                          (shen/let Parsed
                                                    (shen/fst NewLineread)
                                                    (shen/shen\.toplevel Parsed)))))))
(defun shen/shen\.retrieve-from-history-if-needed
    (V15604 V15605)
  (cl-flet
      ((tail-trampoline
        (V15604 V15605)
        (shen/cond
         ((shen/and
           (shen/tuple\? V15604)
           (shen/and
            (shen/cons\?
             (shen/snd V15604))
            (shen/element\?
             (shen/hd
              (shen/snd V15604))
             (list
              (shen/shen\.space)
              (shen/shen\.newline)))))
          (vector
           (list
            (shen/@p
             (shen/fst V15604)
             (nthcdr 1
                     (shen/snd V15604)))
            V15605)))
         ((shen/and
           (shen/tuple\? V15604)
           (shen/and
            (shen/cons\?
             (shen/snd V15604))
            (shen/and
             (shen/cons\?
              (nthcdr 1
                      (shen/snd V15604)))
             (shen/and
              (shen/predicate->shen
               (null
                (nthcdr 2
                        (shen/snd V15604))))
              (shen/and
               (shen/cons\? V15605)
               (shen/and
                (shen/=
                 (shen/hd
                  (shen/snd V15604))
                 (shen/shen\.exclamation))
                (shen/=
                 (shen/hd
                  (nthcdr 1
                          (shen/snd V15604)))
                 (shen/shen\.exclamation))))))))
          (shen/let PastPrint
                    (shen/shen\.prbytes
                     (shen/snd
                      (shen/hd V15605)))
                    (shen/hd V15605)))
         ((shen/and
           (shen/tuple\? V15604)
           (shen/and
            (shen/cons\?
             (shen/snd V15604))
            (shen/=
             (shen/hd
              (shen/snd V15604))
             (shen/shen\.exclamation))))
          (shen/let Key\?
                    (shen/shen\.make-key
                     (nthcdr 1
                             (shen/snd V15604))
                     V15605)
                    (shen/let Find
                              (shen/head
                               (shen/shen\.find-past-inputs Key\? V15605))
                              (shen/let PastPrint
                                        (shen/shen\.prbytes
                                         (shen/snd Find))
                                        Find))))
         ((shen/and
           (shen/tuple\? V15604)
           (shen/and
            (shen/cons\?
             (shen/snd V15604))
            (shen/and
             (shen/predicate->shen
              (null
               (nthcdr 1
                       (shen/snd V15604))))
             (shen/=
              (shen/hd
               (shen/snd V15604))
              (shen/shen\.percent)))))
          (shen/do
           (shen/shen\.print-past-inputs
            (shen/lambda X 'true)
            (shen/reverse V15605)
            0)
           (shen/abort)))
         ((shen/and
           (shen/tuple\? V15604)
           (shen/and
            (shen/cons\?
             (shen/snd V15604))
            (shen/=
             (shen/hd
              (shen/snd V15604))
             (shen/shen\.percent))))
          (shen/let Key\?
                    (shen/shen\.make-key
                     (nthcdr 1
                             (shen/snd V15604))
                     V15605)
                    (shen/let Pastprint
                              (shen/shen\.print-past-inputs Key\?
                                                            (shen/reverse V15605)
                                                            0)
                              (shen/abort))))
         (shen/true V15604))))
    (let
        ((result
          (funcall #'tail-trampoline V15604 V15605)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.percent nil 37)
(defun shen/shen\.exclamation nil 33)
(defun shen/shen\.prbytes
    (V15607)
  (shen/do
   (shen/map
    (shen/lambda Byte
                 (shen/pr
                  (shen/n->string Byte)
                  (shen/stoutput)))
    V15607)
   (shen/nl 1)))
(defun shen/shen\.update_history
    (V15610 V15611)
  (shen/set 'shen\.*history*
            (append
             (list V15610)
             V15611)))
(defun shen/shen\.toplineread nil
  (shen/shen\.toplineread_loop
   (shen/read-byte
    (shen/stinput))
   nil))
(defun shen/shen\.toplineread_loop
    (V15615 V15616)
  (cl-flet
      ((tail-trampoline
        (V15615 V15616)
        (shen/cond
         ((shen/= V15615
                  (shen/shen\.hat))
          (shen/simple-error "line read aborted"))
         ((shen/element\? V15615
                          (list
                           (shen/shen\.newline)
                           (shen/shen\.carriage-return)))
          (shen/let Line
                    (shen/compile
                     (shen/lambda X
                                  (shen/shen\.<st_input> X))
                     V15616
                     (shen/lambda E 'shen\.nextline))
                    (shen/let It
                              (shen/shen\.record-it V15616)
                              (shen/if
                               (shen/or
                                (shen/= Line 'shen\.nextline)
                                (shen/empty\? Line))
                               (vector
                                (list
                                 (shen/read-byte
                                  (shen/stinput))
                                 (shen/append V15616
                                              (list V15615))))
                               (shen/@p Line V15616)))))
         (shen/true
          (vector
           (list
            (shen/read-byte
             (shen/stinput))
            (shen/append V15616
                         (list V15615))))))))
    (let
        ((result
          (funcall #'tail-trampoline V15615 V15616)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.hat nil 94)
(defun shen/shen\.newline nil 10)
(defun shen/shen\.carriage-return nil 13)
(defun shen/tc
    (V15622)
  (shen/cond
   ((shen/= '+ V15622)
    (shen/set 'shen\.*tc* 'true))
   ((shen/= '- V15622)
    (shen/set 'shen\.*tc* 'false))
   (shen/true
    (shen/simple-error "tc expects a + or -"))))
(defun shen/shen\.prompt nil
  (shen/if
   (shen/value 'shen\.*tc*)
   (shen/shen\.prhush
    (shen/cn "\n\n("
             (shen/shen\.app
              (shen/length
               (shen/value 'shen\.*history*))
              "+) " 'shen\.a))
    (shen/stoutput))
   (shen/shen\.prhush
    (shen/cn "\n\n("
             (shen/shen\.app
              (shen/length
               (shen/value 'shen\.*history*))
              "-) " 'shen\.a))
    (shen/stoutput))))
(defun shen/shen\.toplevel
    (V15624)
  (shen/shen\.toplevel_evaluate V15624
                                (shen/value 'shen\.*tc*)))
(defun shen/shen\.find-past-inputs
    (V15627 V15628)
  (shen/let F
            (shen/shen\.find V15627 V15628)
            (shen/if
             (shen/empty\? F)
             (shen/simple-error "input not found\n")
             F)))
(defun shen/shen\.make-key
    (V15631 V15632)
  (shen/let Atom
            (shen/hd
             (shen/compile
              (shen/lambda X
                           (shen/shen\.<st_input> X))
              V15631
              (shen/lambda E
                           (shen/if
                            (shen/cons\? E)
                            (shen/simple-error
                             (shen/cn "parse error here: "
                                      (shen/shen\.app E "\n" 'shen\.s)))
                            (shen/simple-error "parse error\n")))))
            (shen/if
             (shen/integer\? Atom)
             (shen/lambda X
                          (shen/= X
                                  (shen/nth
                                   (1+ Atom)
                                   (shen/reverse V15632))))
             (shen/lambda X
                          (shen/shen\.prefix\? V15631
                                               (shen/shen\.trim-gubbins
                                                (shen/snd X)))))))
(defun shen/shen\.trim-gubbins
    (V15634)
  (cl-flet
      ((tail-trampoline
        (V15634)
        (shen/cond
         ((shen/and
           (shen/cons\? V15634)
           (shen/=
            (shen/hd V15634)
            (shen/shen\.space)))
          (vector
           (list
            (nthcdr 1 V15634))))
         ((shen/and
           (shen/cons\? V15634)
           (shen/=
            (shen/hd V15634)
            (shen/shen\.newline)))
          (vector
           (list
            (nthcdr 1 V15634))))
         ((shen/and
           (shen/cons\? V15634)
           (shen/=
            (shen/hd V15634)
            (shen/shen\.carriage-return)))
          (vector
           (list
            (nthcdr 1 V15634))))
         ((shen/and
           (shen/cons\? V15634)
           (shen/=
            (shen/hd V15634)
            (shen/shen\.tab)))
          (vector
           (list
            (nthcdr 1 V15634))))
         ((shen/and
           (shen/cons\? V15634)
           (shen/=
            (shen/hd V15634)
            (shen/shen\.left-round)))
          (vector
           (list
            (nthcdr 1 V15634))))
         (shen/true V15634))))
    (let
        ((result
          (funcall #'tail-trampoline V15634)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.space nil 32)
(defun shen/shen\.tab nil 9)
(defun shen/shen\.left-round nil 40)
(defun shen/shen\.find
    (V15643 V15644)
  (cl-flet
      ((tail-trampoline
        (V15643 V15644)
        (shen/cond
         ((shen/predicate->shen
           (null V15644))
          nil)
         ((shen/and
           (shen/cons\? V15644)
           (shen/internal/apply-higher-order-function V15643
                                                      (list
                                                       (shen/hd V15644))))
          (append
           (list
            (shen/hd V15644))
           (shen/shen\.find V15643
                            (nthcdr 1 V15644))))
         ((shen/cons\? V15644)
          (vector
           (list V15643
                 (nthcdr 1 V15644))))
         (shen/true
          (shen/shen\.f_error 'shen\.find)))))
    (let
        ((result
          (funcall #'tail-trampoline V15643 V15644)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.prefix\?
    (V15658 V15659)
  (cl-flet
      ((tail-trampoline
        (V15658 V15659)
        (shen/cond
         ((shen/predicate->shen
           (null V15658))
          'true)
         ((shen/and
           (shen/cons\? V15658)
           (shen/and
            (shen/cons\? V15659)
            (shen/=
             (shen/hd V15659)
             (shen/hd V15658))))
          (vector
           (list
            (nthcdr 1 V15658)
            (nthcdr 1 V15659))))
         (shen/true 'false))))
    (let
        ((result
          (funcall #'tail-trampoline V15658 V15659)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.print-past-inputs
    (V15671 V15672 V15673)
  (cl-flet
      ((tail-trampoline
        (V15671 V15672 V15673)
        (shen/cond
         ((shen/predicate->shen
           (null V15672))
          '_)
         ((shen/and
           (shen/cons\? V15672)
           (shen/not
            (shen/internal/apply-higher-order-function V15671
                                                       (list
                                                        (shen/hd V15672)))))
          (vector
           (list V15671
                 (nthcdr 1 V15672)
                 (1+ V15673))))
         ((shen/and
           (shen/cons\? V15672)
           (shen/tuple\?
            (shen/hd V15672)))
          (shen/do
           (shen/shen\.prhush
            (shen/shen\.app V15673 ". " 'shen\.a)
            (shen/stoutput))
           (shen/do
            (shen/shen\.prbytes
             (shen/snd
              (shen/hd V15672)))
            (vector
             (list V15671
                   (nthcdr 1 V15672)
                   (1+ V15673))))))
         (shen/true
          (shen/shen\.f_error 'shen\.print-past-inputs)))))
    (let
        ((result
          (funcall #'tail-trampoline V15671 V15672 V15673)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.toplevel_evaluate
    (V15676 V15677)
  (cl-flet
      ((tail-trampoline
        (V15676 V15677)
        (shen/cond
         ((shen/and
           (shen/cons\? V15676)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V15676))
            (shen/and
             (shen/= ':
                     (shen/hd
                      (nthcdr 1 V15676)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V15676))
              (shen/and
               (shen/predicate->shen
                (null
                 (nthcdr 3 V15676)))
               (shen/= 'true V15677))))))
          (shen/shen\.typecheck-and-evaluate
           (shen/hd V15676)
           (shen/hd
            (nthcdr 2 V15676))))
         ((shen/and
           (shen/cons\? V15676)
           (shen/cons\?
            (nthcdr 1 V15676)))
          (shen/do
           (shen/shen\.toplevel_evaluate
            (list
             (shen/hd V15676))
            V15677)
           (shen/do
            (shen/nl 1)
            (vector
             (list
              (nthcdr 1 V15676)
              V15677)))))
         ((shen/and
           (shen/cons\? V15676)
           (shen/and
            (shen/predicate->shen
             (null
              (nthcdr 1 V15676)))
            (shen/= 'true V15677)))
          (shen/shen\.typecheck-and-evaluate
           (shen/hd V15676)
           (shen/gensym 'A)))
         ((shen/and
           (shen/cons\? V15676)
           (shen/and
            (shen/predicate->shen
             (null
              (nthcdr 1 V15676)))
            (shen/= 'false V15677)))
          (shen/let Eval
                    (shen/shen\.eval-without-macros
                     (shen/hd V15676))
                    (shen/print Eval)))
         (shen/true
          (shen/shen\.f_error 'shen\.toplevel_evaluate)))))
    (let
        ((result
          (funcall #'tail-trampoline V15676 V15677)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.typecheck-and-evaluate
    (V15680 V15681)
  (shen/let Typecheck
            (shen/shen\.typecheck V15680 V15681)
            (shen/if
             (shen/= Typecheck 'false)
             (shen/simple-error "type error\n")
             (shen/let Eval
                       (shen/shen\.eval-without-macros V15680)
                       (shen/let Type
                                 (shen/shen\.pretty-type Typecheck)
                                 (shen/shen\.prhush
                                  (shen/shen\.app Eval
                                                  (shen/cn " : "
                                                           (shen/shen\.app Type "" 'shen\.r))
                                                  'shen\.s)
                                  (shen/stoutput)))))))
(defun shen/shen\.pretty-type
    (V15683)
  (shen/shen\.mult_subst
   (shen/value 'shen\.*alphabet*)
   (shen/shen\.extract-pvars V15683)
   V15683))
(defun shen/shen\.extract-pvars
    (V15689)
  (shen/cond
   ((shen/shen\.pvar\? V15689)
    (list V15689))
   ((shen/cons\? V15689)
    (shen/union
     (shen/shen\.extract-pvars
      (shen/hd V15689))
     (shen/shen\.extract-pvars
      (nthcdr 1 V15689))))
   (shen/true nil)))
(defun shen/shen\.mult_subst
    (V15697 V15698 V15699)
  (cl-flet
      ((tail-trampoline
        (V15697 V15698 V15699)
        (shen/cond
         ((shen/predicate->shen
           (null V15697))
          V15699)
         ((shen/predicate->shen
           (null V15698))
          V15699)
         ((shen/and
           (shen/cons\? V15697)
           (shen/cons\? V15698))
          (vector
           (list
            (nthcdr 1 V15697)
            (nthcdr 1 V15698)
            (shen/subst
             (shen/hd V15697)
             (shen/hd V15698)
             V15699))))
         (shen/true
          (shen/shen\.f_error 'shen\.mult_subst)))))
    (let
        ((result
          (funcall #'tail-trampoline V15697 V15698 V15699)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.shen->kl
    (V13104 V13105)
  (shen/compile
   (shen/lambda X
                (shen/shen\.<define> X))
   (append
    (list V13104)
    V13105)
   (shen/lambda X
                (shen/shen\.shen-syntax-error V13104 X))))
(defun shen/shen\.shen-syntax-error
    (V13112 V13113)
  (shen/cond
   ((shen/cons\? V13113)
    (shen/simple-error
     (shen/cn "syntax error in "
              (shen/shen\.app V13112
                              (shen/cn " here:\n\n "
                                       (shen/shen\.app
                                        (shen/shen\.next-50 50
                                                            (shen/hd V13113))
                                        "\n" 'shen\.a))
                              'shen\.a))))
   (shen/true
    (shen/simple-error
     (shen/cn "syntax error in "
              (shen/shen\.app V13112 "\n" 'shen\.a))))))
(defun shen/shen\.<define>
    (V13115)
  (shen/let YaccParse
            (shen/let Parse_shen\.<name>
                      (shen/shen\.<name> V13115)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<name>))
                       (shen/let Parse_shen\.<signature>
                                 (shen/shen\.<signature> Parse_shen\.<name>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<signature>))
                                  (shen/let Parse_shen\.<rules>
                                            (shen/shen\.<rules> Parse_shen\.<signature>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<rules>))
                                             (shen/shen\.pair
                                              (shen/hd Parse_shen\.<rules>)
                                              (shen/shen\.compile_to_machine_code
                                               (shen/shen\.hdtl Parse_shen\.<name>)
                                               (shen/shen\.hdtl Parse_shen\.<rules>)))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<name>
                       (shen/shen\.<name> V13115)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<name>))
                        (shen/let Parse_shen\.<rules>
                                  (shen/shen\.<rules> Parse_shen\.<name>)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<rules>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<rules>)
                                    (shen/shen\.compile_to_machine_code
                                     (shen/shen\.hdtl Parse_shen\.<name>)
                                     (shen/shen\.hdtl Parse_shen\.<rules>)))
                                   (shen/fail)))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<name>
    (V13117)
  (shen/if
   (shen/cons\?
    (shen/hd V13117))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V13117))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V13117))
                (shen/shen\.hdtl V13117)))
              (shen/if
               (shen/and
                (shen/symbol\? Parse_X)
                (shen/not
                 (shen/shen\.sysfunc\? Parse_X)))
               Parse_X
               (shen/simple-error
                (shen/shen\.app Parse_X " is not a legitimate function name.\n" 'shen\.a)))))
   (shen/fail)))
(defun shen/shen\.sysfunc\?
    (V13119)
  (shen/element\? V13119
                  (shen/get
                   (shen/intern "shen")
                   'shen\.external-symbols
                   (shen/value '*property-vector*))))
(defun shen/shen\.<signature>
    (V13121)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V13121))
    (shen/= '{
            (shen/hd
             (shen/hd V13121))))
   (shen/let Parse_shen\.<signature-help>
             (shen/shen\.<signature-help>
              (shen/shen\.pair
               (nthcdr 1
                       (shen/hd V13121))
               (shen/shen\.hdtl V13121)))
             (shen/if
              (shen/not
               (shen/=
                (shen/fail)
                Parse_shen\.<signature-help>))
              (shen/if
               (shen/and
                (shen/cons\?
                 (shen/hd Parse_shen\.<signature-help>))
                (shen/= '}
                        (shen/hd
                         (shen/hd Parse_shen\.<signature-help>))))
               (shen/shen\.pair
                (shen/hd
                 (shen/shen\.pair
                  (nthcdr 1
                          (shen/hd Parse_shen\.<signature-help>))
                  (shen/shen\.hdtl Parse_shen\.<signature-help>)))
                (shen/shen\.demodulate
                 (shen/shen\.curry-type
                  (shen/shen\.hdtl Parse_shen\.<signature-help>))))
               (shen/fail))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.curry-type
    (V13123)
  (cl-flet
      ((tail-trampoline
        (V13123)
        (shen/cond
         ((shen/and
           (shen/cons\? V13123)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13123))
            (shen/and
             (shen/= '-->
                     (shen/hd
                      (nthcdr 1 V13123)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13123))
              (shen/and
               (shen/cons\?
                (nthcdr 3 V13123))
               (shen/= '-->
                       (shen/hd
                        (nthcdr 3 V13123))))))))
          (vector
           (list
            (list
             (shen/hd V13123)
             '-->
             (nthcdr 2 V13123)))))
         ((shen/and
           (shen/cons\? V13123)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13123))
            (shen/and
             (shen/= '*
                     (shen/hd
                      (nthcdr 1 V13123)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13123))
              (shen/and
               (shen/cons\?
                (nthcdr 3 V13123))
               (shen/= '*
                       (shen/hd
                        (nthcdr 3 V13123))))))))
          (vector
           (list
            (list
             (shen/hd V13123)
             '*
             (nthcdr 2 V13123)))))
         ((shen/cons\? V13123)
          (shen/map
           (shen/lambda Z
                        (shen/shen\.curry-type Z))
           V13123))
         (shen/true V13123))))
    (let
        ((result
          (funcall #'tail-trampoline V13123)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.<signature-help>
    (V13125)
  (shen/let YaccParse
            (shen/if
             (shen/cons\?
              (shen/hd V13125))
             (shen/let Parse_X
                       (shen/hd
                        (shen/hd V13125))
                       (shen/let Parse_shen\.<signature-help>
                                 (shen/shen\.<signature-help>
                                  (shen/shen\.pair
                                   (nthcdr 1
                                           (shen/hd V13125))
                                   (shen/shen\.hdtl V13125)))
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<signature-help>))
                                  (shen/if
                                   (shen/not
                                    (shen/element\? Parse_X
                                                    (list '{ '})))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<signature-help>)
                                    (append
                                     (list Parse_X)
                                     (shen/shen\.hdtl Parse_shen\.<signature-help>)))
                                   (shen/fail))
                                  (shen/fail))))
             (shen/fail))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V13125)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<rules>
    (V13127)
  (shen/let YaccParse
            (shen/let Parse_shen\.<rule>
                      (shen/shen\.<rule> V13127)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<rule>))
                       (shen/let Parse_shen\.<rules>
                                 (shen/shen\.<rules> Parse_shen\.<rule>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<rules>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<rules>)
                                   (append
                                    (list
                                     (shen/shen\.linearise
                                      (shen/shen\.hdtl Parse_shen\.<rule>)))
                                    (shen/shen\.hdtl Parse_shen\.<rules>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<rule>
                       (shen/shen\.<rule> V13127)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<rule>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<rule>)
                         (list
                          (shen/shen\.linearise
                           (shen/shen\.hdtl Parse_shen\.<rule>))))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<rule>
    (V13129)
  (shen/let YaccParse
            (shen/let Parse_shen\.<patterns>
                      (shen/shen\.<patterns> V13129)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<patterns>))
                       (shen/if
                        (shen/and
                         (shen/cons\?
                          (shen/hd Parse_shen\.<patterns>))
                         (shen/= '->
                                 (shen/hd
                                  (shen/hd Parse_shen\.<patterns>))))
                        (shen/let Parse_shen\.<action>
                                  (shen/shen\.<action>
                                   (shen/shen\.pair
                                    (nthcdr 1
                                            (shen/hd Parse_shen\.<patterns>))
                                    (shen/shen\.hdtl Parse_shen\.<patterns>)))
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<action>))
                                   (shen/if
                                    (shen/and
                                     (shen/cons\?
                                      (shen/hd Parse_shen\.<action>))
                                     (shen/= 'where
                                             (shen/hd
                                              (shen/hd Parse_shen\.<action>))))
                                    (shen/let Parse_shen\.<guard>
                                              (shen/shen\.<guard>
                                               (shen/shen\.pair
                                                (nthcdr 1
                                                        (shen/hd Parse_shen\.<action>))
                                                (shen/shen\.hdtl Parse_shen\.<action>)))
                                              (shen/if
                                               (shen/not
                                                (shen/=
                                                 (shen/fail)
                                                 Parse_shen\.<guard>))
                                               (shen/shen\.pair
                                                (shen/hd Parse_shen\.<guard>)
                                                (list
                                                 (shen/shen\.hdtl Parse_shen\.<patterns>)
                                                 (list 'where
                                                       (shen/shen\.hdtl Parse_shen\.<guard>)
                                                       (shen/shen\.hdtl Parse_shen\.<action>))))
                                               (shen/fail)))
                                    (shen/fail))
                                   (shen/fail)))
                        (shen/fail))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<patterns>
                                 (shen/shen\.<patterns> V13129)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<patterns>))
                                  (shen/if
                                   (shen/and
                                    (shen/cons\?
                                     (shen/hd Parse_shen\.<patterns>))
                                    (shen/= '->
                                            (shen/hd
                                             (shen/hd Parse_shen\.<patterns>))))
                                   (shen/let Parse_shen\.<action>
                                             (shen/shen\.<action>
                                              (shen/shen\.pair
                                               (nthcdr 1
                                                       (shen/hd Parse_shen\.<patterns>))
                                               (shen/shen\.hdtl Parse_shen\.<patterns>)))
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<action>))
                                              (shen/shen\.pair
                                               (shen/hd Parse_shen\.<action>)
                                               (list
                                                (shen/shen\.hdtl Parse_shen\.<patterns>)
                                                (shen/shen\.hdtl Parse_shen\.<action>)))
                                              (shen/fail)))
                                   (shen/fail))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let YaccParse
                                  (shen/let Parse_shen\.<patterns>
                                            (shen/shen\.<patterns> V13129)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<patterns>))
                                             (shen/if
                                              (shen/and
                                               (shen/cons\?
                                                (shen/hd Parse_shen\.<patterns>))
                                               (shen/= '<-
                                                       (shen/hd
                                                        (shen/hd Parse_shen\.<patterns>))))
                                              (shen/let Parse_shen\.<action>
                                                        (shen/shen\.<action>
                                                         (shen/shen\.pair
                                                          (nthcdr 1
                                                                  (shen/hd Parse_shen\.<patterns>))
                                                          (shen/shen\.hdtl Parse_shen\.<patterns>)))
                                                        (shen/if
                                                         (shen/not
                                                          (shen/=
                                                           (shen/fail)
                                                           Parse_shen\.<action>))
                                                         (shen/if
                                                          (shen/and
                                                           (shen/cons\?
                                                            (shen/hd Parse_shen\.<action>))
                                                           (shen/= 'where
                                                                   (shen/hd
                                                                    (shen/hd Parse_shen\.<action>))))
                                                          (shen/let Parse_shen\.<guard>
                                                                    (shen/shen\.<guard>
                                                                     (shen/shen\.pair
                                                                      (nthcdr 1
                                                                              (shen/hd Parse_shen\.<action>))
                                                                      (shen/shen\.hdtl Parse_shen\.<action>)))
                                                                    (shen/if
                                                                     (shen/not
                                                                      (shen/=
                                                                       (shen/fail)
                                                                       Parse_shen\.<guard>))
                                                                     (shen/shen\.pair
                                                                      (shen/hd Parse_shen\.<guard>)
                                                                      (list
                                                                       (shen/shen\.hdtl Parse_shen\.<patterns>)
                                                                       (list 'where
                                                                             (shen/shen\.hdtl Parse_shen\.<guard>)
                                                                             (list 'shen\.choicepoint!
                                                                                   (shen/shen\.hdtl Parse_shen\.<action>)))))
                                                                     (shen/fail)))
                                                          (shen/fail))
                                                         (shen/fail)))
                                              (shen/fail))
                                             (shen/fail)))
                                  (shen/if
                                   (shen/= YaccParse
                                           (shen/fail))
                                   (shen/let Parse_shen\.<patterns>
                                             (shen/shen\.<patterns> V13129)
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<patterns>))
                                              (shen/if
                                               (shen/and
                                                (shen/cons\?
                                                 (shen/hd Parse_shen\.<patterns>))
                                                (shen/= '<-
                                                        (shen/hd
                                                         (shen/hd Parse_shen\.<patterns>))))
                                               (shen/let Parse_shen\.<action>
                                                         (shen/shen\.<action>
                                                          (shen/shen\.pair
                                                           (nthcdr 1
                                                                   (shen/hd Parse_shen\.<patterns>))
                                                           (shen/shen\.hdtl Parse_shen\.<patterns>)))
                                                         (shen/if
                                                          (shen/not
                                                           (shen/=
                                                            (shen/fail)
                                                            Parse_shen\.<action>))
                                                          (shen/shen\.pair
                                                           (shen/hd Parse_shen\.<action>)
                                                           (list
                                                            (shen/shen\.hdtl Parse_shen\.<patterns>)
                                                            (list 'shen\.choicepoint!
                                                                  (shen/shen\.hdtl Parse_shen\.<action>))))
                                                          (shen/fail)))
                                               (shen/fail))
                                              (shen/fail)))
                                   YaccParse))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.fail_if
    (V13132 V13133)
  (shen/if
   (shen/internal/apply-higher-order-function V13132
                                              (list V13133))
   (shen/fail)
   V13133))
(defun shen/shen\.succeeds\?
    (V13139)
  (shen/cond
   ((shen/= V13139
            (shen/fail))
    'false)
   (shen/true 'true)))
(defun shen/shen\.<patterns>
    (V13141)
  (shen/let YaccParse
            (shen/let Parse_shen\.<pattern>
                      (shen/shen\.<pattern> V13141)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<pattern>))
                       (shen/let Parse_shen\.<patterns>
                                 (shen/shen\.<patterns> Parse_shen\.<pattern>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<patterns>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<patterns>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<pattern>))
                                    (shen/shen\.hdtl Parse_shen\.<patterns>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V13141)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<pattern>
    (V13148)
  (shen/let YaccParse
            (shen/if
             (shen/and
              (shen/cons\?
               (shen/hd V13148))
              (shen/cons\?
               (shen/hd
                (shen/hd V13148))))
             (shen/if
              (shen/and
               (shen/cons\?
                (shen/hd
                 (shen/shen\.pair
                  (shen/hd
                   (shen/hd V13148))
                  (shen/hd
                   (nthcdr 1 V13148)))))
               (shen/= '@p
                       (shen/hd
                        (shen/hd
                         (shen/shen\.pair
                          (shen/hd
                           (shen/hd V13148))
                          (shen/hd
                           (nthcdr 1 V13148)))))))
              (shen/let Parse_shen\.<pattern1>
                        (shen/shen\.<pattern1>
                         (shen/shen\.pair
                          (nthcdr 1
                                  (shen/hd
                                   (shen/shen\.pair
                                    (shen/hd
                                     (shen/hd V13148))
                                    (shen/hd
                                     (nthcdr 1 V13148)))))
                          (shen/shen\.hdtl
                           (shen/shen\.pair
                            (shen/hd
                             (shen/hd V13148))
                            (shen/hd
                             (nthcdr 1 V13148))))))
                        (shen/if
                         (shen/not
                          (shen/=
                           (shen/fail)
                           Parse_shen\.<pattern1>))
                         (shen/let Parse_shen\.<pattern2>
                                   (shen/shen\.<pattern2> Parse_shen\.<pattern1>)
                                   (shen/if
                                    (shen/not
                                     (shen/=
                                      (shen/fail)
                                      Parse_shen\.<pattern2>))
                                    (shen/shen\.pair
                                     (shen/hd
                                      (shen/shen\.pair
                                       (nthcdr 1
                                               (shen/hd V13148))
                                       (shen/hd
                                        (nthcdr 1 V13148))))
                                     (list '@p
                                           (shen/shen\.hdtl Parse_shen\.<pattern1>)
                                           (shen/shen\.hdtl Parse_shen\.<pattern2>)))
                                    (shen/fail)))
                         (shen/fail)))
              (shen/fail))
             (shen/fail))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/if
                        (shen/and
                         (shen/cons\?
                          (shen/hd V13148))
                         (shen/cons\?
                          (shen/hd
                           (shen/hd V13148))))
                        (shen/if
                         (shen/and
                          (shen/cons\?
                           (shen/hd
                            (shen/shen\.pair
                             (shen/hd
                              (shen/hd V13148))
                             (shen/hd
                              (nthcdr 1 V13148)))))
                          (shen/= 'cons
                                  (shen/hd
                                   (shen/hd
                                    (shen/shen\.pair
                                     (shen/hd
                                      (shen/hd V13148))
                                     (shen/hd
                                      (nthcdr 1 V13148)))))))
                         (shen/let Parse_shen\.<pattern1>
                                   (shen/shen\.<pattern1>
                                    (shen/shen\.pair
                                     (nthcdr 1
                                             (shen/hd
                                              (shen/shen\.pair
                                               (shen/hd
                                                (shen/hd V13148))
                                               (shen/hd
                                                (nthcdr 1 V13148)))))
                                     (shen/shen\.hdtl
                                      (shen/shen\.pair
                                       (shen/hd
                                        (shen/hd V13148))
                                       (shen/hd
                                        (nthcdr 1 V13148))))))
                                   (shen/if
                                    (shen/not
                                     (shen/=
                                      (shen/fail)
                                      Parse_shen\.<pattern1>))
                                    (shen/let Parse_shen\.<pattern2>
                                              (shen/shen\.<pattern2> Parse_shen\.<pattern1>)
                                              (shen/if
                                               (shen/not
                                                (shen/=
                                                 (shen/fail)
                                                 Parse_shen\.<pattern2>))
                                               (shen/shen\.pair
                                                (shen/hd
                                                 (shen/shen\.pair
                                                  (nthcdr 1
                                                          (shen/hd V13148))
                                                  (shen/hd
                                                   (nthcdr 1 V13148))))
                                                (list 'cons
                                                      (shen/shen\.hdtl Parse_shen\.<pattern1>)
                                                      (shen/shen\.hdtl Parse_shen\.<pattern2>)))
                                               (shen/fail)))
                                    (shen/fail)))
                         (shen/fail))
                        (shen/fail))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let YaccParse
                                  (shen/if
                                   (shen/and
                                    (shen/cons\?
                                     (shen/hd V13148))
                                    (shen/cons\?
                                     (shen/hd
                                      (shen/hd V13148))))
                                   (shen/if
                                    (shen/and
                                     (shen/cons\?
                                      (shen/hd
                                       (shen/shen\.pair
                                        (shen/hd
                                         (shen/hd V13148))
                                        (shen/hd
                                         (nthcdr 1 V13148)))))
                                     (shen/= '@v
                                             (shen/hd
                                              (shen/hd
                                               (shen/shen\.pair
                                                (shen/hd
                                                 (shen/hd V13148))
                                                (shen/hd
                                                 (nthcdr 1 V13148)))))))
                                    (shen/let Parse_shen\.<pattern1>
                                              (shen/shen\.<pattern1>
                                               (shen/shen\.pair
                                                (nthcdr 1
                                                        (shen/hd
                                                         (shen/shen\.pair
                                                          (shen/hd
                                                           (shen/hd V13148))
                                                          (shen/hd
                                                           (nthcdr 1 V13148)))))
                                                (shen/shen\.hdtl
                                                 (shen/shen\.pair
                                                  (shen/hd
                                                   (shen/hd V13148))
                                                  (shen/hd
                                                   (nthcdr 1 V13148))))))
                                              (shen/if
                                               (shen/not
                                                (shen/=
                                                 (shen/fail)
                                                 Parse_shen\.<pattern1>))
                                               (shen/let Parse_shen\.<pattern2>
                                                         (shen/shen\.<pattern2> Parse_shen\.<pattern1>)
                                                         (shen/if
                                                          (shen/not
                                                           (shen/=
                                                            (shen/fail)
                                                            Parse_shen\.<pattern2>))
                                                          (shen/shen\.pair
                                                           (shen/hd
                                                            (shen/shen\.pair
                                                             (nthcdr 1
                                                                     (shen/hd V13148))
                                                             (shen/hd
                                                              (nthcdr 1 V13148))))
                                                           (list '@v
                                                                 (shen/shen\.hdtl Parse_shen\.<pattern1>)
                                                                 (shen/shen\.hdtl Parse_shen\.<pattern2>)))
                                                          (shen/fail)))
                                               (shen/fail)))
                                    (shen/fail))
                                   (shen/fail))
                                  (shen/if
                                   (shen/= YaccParse
                                           (shen/fail))
                                   (shen/let YaccParse
                                             (shen/if
                                              (shen/and
                                               (shen/cons\?
                                                (shen/hd V13148))
                                               (shen/cons\?
                                                (shen/hd
                                                 (shen/hd V13148))))
                                              (shen/if
                                               (shen/and
                                                (shen/cons\?
                                                 (shen/hd
                                                  (shen/shen\.pair
                                                   (shen/hd
                                                    (shen/hd V13148))
                                                   (shen/hd
                                                    (nthcdr 1 V13148)))))
                                                (shen/= '@s
                                                        (shen/hd
                                                         (shen/hd
                                                          (shen/shen\.pair
                                                           (shen/hd
                                                            (shen/hd V13148))
                                                           (shen/hd
                                                            (nthcdr 1 V13148)))))))
                                               (shen/let Parse_shen\.<pattern1>
                                                         (shen/shen\.<pattern1>
                                                          (shen/shen\.pair
                                                           (nthcdr 1
                                                                   (shen/hd
                                                                    (shen/shen\.pair
                                                                     (shen/hd
                                                                      (shen/hd V13148))
                                                                     (shen/hd
                                                                      (nthcdr 1 V13148)))))
                                                           (shen/shen\.hdtl
                                                            (shen/shen\.pair
                                                             (shen/hd
                                                              (shen/hd V13148))
                                                             (shen/hd
                                                              (nthcdr 1 V13148))))))
                                                         (shen/if
                                                          (shen/not
                                                           (shen/=
                                                            (shen/fail)
                                                            Parse_shen\.<pattern1>))
                                                          (shen/let Parse_shen\.<pattern2>
                                                                    (shen/shen\.<pattern2> Parse_shen\.<pattern1>)
                                                                    (shen/if
                                                                     (shen/not
                                                                      (shen/=
                                                                       (shen/fail)
                                                                       Parse_shen\.<pattern2>))
                                                                     (shen/shen\.pair
                                                                      (shen/hd
                                                                       (shen/shen\.pair
                                                                        (nthcdr 1
                                                                                (shen/hd V13148))
                                                                        (shen/hd
                                                                         (nthcdr 1 V13148))))
                                                                      (list '@s
                                                                            (shen/shen\.hdtl Parse_shen\.<pattern1>)
                                                                            (shen/shen\.hdtl Parse_shen\.<pattern2>)))
                                                                     (shen/fail)))
                                                          (shen/fail)))
                                               (shen/fail))
                                              (shen/fail))
                                             (shen/if
                                              (shen/= YaccParse
                                                      (shen/fail))
                                              (shen/let YaccParse
                                                        (shen/if
                                                         (shen/and
                                                          (shen/cons\?
                                                           (shen/hd V13148))
                                                          (shen/cons\?
                                                           (shen/hd
                                                            (shen/hd V13148))))
                                                         (shen/if
                                                          (shen/and
                                                           (shen/cons\?
                                                            (shen/hd
                                                             (shen/shen\.pair
                                                              (shen/hd
                                                               (shen/hd V13148))
                                                              (shen/hd
                                                               (nthcdr 1 V13148)))))
                                                           (shen/= 'vector
                                                                   (shen/hd
                                                                    (shen/hd
                                                                     (shen/shen\.pair
                                                                      (shen/hd
                                                                       (shen/hd V13148))
                                                                      (shen/hd
                                                                       (nthcdr 1 V13148)))))))
                                                          (shen/if
                                                           (shen/and
                                                            (shen/cons\?
                                                             (shen/hd
                                                              (shen/shen\.pair
                                                               (nthcdr 1
                                                                       (shen/hd
                                                                        (shen/shen\.pair
                                                                         (shen/hd
                                                                          (shen/hd V13148))
                                                                         (shen/hd
                                                                          (nthcdr 1 V13148)))))
                                                               (shen/shen\.hdtl
                                                                (shen/shen\.pair
                                                                 (shen/hd
                                                                  (shen/hd V13148))
                                                                 (shen/hd
                                                                  (nthcdr 1 V13148)))))))
                                                            (shen/= 0
                                                                    (shen/hd
                                                                     (shen/hd
                                                                      (shen/shen\.pair
                                                                       (nthcdr 1
                                                                               (shen/hd
                                                                                (shen/shen\.pair
                                                                                 (shen/hd
                                                                                  (shen/hd V13148))
                                                                                 (shen/hd
                                                                                  (nthcdr 1 V13148)))))
                                                                       (shen/shen\.hdtl
                                                                        (shen/shen\.pair
                                                                         (shen/hd
                                                                          (shen/hd V13148))
                                                                         (shen/hd
                                                                          (nthcdr 1 V13148)))))))))
                                                           (shen/shen\.pair
                                                            (shen/hd
                                                             (shen/shen\.pair
                                                              (nthcdr 1
                                                                      (shen/hd V13148))
                                                              (shen/hd
                                                               (nthcdr 1 V13148))))
                                                            (list 'vector 0))
                                                           (shen/fail))
                                                          (shen/fail))
                                                         (shen/fail))
                                                        (shen/if
                                                         (shen/= YaccParse
                                                                 (shen/fail))
                                                         (shen/let YaccParse
                                                                   (shen/if
                                                                    (shen/cons\?
                                                                     (shen/hd V13148))
                                                                    (shen/let Parse_X
                                                                              (shen/hd
                                                                               (shen/hd V13148))
                                                                              (shen/if
                                                                               (shen/cons\? Parse_X)
                                                                               (shen/shen\.pair
                                                                                (shen/hd
                                                                                 (shen/shen\.pair
                                                                                  (nthcdr 1
                                                                                          (shen/hd V13148))
                                                                                  (shen/shen\.hdtl V13148)))
                                                                                (shen/shen\.constructor-error Parse_X))
                                                                               (shen/fail)))
                                                                    (shen/fail))
                                                                   (shen/if
                                                                    (shen/= YaccParse
                                                                            (shen/fail))
                                                                    (shen/let Parse_shen\.<simple_pattern>
                                                                              (shen/shen\.<simple_pattern> V13148)
                                                                              (shen/if
                                                                               (shen/not
                                                                                (shen/=
                                                                                 (shen/fail)
                                                                                 Parse_shen\.<simple_pattern>))
                                                                               (shen/shen\.pair
                                                                                (shen/hd Parse_shen\.<simple_pattern>)
                                                                                (shen/shen\.hdtl Parse_shen\.<simple_pattern>))
                                                                               (shen/fail)))
                                                                    YaccParse))
                                                         YaccParse))
                                              YaccParse))
                                   YaccParse))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.constructor-error
    (V13150)
  (shen/simple-error
   (shen/shen\.app V13150 " is not a legitimate constructor\n" 'shen\.a)))
(defun shen/shen\.<simple_pattern>
    (V13152)
  (shen/let YaccParse
            (shen/if
             (shen/cons\?
              (shen/hd V13152))
             (shen/let Parse_X
                       (shen/hd
                        (shen/hd V13152))
                       (shen/if
                        (shen/= Parse_X '_)
                        (shen/shen\.pair
                         (shen/hd
                          (shen/shen\.pair
                           (nthcdr 1
                                   (shen/hd V13152))
                           (shen/shen\.hdtl V13152)))
                         (shen/gensym 'Parse_Y))
                        (shen/fail)))
             (shen/fail))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/if
              (shen/cons\?
               (shen/hd V13152))
              (shen/let Parse_X
                        (shen/hd
                         (shen/hd V13152))
                        (shen/if
                         (shen/not
                          (shen/element\? Parse_X
                                          (list '-> '<-)))
                         (shen/shen\.pair
                          (shen/hd
                           (shen/shen\.pair
                            (nthcdr 1
                                    (shen/hd V13152))
                            (shen/shen\.hdtl V13152)))
                          Parse_X)
                         (shen/fail)))
              (shen/fail))
             YaccParse)))
(defun shen/shen\.<pattern1>
    (V13154)
  (shen/let Parse_shen\.<pattern>
            (shen/shen\.<pattern> V13154)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<pattern>))
             (shen/shen\.pair
              (shen/hd Parse_shen\.<pattern>)
              (shen/shen\.hdtl Parse_shen\.<pattern>))
             (shen/fail))))
(defun shen/shen\.<pattern2>
    (V13156)
  (shen/let Parse_shen\.<pattern>
            (shen/shen\.<pattern> V13156)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<pattern>))
             (shen/shen\.pair
              (shen/hd Parse_shen\.<pattern>)
              (shen/shen\.hdtl Parse_shen\.<pattern>))
             (shen/fail))))
(defun shen/shen\.<action>
    (V13158)
  (shen/if
   (shen/cons\?
    (shen/hd V13158))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V13158))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V13158))
                (shen/shen\.hdtl V13158)))
              Parse_X))
   (shen/fail)))
(defun shen/shen\.<guard>
    (V13160)
  (shen/if
   (shen/cons\?
    (shen/hd V13160))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V13160))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V13160))
                (shen/shen\.hdtl V13160)))
              Parse_X))
   (shen/fail)))
(defun shen/shen\.compile_to_machine_code
    (V13163 V13164)
  (shen/let Lambda+
            (shen/shen\.compile_to_lambda+ V13163 V13164)
            (shen/let KL
                      (shen/shen\.compile_to_kl V13163 Lambda+)
                      (shen/let Record
                                (shen/shen\.record-source V13163 KL)
                                KL))))
(defun shen/shen\.record-source
    (V13169 V13170)
  (shen/cond
   ((shen/value 'shen\.*installing-kl*)
    'shen\.skip)
   (shen/true
    (shen/put V13169 'shen\.source V13170
              (shen/value '*property-vector*)))))
(defun shen/shen\.compile_to_lambda+
    (V13173 V13174)
  (shen/let Arity
            (shen/shen\.aritycheck V13173 V13174)
            (shen/let UpDateSymbolTable
                      (shen/shen\.update-symbol-table V13173 Arity)
                      (shen/let Free
                                (shen/map
                                 (shen/lambda Rule
                                              (shen/shen\.free_variable_check V13173 Rule))
                                 V13174)
                                (shen/let Variables
                                          (shen/shen\.parameters Arity)
                                          (shen/let Strip
                                                    (shen/map
                                                     (shen/lambda X
                                                                  (shen/shen\.strip-protect X))
                                                     V13174)
                                                    (shen/let Abstractions
                                                              (shen/map
                                                               (shen/lambda X
                                                                            (shen/shen\.abstract_rule X))
                                                               Strip)
                                                              (shen/let Applications
                                                                        (shen/map
                                                                         (shen/lambda X
                                                                                      (shen/shen\.application_build Variables X))
                                                                         Abstractions)
                                                                        (list Variables Applications)))))))))
(defun shen/shen\.update-symbol-table
    (V13177 V13178)
  (shen/set 'shen\.*symbol-table*
            (shen/shen\.update-symbol-table-h V13177 V13178
                                              (shen/value 'shen\.*symbol-table*)
                                              nil)))
(defun shen/shen\.update-symbol-table-h
    (V13186 V13187 V13188 V13189)
  (cl-flet
      ((tail-trampoline
        (V13186 V13187 V13188 V13189)
        (shen/cond
         ((shen/predicate->shen
           (null V13188))
          (shen/let NewEntry
                    (append
                     (list V13186)
                     (shen/eval-kl
                      (shen/shen\.lambda-form V13186 V13187)))
                    (append
                     (list NewEntry)
                     V13189)))
         ((shen/and
           (shen/cons\? V13188)
           (shen/and
            (shen/cons\?
             (shen/hd V13188))
            (shen/=
             (shen/hd
              (shen/hd V13188))
             V13186)))
          (shen/let ChangedEntry
                    (append
                     (list
                      (shen/hd
                       (shen/hd V13188)))
                     (shen/eval-kl
                      (shen/shen\.lambda-form
                       (shen/hd
                        (shen/hd V13188))
                       V13187)))
                    (shen/append
                     (nthcdr 1 V13188)
                     (append
                      (list ChangedEntry)
                      V13189))))
         ((shen/cons\? V13188)
          (vector
           (list V13186 V13187
                 (nthcdr 1 V13188)
                 (append
                  (list
                   (shen/hd V13188))
                  V13189))))
         (shen/true
          (shen/shen\.f_error 'shen\.update-symbol-table-h)))))
    (let
        ((result
          (funcall #'tail-trampoline V13186 V13187 V13188 V13189)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.free_variable_check
    (V13192 V13193)
  (shen/cond
   ((shen/and
     (shen/cons\? V13193)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13193))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13193)))))
    (shen/let Bound
              (shen/shen\.extract_vars
               (shen/hd V13193))
              (shen/let Free
                        (shen/shen\.extract_free_vars Bound
                                                      (shen/hd
                                                       (nthcdr 1 V13193)))
                        (shen/shen\.free_variable_warnings V13192 Free))))
   (shen/true
    (shen/shen\.f_error 'shen\.free_variable_check))))
(defun shen/shen\.extract_vars
    (V13195)
  (shen/cond
   ((shen/variable\? V13195)
    (list V13195))
   ((shen/cons\? V13195)
    (shen/union
     (shen/shen\.extract_vars
      (shen/hd V13195))
     (shen/shen\.extract_vars
      (nthcdr 1 V13195))))
   (shen/true nil)))
(defun shen/shen\.extract_free_vars
    (V13207 V13208)
  (cl-flet
      ((tail-trampoline
        (V13207 V13208)
        (shen/cond
         ((shen/and
           (shen/cons\? V13208)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13208))
            (shen/and
             (shen/predicate->shen
              (null
               (nthcdr 2 V13208)))
             (shen/=
              (shen/hd V13208)
              'protect))))
          nil)
         ((shen/and
           (shen/variable\? V13208)
           (shen/not
            (shen/element\? V13208 V13207)))
          (list V13208))
         ((shen/and
           (shen/cons\? V13208)
           (shen/and
            (shen/= 'lambda
                    (shen/hd V13208))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13208))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13208))
              (shen/predicate->shen
               (null
                (nthcdr 3 V13208)))))))
          (vector
           (list
            (append
             (list
              (shen/hd
               (nthcdr 1 V13208)))
             V13207)
            (shen/hd
             (nthcdr 2 V13208)))))
         ((shen/and
           (shen/cons\? V13208)
           (shen/and
            (shen/= 'let
                    (shen/hd V13208))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13208))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13208))
              (shen/and
               (shen/cons\?
                (nthcdr 3 V13208))
               (shen/predicate->shen
                (null
                 (nthcdr 4 V13208))))))))
          (shen/union
           (shen/shen\.extract_free_vars V13207
                                         (shen/hd
                                          (nthcdr 2 V13208)))
           (shen/shen\.extract_free_vars
            (append
             (list
              (shen/hd
               (nthcdr 1 V13208)))
             V13207)
            (shen/hd
             (nthcdr 3 V13208)))))
         ((shen/cons\? V13208)
          (shen/union
           (shen/shen\.extract_free_vars V13207
                                         (shen/hd V13208))
           (shen/shen\.extract_free_vars V13207
                                         (nthcdr 1 V13208))))
         (shen/true nil))))
    (let
        ((result
          (funcall #'tail-trampoline V13207 V13208)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.free_variable_warnings
    (V13213 V13214)
  (shen/cond
   ((shen/predicate->shen
     (null V13214))
    '_)
   (shen/true
    (shen/simple-error
     (shen/cn "error: the following variables are free in "
              (shen/shen\.app V13213
                              (shen/cn ": "
                                       (shen/shen\.app
                                        (shen/shen\.list_variables V13214)
                                        "" 'shen\.a))
                              'shen\.a))))))
(defun shen/shen\.list_variables
    (V13216)
  (shen/cond
   ((shen/and
     (shen/cons\? V13216)
     (shen/predicate->shen
      (null
       (nthcdr 1 V13216))))
    (shen/cn
     (shen/str
      (shen/hd V13216))
     "."))
   ((shen/cons\? V13216)
    (shen/cn
     (shen/str
      (shen/hd V13216))
     (shen/cn ", "
              (shen/shen\.list_variables
               (nthcdr 1 V13216)))))
   (shen/true
    (shen/shen\.f_error 'shen\.list_variables))))
(defun shen/shen\.strip-protect
    (V13218)
  (cl-flet
      ((tail-trampoline
        (V13218)
        (shen/cond
         ((shen/and
           (shen/cons\? V13218)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13218))
            (shen/and
             (shen/predicate->shen
              (null
               (nthcdr 2 V13218)))
             (shen/=
              (shen/hd V13218)
              'protect))))
          (vector
           (list
            (shen/hd
             (nthcdr 1 V13218)))))
         ((shen/cons\? V13218)
          (shen/map
           (shen/lambda Z
                        (shen/shen\.strip-protect Z))
           V13218))
         (shen/true V13218))))
    (let
        ((result
          (funcall #'tail-trampoline V13218)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.linearise
    (V13220)
  (shen/cond
   ((shen/and
     (shen/cons\? V13220)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13220))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13220)))))
    (shen/shen\.linearise_help
     (shen/shen\.flatten
      (shen/hd V13220))
     (shen/hd V13220)
     (shen/hd
      (nthcdr 1 V13220))))
   (shen/true
    (shen/shen\.f_error 'shen\.linearise))))
(defun shen/shen\.flatten
    (V13222)
  (shen/cond
   ((shen/predicate->shen
     (null V13222))
    nil)
   ((shen/cons\? V13222)
    (shen/append
     (shen/shen\.flatten
      (shen/hd V13222))
     (shen/shen\.flatten
      (nthcdr 1 V13222))))
   (shen/true
    (list V13222))))
(defun shen/shen\.linearise_help
    (V13226 V13227 V13228)
  (cl-flet
      ((tail-trampoline
        (V13226 V13227 V13228)
        (shen/cond
         ((shen/predicate->shen
           (null V13226))
          (list V13227 V13228))
         ((shen/cons\? V13226)
          (shen/if
           (shen/and
            (shen/variable\?
             (shen/hd V13226))
            (shen/element\?
             (shen/hd V13226)
             (nthcdr 1 V13226)))
           (shen/let Var
                     (shen/gensym
                      (shen/hd V13226))
                     (shen/let NewAction
                               (list 'where
                                     (list '=
                                           (shen/hd V13226)
                                           Var)
                                     V13228)
                               (shen/let NewPatts
                                         (shen/shen\.linearise_X
                                          (shen/hd V13226)
                                          Var V13227)
                                         (vector
                                          (list
                                           (nthcdr 1 V13226)
                                           NewPatts NewAction)))))
           (vector
            (list
             (nthcdr 1 V13226)
             V13227 V13228))))
         (shen/true
          (shen/shen\.f_error 'shen\.linearise_help)))))
    (let
        ((result
          (funcall #'tail-trampoline V13226 V13227 V13228)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.linearise_X
    (V13241 V13242 V13243)
  (shen/cond
   ((shen/= V13243 V13241)
    V13242)
   ((shen/cons\? V13243)
    (shen/let L
              (shen/shen\.linearise_X V13241 V13242
                                      (shen/hd V13243))
              (shen/if
               (shen/= L
                       (shen/hd V13243))
               (append
                (list
                 (shen/hd V13243))
                (shen/shen\.linearise_X V13241 V13242
                                        (nthcdr 1 V13243)))
               (append
                (list L)
                (nthcdr 1 V13243)))))
   (shen/true V13243)))
(defun shen/shen\.aritycheck
    (V13246 V13247)
  (cl-flet
      ((tail-trampoline
        (V13246 V13247)
        (shen/cond
         ((shen/and
           (shen/cons\? V13247)
           (shen/and
            (shen/cons\?
             (shen/hd V13247))
            (shen/and
             (shen/cons\?
              (nthcdr 1
                      (shen/hd V13247)))
             (shen/and
              (shen/predicate->shen
               (null
                (nthcdr 2
                        (shen/hd V13247))))
              (shen/predicate->shen
               (null
                (nthcdr 1 V13247)))))))
          (shen/do
           (shen/shen\.aritycheck-action
            (shen/hd
             (nthcdr 1
                     (shen/hd V13247))))
           (shen/shen\.aritycheck-name V13246
                                       (shen/arity V13246)
                                       (shen/length
                                        (shen/hd
                                         (shen/hd V13247))))))
         ((shen/and
           (shen/cons\? V13247)
           (shen/and
            (shen/cons\?
             (shen/hd V13247))
            (shen/and
             (shen/cons\?
              (nthcdr 1
                      (shen/hd V13247)))
             (shen/and
              (shen/predicate->shen
               (null
                (nthcdr 2
                        (shen/hd V13247))))
              (shen/and
               (shen/cons\?
                (nthcdr 1 V13247))
               (shen/and
                (shen/cons\?
                 (shen/hd
                  (nthcdr 1 V13247)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1 V13247))))
                 (shen/predicate->shen
                  (null
                   (nthcdr 2
                           (shen/hd
                            (nthcdr 1 V13247))))))))))))
          (shen/if
           (shen/=
            (shen/length
             (shen/hd
              (shen/hd V13247)))
            (shen/length
             (shen/hd
              (shen/hd
               (nthcdr 1 V13247)))))
           (shen/do
            (shen/shen\.aritycheck-action
             (shen/hd
              (nthcdr 1
                      (shen/hd V13247))))
            (vector
             (list V13246
                   (nthcdr 1 V13247))))
           (shen/simple-error
            (shen/cn "arity error in "
                     (shen/shen\.app V13246 "\n" 'shen\.a)))))
         (shen/true
          (shen/shen\.f_error 'shen\.aritycheck)))))
    (let
        ((result
          (funcall #'tail-trampoline V13246 V13247)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.aritycheck-name
    (V13260 V13261 V13262)
  (shen/cond
   ((shen/= -1 V13261)
    V13262)
   ((shen/= V13262 V13261)
    V13262)
   (shen/true
    (shen/do
     (shen/shen\.prhush
      (shen/cn "\nwarning: changing the arity of "
               (shen/shen\.app V13260 " can cause errors.\n" 'shen\.a))
      (shen/stoutput))
     V13262))))
(defun shen/shen\.aritycheck-action
    (V13268)
  (shen/cond
   ((shen/cons\? V13268)
    (shen/do
     (shen/shen\.aah
      (shen/hd V13268)
      (nthcdr 1 V13268))
     (shen/map
      (shen/lambda Y
                   (shen/shen\.aritycheck-action Y))
      V13268)))
   (shen/true 'shen\.skip)))
(defun shen/shen\.aah
    (V13271 V13272)
  (shen/let Arity
            (shen/arity V13271)
            (shen/let Len
                      (shen/length V13272)
                      (shen/if
                       (shen/and
                        (shen/> Arity -1)
                        (shen/> Len Arity))
                       (shen/shen\.prhush
                        (shen/cn "warning: "
                                 (shen/shen\.app V13271
                                                 (shen/cn " might not like "
                                                          (shen/shen\.app Len
                                                                          (shen/cn " argument"
                                                                                   (shen/shen\.app
                                                                                    (shen/if
                                                                                     (shen/> Len 1)
                                                                                     "s" "")
                                                                                    ".\n" 'shen\.a))
                                                                          'shen\.a))
                                                 'shen\.a))
                        (shen/stoutput))
                       'shen\.skip))))
(defun shen/shen\.abstract_rule
    (V13274)
  (shen/cond
   ((shen/and
     (shen/cons\? V13274)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13274))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13274)))))
    (shen/shen\.abstraction_build
     (shen/hd V13274)
     (shen/hd
      (nthcdr 1 V13274))))
   (shen/true
    (shen/shen\.f_error 'shen\.abstract_rule))))
(defun shen/shen\.abstraction_build
    (V13277 V13278)
  (shen/cond
   ((shen/predicate->shen
     (null V13277))
    V13278)
   ((shen/cons\? V13277)
    (list '/\.
          (shen/hd V13277)
          (shen/shen\.abstraction_build
           (nthcdr 1 V13277)
           V13278)))
   (shen/true
    (shen/shen\.f_error 'shen\.abstraction_build))))
(defun shen/shen\.parameters
    (V13280)
  (shen/cond
   ((shen/= 0 V13280)
    nil)
   (shen/true
    (append
     (list
      (shen/gensym 'V))
     (shen/shen\.parameters
      (shen/- V13280 1))))))
(defun shen/shen\.application_build
    (V13283 V13284)
  (cl-flet
      ((tail-trampoline
        (V13283 V13284)
        (shen/cond
         ((shen/predicate->shen
           (null V13283))
          V13284)
         ((shen/cons\? V13283)
          (vector
           (list
            (nthcdr 1 V13283)
            (list V13284
                  (shen/hd V13283)))))
         (shen/true
          (shen/shen\.f_error 'shen\.application_build)))))
    (let
        ((result
          (funcall #'tail-trampoline V13283 V13284)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.compile_to_kl
    (V13287 V13288)
  (shen/cond
   ((shen/and
     (shen/cons\? V13288)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13288))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13288)))))
    (shen/let Arity
              (shen/shen\.store-arity V13287
                                      (shen/length
                                       (shen/hd V13288)))
              (shen/let Reduce
                        (shen/map
                         (shen/lambda X
                                      (shen/shen\.reduce X))
                         (shen/hd
                          (nthcdr 1 V13288)))
                        (shen/let CondExpression
                                  (shen/shen\.cond-expression V13287
                                                              (shen/hd V13288)
                                                              Reduce)
                                  (shen/let TypeTable
                                            (shen/if
                                             (shen/value 'shen\.*optimise*)
                                             (shen/shen\.typextable
                                              (shen/shen\.get-type V13287)
                                              (shen/hd V13288))
                                             'shen\.skip)
                                            (shen/let TypedCondExpression
                                                      (shen/if
                                                       (shen/value 'shen\.*optimise*)
                                                       (shen/shen\.assign-types
                                                        (shen/hd V13288)
                                                        TypeTable CondExpression)
                                                       CondExpression)
                                                      (shen/let KL
                                                                (list 'defun V13287
                                                                      (shen/hd V13288)
                                                                      TypedCondExpression)
                                                                KL)))))))
   (shen/true
    (shen/shen\.f_error 'shen\.compile_to_kl))))
(defun shen/shen\.get-type
    (V13294)
  (shen/cond
   ((shen/cons\? V13294)
    'shen\.skip)
   (shen/true
    (shen/let FType
              (shen/assoc V13294
                          (shen/value 'shen\.*signedfuncs*))
              (shen/if
               (shen/empty\? FType)
               'shen\.skip
               (nthcdr 1 FType))))))
(defun shen/shen\.typextable
    (V13305 V13306)
  (cl-flet
      ((tail-trampoline
        (V13305 V13306)
        (shen/cond
         ((shen/and
           (shen/cons\? V13305)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13305))
            (shen/and
             (shen/= '-->
                     (shen/hd
                      (nthcdr 1 V13305)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13305))
              (shen/and
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13305)))
               (shen/cons\? V13306))))))
          (shen/if
           (shen/variable\?
            (shen/hd V13305))
           (vector
            (list
             (shen/hd
              (nthcdr 2 V13305))
             (nthcdr 1 V13306)))
           (append
            (list
             (append
              (list
               (shen/hd V13306))
              (shen/hd V13305)))
            (shen/shen\.typextable
             (shen/hd
              (nthcdr 2 V13305))
             (nthcdr 1 V13306)))))
         (shen/true nil))))
    (let
        ((result
          (funcall #'tail-trampoline V13305 V13306)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.assign-types
    (V13310 V13311 V13312)
  (shen/cond
   ((shen/and
     (shen/cons\? V13312)
     (shen/and
      (shen/= 'let
              (shen/hd V13312))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13312))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13312))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V13312))
         (shen/predicate->shen
          (null
           (nthcdr 4 V13312))))))))
    (list 'let
          (shen/hd
           (nthcdr 1 V13312))
          (shen/shen\.assign-types V13310 V13311
                                   (shen/hd
                                    (nthcdr 2 V13312)))
          (shen/shen\.assign-types
           (append
            (list
             (shen/hd
              (nthcdr 1 V13312)))
            V13310)
           V13311
           (shen/hd
            (nthcdr 3 V13312)))))
   ((shen/and
     (shen/cons\? V13312)
     (shen/and
      (shen/= 'lambda
              (shen/hd V13312))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13312))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13312))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13312)))))))
    (list 'lambda
          (shen/hd
           (nthcdr 1 V13312))
          (shen/shen\.assign-types
           (append
            (list
             (shen/hd
              (nthcdr 1 V13312)))
            V13310)
           V13311
           (shen/hd
            (nthcdr 2 V13312)))))
   ((shen/and
     (shen/cons\? V13312)
     (shen/= 'cond
             (shen/hd V13312)))
    (append
     (list 'cond)
     (shen/map
      (shen/lambda Y
                   (list
                    (shen/shen\.assign-types V13310 V13311
                                             (shen/hd Y))
                    (shen/shen\.assign-types V13310 V13311
                                             (shen/hd
                                              (nthcdr 1 Y)))))
      (nthcdr 1 V13312))))
   ((shen/cons\? V13312)
    (shen/let NewTable
              (shen/shen\.typextable
               (shen/shen\.get-type
                (shen/hd V13312))
               (nthcdr 1 V13312))
              (append
               (list
                (shen/hd V13312))
               (shen/map
                (shen/lambda Y
                             (shen/shen\.assign-types V13310
                                                      (shen/append V13311 NewTable)
                                                      Y))
                (nthcdr 1 V13312)))))
   (shen/true
    (shen/let AtomType
              (shen/assoc V13312 V13311)
              (shen/if
               (shen/cons\? AtomType)
               (list 'type V13312
                     (nthcdr 1 AtomType))
               (shen/if
                (shen/element\? V13312 V13310)
                V13312
                (shen/shen\.atom-type V13312)))))))
(defun shen/shen\.atom-type
    (V13314)
  (shen/if
   (shen/string\? V13314)
   (list 'type V13314 'string)
   (shen/if
    (shen/number\? V13314)
    (list 'type V13314 'number)
    (shen/if
     (shen/boolean\? V13314)
     (list 'type V13314 'boolean)
     (shen/if
      (shen/symbol\? V13314)
      (list 'type V13314 'symbol)
      V13314)))))
(defun shen/shen\.store-arity
    (V13319 V13320)
  (shen/cond
   ((shen/value 'shen\.*installing-kl*)
    'shen\.skip)
   (shen/true
    (shen/put V13319 'arity V13320
              (shen/value '*property-vector*)))))
(defun shen/shen\.reduce
    (V13322)
  (shen/do
   (shen/set 'shen\.*teststack* nil)
   (shen/let Result
             (shen/shen\.reduce_help V13322)
             (list
              (append
               (list ': 'shen\.tests)
               (shen/reverse
                (shen/value 'shen\.*teststack*)))
              Result))))
(defun shen/shen\.reduce_help
    (V13324)
  (cl-flet
      ((tail-trampoline
        (V13324)
        (shen/cond
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (shen/hd V13324))
            (shen/and
             (shen/= '/\.
                     (shen/hd
                      (shen/hd V13324)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13324)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13324))))
               (shen/and
                (shen/= 'cons
                        (shen/hd
                         (shen/hd
                          (nthcdr 1
                                  (shen/hd V13324)))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13324)))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 2
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd V13324)))))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 3
                             (shen/hd
                              (nthcdr 1
                                      (shen/hd V13324))))))
                   (shen/and
                    (shen/cons\?
                     (nthcdr 2
                             (shen/hd V13324)))
                    (shen/and
                     (shen/predicate->shen
                      (null
                       (nthcdr 3
                               (shen/hd V13324))))
                     (shen/and
                      (shen/cons\?
                       (nthcdr 1 V13324))
                      (shen/predicate->shen
                       (null
                        (nthcdr 2 V13324)))))))))))))))
          (shen/do
           (shen/shen\.add_test
            (append
             (list 'cons\?)
             (nthcdr 1 V13324)))
           (shen/let Abstraction
                     (list '/\.
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd
                                     (nthcdr 1
                                             (shen/hd V13324)))))
                           (list '/\.
                                 (shen/hd
                                  (nthcdr 2
                                          (shen/hd
                                           (nthcdr 1
                                                   (shen/hd V13324)))))
                                 (shen/shen\.ebr
                                  (shen/hd
                                   (nthcdr 1 V13324))
                                  (shen/hd
                                   (nthcdr 1
                                           (shen/hd V13324)))
                                  (shen/hd
                                   (nthcdr 2
                                           (shen/hd V13324))))))
                     (shen/let Application
                               (list
                                (list Abstraction
                                      (append
                                       (list 'hd)
                                       (nthcdr 1 V13324)))
                                (append
                                 (list 'tl)
                                 (nthcdr 1 V13324)))
                               (vector
                                (list Application))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (shen/hd V13324))
            (shen/and
             (shen/= '/\.
                     (shen/hd
                      (shen/hd V13324)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13324)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13324))))
               (shen/and
                (shen/= '@p
                        (shen/hd
                         (shen/hd
                          (nthcdr 1
                                  (shen/hd V13324)))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13324)))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 2
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd V13324)))))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 3
                             (shen/hd
                              (nthcdr 1
                                      (shen/hd V13324))))))
                   (shen/and
                    (shen/cons\?
                     (nthcdr 2
                             (shen/hd V13324)))
                    (shen/and
                     (shen/predicate->shen
                      (null
                       (nthcdr 3
                               (shen/hd V13324))))
                     (shen/and
                      (shen/cons\?
                       (nthcdr 1 V13324))
                      (shen/predicate->shen
                       (null
                        (nthcdr 2 V13324)))))))))))))))
          (shen/do
           (shen/shen\.add_test
            (append
             (list 'tuple\?)
             (nthcdr 1 V13324)))
           (shen/let Abstraction
                     (list '/\.
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd
                                     (nthcdr 1
                                             (shen/hd V13324)))))
                           (list '/\.
                                 (shen/hd
                                  (nthcdr 2
                                          (shen/hd
                                           (nthcdr 1
                                                   (shen/hd V13324)))))
                                 (shen/shen\.ebr
                                  (shen/hd
                                   (nthcdr 1 V13324))
                                  (shen/hd
                                   (nthcdr 1
                                           (shen/hd V13324)))
                                  (shen/hd
                                   (nthcdr 2
                                           (shen/hd V13324))))))
                     (shen/let Application
                               (list
                                (list Abstraction
                                      (append
                                       (list 'fst)
                                       (nthcdr 1 V13324)))
                                (append
                                 (list 'snd)
                                 (nthcdr 1 V13324)))
                               (vector
                                (list Application))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (shen/hd V13324))
            (shen/and
             (shen/= '/\.
                     (shen/hd
                      (shen/hd V13324)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13324)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13324))))
               (shen/and
                (shen/= '@v
                        (shen/hd
                         (shen/hd
                          (nthcdr 1
                                  (shen/hd V13324)))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13324)))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 2
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd V13324)))))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 3
                             (shen/hd
                              (nthcdr 1
                                      (shen/hd V13324))))))
                   (shen/and
                    (shen/cons\?
                     (nthcdr 2
                             (shen/hd V13324)))
                    (shen/and
                     (shen/predicate->shen
                      (null
                       (nthcdr 3
                               (shen/hd V13324))))
                     (shen/and
                      (shen/cons\?
                       (nthcdr 1 V13324))
                      (shen/predicate->shen
                       (null
                        (nthcdr 2 V13324)))))))))))))))
          (shen/do
           (shen/shen\.add_test
            (append
             (list 'shen\.+vector\?)
             (nthcdr 1 V13324)))
           (shen/let Abstraction
                     (list '/\.
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd
                                     (nthcdr 1
                                             (shen/hd V13324)))))
                           (list '/\.
                                 (shen/hd
                                  (nthcdr 2
                                          (shen/hd
                                           (nthcdr 1
                                                   (shen/hd V13324)))))
                                 (shen/shen\.ebr
                                  (shen/hd
                                   (nthcdr 1 V13324))
                                  (shen/hd
                                   (nthcdr 1
                                           (shen/hd V13324)))
                                  (shen/hd
                                   (nthcdr 2
                                           (shen/hd V13324))))))
                     (shen/let Application
                               (list
                                (list Abstraction
                                      (append
                                       (list 'hdv)
                                       (nthcdr 1 V13324)))
                                (append
                                 (list 'tlv)
                                 (nthcdr 1 V13324)))
                               (vector
                                (list Application))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (shen/hd V13324))
            (shen/and
             (shen/= '/\.
                     (shen/hd
                      (shen/hd V13324)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13324)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13324))))
               (shen/and
                (shen/= '@s
                        (shen/hd
                         (shen/hd
                          (nthcdr 1
                                  (shen/hd V13324)))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13324)))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 2
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd V13324)))))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 3
                             (shen/hd
                              (nthcdr 1
                                      (shen/hd V13324))))))
                   (shen/and
                    (shen/cons\?
                     (nthcdr 2
                             (shen/hd V13324)))
                    (shen/and
                     (shen/predicate->shen
                      (null
                       (nthcdr 3
                               (shen/hd V13324))))
                     (shen/and
                      (shen/cons\?
                       (nthcdr 1 V13324))
                      (shen/predicate->shen
                       (null
                        (nthcdr 2 V13324)))))))))))))))
          (shen/do
           (shen/shen\.add_test
            (append
             (list 'shen\.+string\?)
             (nthcdr 1 V13324)))
           (shen/let Abstraction
                     (list '/\.
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd
                                     (nthcdr 1
                                             (shen/hd V13324)))))
                           (list '/\.
                                 (shen/hd
                                  (nthcdr 2
                                          (shen/hd
                                           (nthcdr 1
                                                   (shen/hd V13324)))))
                                 (shen/shen\.ebr
                                  (shen/hd
                                   (nthcdr 1 V13324))
                                  (shen/hd
                                   (nthcdr 1
                                           (shen/hd V13324)))
                                  (shen/hd
                                   (nthcdr 2
                                           (shen/hd V13324))))))
                     (shen/let Application
                               (list
                                (list Abstraction
                                      (list 'pos
                                            (shen/hd
                                             (nthcdr 1 V13324))
                                            0))
                                (append
                                 (list 'tlstr)
                                 (nthcdr 1 V13324)))
                               (vector
                                (list Application))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (shen/hd V13324))
            (shen/and
             (shen/= '/\.
                     (shen/hd
                      (shen/hd V13324)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13324)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13324)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13324))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13324))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 2 V13324)))
                  (shen/not
                   (shen/variable\?
                    (shen/hd
                     (nthcdr 1
                             (shen/hd V13324)))))))))))))
          (shen/do
           (shen/shen\.add_test
            (append
             (list '=
                   (shen/hd
                    (nthcdr 1
                            (shen/hd V13324))))
             (nthcdr 1 V13324)))
           (vector
            (list
             (shen/hd
              (nthcdr 2
                      (shen/hd V13324)))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (shen/hd V13324))
            (shen/and
             (shen/= '/\.
                     (shen/hd
                      (shen/hd V13324)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13324)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13324)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13324))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13324))
                 (shen/predicate->shen
                  (null
                   (nthcdr 2 V13324))))))))))
          (vector
           (list
            (shen/shen\.ebr
             (shen/hd
              (nthcdr 1 V13324))
             (shen/hd
              (nthcdr 1
                      (shen/hd V13324)))
             (shen/hd
              (nthcdr 2
                      (shen/hd V13324)))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/= 'where
                    (shen/hd V13324))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13324))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13324))
              (shen/predicate->shen
               (null
                (nthcdr 3 V13324)))))))
          (shen/do
           (shen/shen\.add_test
            (shen/hd
             (nthcdr 1 V13324)))
           (vector
            (list
             (shen/hd
              (nthcdr 2 V13324))))))
         ((shen/and
           (shen/cons\? V13324)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13324))
            (shen/predicate->shen
             (null
              (nthcdr 2 V13324)))))
          (shen/let Z
                    (shen/shen\.reduce_help
                     (shen/hd V13324))
                    (shen/if
                     (shen/=
                      (shen/hd V13324)
                      Z)
                     V13324
                     (vector
                      (list
                       (append
                        (list Z)
                        (nthcdr 1 V13324)))))))
         (shen/true V13324))))
    (let
        ((result
          (funcall #'tail-trampoline V13324)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.+string\?
    (V13326)
  (shen/cond
   ((shen/= "" V13326)
    'false)
   (shen/true
    (shen/string\? V13326))))
(defun shen/shen\.+vector
    (V13328)
  (shen/cond
   ((shen/= V13328
            (shen/vector 0))
    'false)
   (shen/true
    (shen/vector\? V13328))))
(defun shen/shen\.ebr
    (V13342 V13343 V13344)
  (shen/cond
   ((shen/= V13344 V13343)
    V13342)
   ((shen/and
     (shen/cons\? V13344)
     (shen/and
      (shen/= '/\.
              (shen/hd V13344))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13344))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13344))
        (shen/and
         (shen/predicate->shen
          (null
           (nthcdr 3 V13344)))
         (shen/>
          (shen/occurrences V13343
                            (shen/hd
                             (nthcdr 1 V13344)))
          0))))))
    V13344)
   ((shen/and
     (shen/cons\? V13344)
     (shen/and
      (shen/= 'lambda
              (shen/hd V13344))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13344))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13344))
        (shen/and
         (shen/predicate->shen
          (null
           (nthcdr 3 V13344)))
         (shen/>
          (shen/occurrences V13343
                            (shen/hd
                             (nthcdr 1 V13344)))
          0))))))
    V13344)
   ((shen/and
     (shen/cons\? V13344)
     (shen/and
      (shen/= 'let
              (shen/hd V13344))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13344))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13344))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V13344))
         (shen/and
          (shen/predicate->shen
           (null
            (nthcdr 4 V13344)))
          (shen/=
           (shen/hd
            (nthcdr 1 V13344))
           V13343)))))))
    (append
     (list 'let
           (shen/hd
            (nthcdr 1 V13344))
           (shen/shen\.ebr V13342
                           (shen/hd
                            (nthcdr 1 V13344))
                           (shen/hd
                            (nthcdr 2 V13344))))
     (nthcdr 3 V13344)))
   ((shen/cons\? V13344)
    (append
     (list
      (shen/shen\.ebr V13342 V13343
                      (shen/hd V13344)))
     (shen/shen\.ebr V13342 V13343
                     (nthcdr 1 V13344))))
   (shen/true V13344)))
(defun shen/shen\.add_test
    (V13346)
  (shen/set 'shen\.*teststack*
            (append
             (list V13346)
             (shen/value 'shen\.*teststack*))))
(defun shen/shen\.cond-expression
    (V13350 V13351 V13352)
  (shen/let Err
            (shen/shen\.err-condition V13350)
            (shen/let Cases
                      (shen/shen\.case-form V13352 Err)
                      (shen/let EncodeChoices
                                (shen/shen\.encode-choices Cases V13350)
                                (shen/shen\.cond-form EncodeChoices)))))
(defun shen/shen\.cond-form
    (V13356)
  (shen/cond
   ((shen/and
     (shen/cons\? V13356)
     (shen/and
      (shen/cons\?
       (shen/hd V13356))
      (shen/and
       (shen/= 'true
               (shen/hd
                (shen/hd V13356)))
       (shen/and
        (shen/cons\?
         (nthcdr 1
                 (shen/hd V13356)))
        (shen/predicate->shen
         (null
          (nthcdr 2
                  (shen/hd V13356))))))))
    (shen/hd
     (nthcdr 1
             (shen/hd V13356))))
   (shen/true
    (append
     (list 'cond)
     V13356))))
(defun shen/shen\.encode-choices
    (V13361 V13362)
  (shen/cond
   ((shen/predicate->shen
     (null V13361))
    nil)
   ((shen/and
     (shen/cons\? V13361)
     (shen/and
      (shen/cons\?
       (shen/hd V13361))
      (shen/and
       (shen/= 'true
               (shen/hd
                (shen/hd V13361)))
       (shen/and
        (shen/cons\?
         (nthcdr 1
                 (shen/hd V13361)))
        (shen/and
         (shen/cons\?
          (shen/hd
           (nthcdr 1
                   (shen/hd V13361))))
         (shen/and
          (shen/= 'shen\.choicepoint!
                  (shen/hd
                   (shen/hd
                    (nthcdr 1
                            (shen/hd V13361)))))
          (shen/and
           (shen/cons\?
            (nthcdr 1
                    (shen/hd
                     (nthcdr 1
                             (shen/hd V13361)))))
           (shen/and
            (shen/predicate->shen
             (null
              (nthcdr 2
                      (shen/hd
                       (nthcdr 1
                               (shen/hd V13361))))))
            (shen/and
             (shen/predicate->shen
              (null
               (nthcdr 2
                       (shen/hd V13361))))
             (shen/predicate->shen
              (null
               (nthcdr 1 V13361))))))))))))
    (list
     (list 'true
           (list 'let 'Result
                 (shen/hd
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13361)))))
                 (list 'if
                       (list '= 'Result
                             (list 'fail))
                       (shen/if
                        (shen/value 'shen\.*installing-kl*)
                        (list 'shen\.sys-error V13362)
                        (list 'shen\.f_error V13362))
                       'Result)))))
   ((shen/and
     (shen/cons\? V13361)
     (shen/and
      (shen/cons\?
       (shen/hd V13361))
      (shen/and
       (shen/= 'true
               (shen/hd
                (shen/hd V13361)))
       (shen/and
        (shen/cons\?
         (nthcdr 1
                 (shen/hd V13361)))
        (shen/and
         (shen/cons\?
          (shen/hd
           (nthcdr 1
                   (shen/hd V13361))))
         (shen/and
          (shen/= 'shen\.choicepoint!
                  (shen/hd
                   (shen/hd
                    (nthcdr 1
                            (shen/hd V13361)))))
          (shen/and
           (shen/cons\?
            (nthcdr 1
                    (shen/hd
                     (nthcdr 1
                             (shen/hd V13361)))))
           (shen/and
            (shen/predicate->shen
             (null
              (nthcdr 2
                      (shen/hd
                       (nthcdr 1
                               (shen/hd V13361))))))
            (shen/predicate->shen
             (null
              (nthcdr 2
                      (shen/hd V13361))))))))))))
    (list
     (list 'true
           (list 'let 'Result
                 (shen/hd
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13361)))))
                 (list 'if
                       (list '= 'Result
                             (list 'fail))
                       (shen/shen\.cond-form
                        (shen/shen\.encode-choices
                         (nthcdr 1 V13361)
                         V13362))
                       'Result)))))
   ((shen/and
     (shen/cons\? V13361)
     (shen/and
      (shen/cons\?
       (shen/hd V13361))
      (shen/and
       (shen/cons\?
        (nthcdr 1
                (shen/hd V13361)))
       (shen/and
        (shen/cons\?
         (shen/hd
          (nthcdr 1
                  (shen/hd V13361))))
        (shen/and
         (shen/= 'shen\.choicepoint!
                 (shen/hd
                  (shen/hd
                   (nthcdr 1
                           (shen/hd V13361)))))
         (shen/and
          (shen/cons\?
           (nthcdr 1
                   (shen/hd
                    (nthcdr 1
                            (shen/hd V13361)))))
          (shen/and
           (shen/predicate->shen
            (null
             (nthcdr 2
                     (shen/hd
                      (nthcdr 1
                              (shen/hd V13361))))))
           (shen/predicate->shen
            (null
             (nthcdr 2
                     (shen/hd V13361)))))))))))
    (list
     (list 'true
           (list 'let 'Freeze
                 (list 'freeze
                       (shen/shen\.cond-form
                        (shen/shen\.encode-choices
                         (nthcdr 1 V13361)
                         V13362)))
                 (list 'if
                       (shen/hd
                        (shen/hd V13361))
                       (list 'let 'Result
                             (shen/hd
                              (nthcdr 1
                                      (shen/hd
                                       (nthcdr 1
                                               (shen/hd V13361)))))
                             (list 'if
                                   (list '= 'Result
                                         (list 'fail))
                                   (list 'thaw 'Freeze)
                                   'Result))
                       (list 'thaw 'Freeze))))))
   ((shen/and
     (shen/cons\? V13361)
     (shen/and
      (shen/cons\?
       (shen/hd V13361))
      (shen/and
       (shen/cons\?
        (nthcdr 1
                (shen/hd V13361)))
       (shen/predicate->shen
        (null
         (nthcdr 2
                 (shen/hd V13361)))))))
    (append
     (list
      (shen/hd V13361))
     (shen/shen\.encode-choices
      (nthcdr 1 V13361)
      V13362)))
   (shen/true
    (shen/shen\.f_error 'shen\.encode-choices))))
(defun shen/shen\.case-form
    (V13369 V13370)
  (shen/cond
   ((shen/predicate->shen
     (null V13369))
    (list V13370))
   ((shen/and
     (shen/cons\? V13369)
     (shen/and
      (shen/cons\?
       (shen/hd V13369))
      (shen/and
       (shen/cons\?
        (shen/hd
         (shen/hd V13369)))
       (shen/and
        (shen/= ':
                (shen/hd
                 (shen/hd
                  (shen/hd V13369))))
        (shen/and
         (shen/cons\?
          (nthcdr 1
                  (shen/hd
                   (shen/hd V13369))))
         (shen/and
          (shen/= 'shen\.tests
                  (shen/hd
                   (nthcdr 1
                           (shen/hd
                            (shen/hd V13369)))))
          (shen/and
           (shen/predicate->shen
            (null
             (nthcdr 2
                     (shen/hd
                      (shen/hd V13369)))))
           (shen/and
            (shen/cons\?
             (nthcdr 1
                     (shen/hd V13369)))
            (shen/and
             (shen/cons\?
              (shen/hd
               (nthcdr 1
                       (shen/hd V13369))))
             (shen/and
              (shen/= 'shen\.choicepoint!
                      (shen/hd
                       (shen/hd
                        (nthcdr 1
                                (shen/hd V13369)))))
              (shen/and
               (shen/cons\?
                (nthcdr 1
                        (shen/hd
                         (nthcdr 1
                                 (shen/hd V13369)))))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 2
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13369))))))
                (shen/predicate->shen
                 (null
                  (nthcdr 2
                          (shen/hd V13369))))))))))))))))
    (append
     (list
      (append
       (list 'true)
       (nthcdr 1
               (shen/hd V13369))))
     (shen/shen\.case-form
      (nthcdr 1 V13369)
      V13370)))
   ((shen/and
     (shen/cons\? V13369)
     (shen/and
      (shen/cons\?
       (shen/hd V13369))
      (shen/and
       (shen/cons\?
        (shen/hd
         (shen/hd V13369)))
       (shen/and
        (shen/= ':
                (shen/hd
                 (shen/hd
                  (shen/hd V13369))))
        (shen/and
         (shen/cons\?
          (nthcdr 1
                  (shen/hd
                   (shen/hd V13369))))
         (shen/and
          (shen/= 'shen\.tests
                  (shen/hd
                   (nthcdr 1
                           (shen/hd
                            (shen/hd V13369)))))
          (shen/and
           (shen/predicate->shen
            (null
             (nthcdr 2
                     (shen/hd
                      (shen/hd V13369)))))
           (shen/and
            (shen/cons\?
             (nthcdr 1
                     (shen/hd V13369)))
            (shen/predicate->shen
             (null
              (nthcdr 2
                      (shen/hd V13369))))))))))))
    (list
     (append
      (list 'true)
      (nthcdr 1
              (shen/hd V13369)))))
   ((shen/and
     (shen/cons\? V13369)
     (shen/and
      (shen/cons\?
       (shen/hd V13369))
      (shen/and
       (shen/cons\?
        (shen/hd
         (shen/hd V13369)))
       (shen/and
        (shen/= ':
                (shen/hd
                 (shen/hd
                  (shen/hd V13369))))
        (shen/and
         (shen/cons\?
          (nthcdr 1
                  (shen/hd
                   (shen/hd V13369))))
         (shen/and
          (shen/= 'shen\.tests
                  (shen/hd
                   (nthcdr 1
                           (shen/hd
                            (shen/hd V13369)))))
          (shen/and
           (shen/cons\?
            (nthcdr 1
                    (shen/hd V13369)))
           (shen/predicate->shen
            (null
             (nthcdr 2
                     (shen/hd V13369)))))))))))
    (append
     (list
      (append
       (list
        (shen/shen\.embed-and
         (nthcdr 2
                 (shen/hd
                  (shen/hd V13369)))))
       (nthcdr 1
               (shen/hd V13369))))
     (shen/shen\.case-form
      (nthcdr 1 V13369)
      V13370)))
   (shen/true
    (shen/shen\.f_error 'shen\.case-form))))
(defun shen/shen\.embed-and
    (V13372)
  (shen/cond
   ((shen/and
     (shen/cons\? V13372)
     (shen/predicate->shen
      (null
       (nthcdr 1 V13372))))
    (shen/hd V13372))
   ((shen/cons\? V13372)
    (list 'and
          (shen/hd V13372)
          (shen/shen\.embed-and
           (nthcdr 1 V13372))))
   (shen/true
    (shen/shen\.f_error 'shen\.embed-and))))
(defun shen/shen\.err-condition
    (V13374)
  (list 'true
        (list 'shen\.f_error V13374)))
(defun shen/shen\.sys-error
    (V13376)
  (shen/simple-error
   (shen/cn "system function "
            (shen/shen\.app V13376 ": unexpected argument\n" 'shen\.a))))
(defun shen/thaw
    (V14536)
  (shen/internal/apply-higher-order-function V14536
                                             (list)))
(defun shen/eval
    (V14538)
  (shen/let Macroexpand
            (shen/shen\.walk
             (shen/lambda Y
                          (shen/macroexpand Y))
             V14538)
            (shen/if
             (shen/shen\.packaged\? Macroexpand)
             (shen/map
              (shen/lambda Z
                           (shen/shen\.eval-without-macros Z))
              (shen/shen\.package-contents Macroexpand))
             (shen/shen\.eval-without-macros Macroexpand))))
(defun shen/shen\.eval-without-macros
    (V14540)
  (shen/eval-kl
   (shen/shen\.elim-def
    (shen/shen\.proc-input+ V14540))))
(defun shen/shen\.proc-input+
    (V14542)
  (shen/cond
   ((shen/and
     (shen/cons\? V14542)
     (shen/and
      (shen/= 'input+
              (shen/hd V14542))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14542))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V14542))
        (shen/predicate->shen
         (null
          (nthcdr 3 V14542)))))))
    (append
     (list 'input+
           (shen/shen\.rcons_form
            (shen/hd
             (nthcdr 1 V14542))))
     (nthcdr 2 V14542)))
   ((shen/and
     (shen/cons\? V14542)
     (shen/and
      (shen/= 'shen\.read+
              (shen/hd V14542))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14542))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V14542))
        (shen/predicate->shen
         (null
          (nthcdr 3 V14542)))))))
    (append
     (list 'shen\.read+
           (shen/shen\.rcons_form
            (shen/hd
             (nthcdr 1 V14542))))
     (nthcdr 2 V14542)))
   ((shen/cons\? V14542)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.proc-input+ Z))
     V14542))
   (shen/true V14542)))
(defun shen/shen\.elim-def
    (V14544)
  (cl-flet
      ((tail-trampoline
        (V14544)
        (shen/cond
         ((shen/and
           (shen/cons\? V14544)
           (shen/and
            (shen/= 'define
                    (shen/hd V14544))
            (shen/cons\?
             (nthcdr 1 V14544))))
          (shen/shen\.shen->kl
           (shen/hd
            (nthcdr 1 V14544))
           (nthcdr 2 V14544)))
         ((shen/and
           (shen/cons\? V14544)
           (shen/and
            (shen/= 'defmacro
                    (shen/hd V14544))
            (shen/cons\?
             (nthcdr 1 V14544))))
          (shen/let Default
                    (list 'X '-> 'X)
                    (shen/let Def
                              (shen/shen\.elim-def
                               (append
                                (list 'define
                                      (shen/hd
                                       (nthcdr 1 V14544)))
                                (shen/append
                                 (nthcdr 2 V14544)
                                 Default)))
                              (shen/let MacroAdd
                                        (shen/shen\.add-macro
                                         (shen/hd
                                          (nthcdr 1 V14544)))
                                        Def))))
         ((shen/and
           (shen/cons\? V14544)
           (shen/and
            (shen/= 'defcc
                    (shen/hd V14544))
            (shen/cons\?
             (nthcdr 1 V14544))))
          (vector
           (list
            (shen/shen\.yacc V14544))))
         ((shen/cons\? V14544)
          (shen/map
           (shen/lambda Z
                        (shen/shen\.elim-def Z))
           V14544))
         (shen/true V14544))))
    (let
        ((result
          (funcall #'tail-trampoline V14544)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.add-macro
    (V14546)
  (shen/let MacroReg
            (shen/value 'shen\.*macroreg*)
            (shen/let NewMacroReg
                      (shen/set 'shen\.*macroreg*
                                (shen/adjoin V14546
                                             (shen/value 'shen\.*macroreg*)))
                      (shen/if
                       (shen/= MacroReg NewMacroReg)
                       'shen\.skip
                       (shen/set '*macros*
                                 (append
                                  (list
                                   (shen/function V14546))
                                  (shen/value '*macros*)))))))
(defun shen/shen\.packaged\?
    (V14554)
  (shen/cond
   ((shen/and
     (shen/cons\? V14554)
     (shen/and
      (shen/= 'package
              (shen/hd V14554))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14554))
       (shen/cons\?
        (nthcdr 2 V14554)))))
    'true)
   (shen/true 'false)))
(defun shen/external
    (V14556)
  (shen/trap-error
   (shen/get V14556 'shen\.external-symbols
             (shen/value '*property-vector*))
   (shen/lambda E
                (shen/simple-error
                 (shen/cn "package "
                          (shen/shen\.app V14556 " has not been used.\n" 'shen\.a))))))
(defun shen/internal
    (V14558)
  (shen/trap-error
   (shen/get V14558 'shen\.internal-symbols
             (shen/value '*property-vector*))
   (shen/lambda E
                (shen/simple-error
                 (shen/cn "package "
                          (shen/shen\.app V14558 " has not been used.\n" 'shen\.a))))))
(defun shen/shen\.package-contents
    (V14562)
  (shen/cond
   ((shen/and
     (shen/cons\? V14562)
     (shen/and
      (shen/= 'package
              (shen/hd V14562))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14562))
       (shen/and
        (shen/= 'null
                (shen/hd
                 (nthcdr 1 V14562)))
        (shen/cons\?
         (nthcdr 2 V14562))))))
    (nthcdr 3 V14562))
   ((shen/and
     (shen/cons\? V14562)
     (shen/and
      (shen/= 'package
              (shen/hd V14562))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14562))
       (shen/cons\?
        (nthcdr 2 V14562)))))
    (shen/shen\.packageh
     (shen/hd
      (nthcdr 1 V14562))
     (shen/hd
      (nthcdr 2 V14562))
     (nthcdr 3 V14562)))
   (shen/true
    (shen/shen\.f_error 'shen\.package-contents))))
(defun shen/shen\.walk
    (V14565 V14566)
  (shen/cond
   ((shen/cons\? V14566)
    (shen/internal/apply-higher-order-function V14565
                                               (list
                                                (shen/map
                                                 (shen/lambda Z
                                                              (shen/shen\.walk V14565 Z))
                                                 V14566))))
   (shen/true
    (shen/internal/apply-higher-order-function V14565
                                               (list V14566)))))
(defun shen/compile
    (V14570 V14571 V14572)
  (shen/let O
            (shen/internal/apply-higher-order-function V14570
                                                       (list
                                                        (list V14571 nil)))
            (shen/if
             (shen/or
              (shen/=
               (shen/fail)
               O)
              (shen/not
               (shen/empty\?
                (shen/hd O))))
             (shen/internal/apply-higher-order-function V14572
                                                        (list O))
             (shen/shen\.hdtl O))))
(defun shen/fail-if
    (V14575 V14576)
  (shen/if
   (shen/internal/apply-higher-order-function V14575
                                              (list V14576))
   (shen/fail)
   V14576))
(defun shen/@s
    (V14579 V14580)
  (shen/cn V14579 V14580))
(defun shen/tc\? nil
  (shen/value 'shen\.*tc*))
(defun shen/ps
    (V14582)
  (shen/trap-error
   (shen/get V14582 'shen\.source
             (shen/value '*property-vector*))
   (shen/lambda E
                (shen/simple-error
                 (shen/shen\.app V14582 " not found.\n" 'shen\.a)))))
(defun shen/stinput nil
  (shen/value '*stinput*))
(defun shen/shen\.+vector\?
    (V14584)
  (shen/and
   (shen/absvector\? V14584)
   (shen/>
    (shen/<-address V14584 0)
    0)))
(defun shen/vector
    (V14586)
  (shen/let Vector
            (shen/absvector
             (1+ V14586))
            (shen/let ZeroStamp
                      (shen/address-> Vector 0 V14586)
                      (shen/let Standard
                                (shen/if
                                 (shen/= V14586 0)
                                 ZeroStamp
                                 (shen/shen\.fillvector ZeroStamp 1 V14586
                                                        (shen/fail)))
                                Standard))))
(defun shen/shen\.fillvector
    (V14592 V14593 V14594 V14595)
  (cl-flet
      ((tail-trampoline
        (V14592 V14593 V14594 V14595)
        (shen/cond
         ((shen/= V14594 V14593)
          (shen/address-> V14592 V14594 V14595))
         (shen/true
          (vector
           (list
            (shen/address-> V14592 V14593 V14595)
            (1+ V14593)
            V14594 V14595))))))
    (let
        ((result
          (funcall #'tail-trampoline V14592 V14593 V14594 V14595)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/vector\?
    (V14597)
  (shen/and
   (shen/absvector\? V14597)
   (shen/trap-error
    (shen/>=
     (shen/<-address V14597 0)
     0)
    (shen/lambda E 'false))))
(defun shen/vector->
    (V14601 V14602 V14603)
  (shen/if
   (shen/= V14602 0)
   (shen/simple-error "cannot access 0th element of a vector\n")
   (shen/address-> V14601 V14602 V14603)))
(defun shen/<-vector
    (V14606 V14607)
  (shen/if
   (shen/= V14607 0)
   (shen/simple-error "cannot access 0th element of a vector\n")
   (shen/let VectorElement
             (shen/<-address V14606 V14607)
             (shen/if
              (shen/= VectorElement
                      (shen/fail))
              (shen/simple-error "vector element not found\n")
              VectorElement))))
(defun shen/shen\.posint\?
    (V14609)
  (shen/and
   (shen/integer\? V14609)
   (shen/>= V14609 0)))
(defun shen/limit
    (V14611)
  (shen/<-address V14611 0))
(defun shen/symbol\?
    (V14613)
  (shen/cond
   ((shen/or
     (shen/boolean\? V14613)
     (shen/or
      (shen/number\? V14613)
      (shen/string\? V14613)))
    'false)
   (shen/true
    (shen/trap-error
     (shen/let String
               (shen/str V14613)
               (shen/shen\.analyse-symbol\? String))
     (shen/lambda E 'false)))))
(defun shen/shen\.analyse-symbol\?
    (V14615)
  (shen/cond
   ((shen/shen\.+string\? V14615)
    (shen/and
     (shen/shen\.alpha\?
      (shen/pos V14615 0))
     (shen/shen\.alphanums\?
      (shen/tlstr V14615))))
   (shen/true
    (shen/shen\.f_error 'shen\.analyse-symbol\?))))
(defun shen/shen\.alpha\?
    (V14617)
  (shen/element\? V14617
                  (list "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z" "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v" "w" "x" "y" "z" "=" "*" "/" "+" "-" "_" "?" "$" "!" "@" "~" ">" "<" "&" "%" "{" "}" ":" ";" "`" "#" "'" ".")))
(defun shen/shen\.alphanums\?
    (V14619)
  (shen/cond
   ((shen/= "" V14619)
    'true)
   ((shen/shen\.+string\? V14619)
    (shen/and
     (shen/shen\.alphanum\?
      (shen/pos V14619 0))
     (shen/shen\.alphanums\?
      (shen/tlstr V14619))))
   (shen/true
    (shen/shen\.f_error 'shen\.alphanums\?))))
(defun shen/shen\.alphanum\?
    (V14621)
  (shen/or
   (shen/shen\.alpha\? V14621)
   (shen/shen\.digit\? V14621)))
(defun shen/shen\.digit\?
    (V14623)
  (shen/element\? V14623
                  (list "1" "2" "3" "4" "5" "6" "7" "8" "9" "0")))
(defun shen/variable\?
    (V14625)
  (shen/cond
   ((shen/or
     (shen/boolean\? V14625)
     (shen/or
      (shen/number\? V14625)
      (shen/string\? V14625)))
    'false)
   (shen/true
    (shen/trap-error
     (shen/let String
               (shen/str V14625)
               (shen/shen\.analyse-variable\? String))
     (shen/lambda E 'false)))))
(defun shen/shen\.analyse-variable\?
    (V14627)
  (shen/cond
   ((shen/shen\.+string\? V14627)
    (shen/and
     (shen/shen\.uppercase\?
      (shen/pos V14627 0))
     (shen/shen\.alphanums\?
      (shen/tlstr V14627))))
   (shen/true
    (shen/shen\.f_error 'shen\.analyse-variable\?))))
(defun shen/shen\.uppercase\?
    (V14629)
  (shen/element\? V14629
                  (list "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z")))
(defun shen/gensym
    (V14631)
  (shen/concat V14631
               (shen/set 'shen\.*gensym*
                         (1+
                          (shen/value 'shen\.*gensym*)))))
(defun shen/concat
    (V14634 V14635)
  (shen/intern
   (shen/cn
    (shen/str V14634)
    (shen/str V14635))))
(defun shen/@p
    (V14638 V14639)
  (shen/let Vector
            (shen/absvector 3)
            (shen/let Tag
                      (shen/address-> Vector 0 'shen\.tuple)
                      (shen/let Fst
                                (shen/address-> Vector 1 V14638)
                                (shen/let Snd
                                          (shen/address-> Vector 2 V14639)
                                          Vector)))))
(defun shen/fst
    (V14641)
  (shen/<-address V14641 1))
(defun shen/snd
    (V14643)
  (shen/<-address V14643 2))
(defun shen/tuple\?
    (V14645)
  (shen/trap-error
   (shen/and
    (shen/absvector\? V14645)
    (shen/= 'shen\.tuple
            (shen/<-address V14645 0)))
   (shen/lambda E 'false)))
(defun shen/append
    (Xs Ys)
  (append Xs Ys))
(defun shen/@v
    (V14652 V14653)
  (shen/let Limit
            (shen/limit V14653)
            (shen/let NewVector
                      (shen/vector
                       (1+ Limit))
                      (shen/let X+NewVector
                                (shen/vector-> NewVector 1 V14652)
                                (shen/if
                                 (shen/= Limit 0)
                                 X+NewVector
                                 (shen/shen\.@v-help V14653 1 Limit X+NewVector))))))
(defun shen/shen\.@v-help
    (V14659 V14660 V14661 V14662)
  (cl-flet
      ((tail-trampoline
        (V14659 V14660 V14661 V14662)
        (shen/cond
         ((shen/= V14661 V14660)
          (shen/shen\.copyfromvector V14659 V14662 V14661
                                     (1+ V14661)))
         (shen/true
          (vector
           (list V14659
                 (1+ V14660)
                 V14661
                 (shen/shen\.copyfromvector V14659 V14662 V14660
                                            (1+ V14660))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14659 V14660 V14661 V14662)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.copyfromvector
    (V14667 V14668 V14669 V14670)
  (shen/trap-error
   (shen/vector-> V14668 V14670
                  (shen/<-vector V14667 V14669))
   (shen/lambda E V14668)))
(defun shen/hdv
    (V14672)
  (shen/trap-error
   (shen/<-vector V14672 1)
   (shen/lambda E
                (shen/simple-error
                 (shen/cn "hdv needs a non-empty vector as an argument; not "
                          (shen/shen\.app V14672 "\n" 'shen\.s))))))
(defun shen/tlv
    (V14674)
  (shen/let Limit
            (shen/limit V14674)
            (shen/if
             (shen/= Limit 0)
             (shen/simple-error "cannot take the tail of the empty vector\n")
             (shen/if
              (shen/= Limit 1)
              (shen/vector 0)
              (shen/let NewVector
                        (shen/vector
                         (shen/- Limit 1))
                        (shen/shen\.tlv-help V14674 2 Limit
                                             (shen/vector
                                              (shen/- Limit 1))))))))
(defun shen/shen\.tlv-help
    (V14680 V14681 V14682 V14683)
  (cl-flet
      ((tail-trampoline
        (V14680 V14681 V14682 V14683)
        (shen/cond
         ((shen/= V14682 V14681)
          (shen/shen\.copyfromvector V14680 V14683 V14682
                                     (shen/- V14682 1)))
         (shen/true
          (vector
           (list V14680
                 (1+ V14681)
                 V14682
                 (shen/shen\.copyfromvector V14680 V14683 V14681
                                            (shen/- V14681 1))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14680 V14681 V14682 V14683)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/assoc
    (V14695 V14696)
  (cl-flet
      ((tail-trampoline
        (V14695 V14696)
        (shen/cond
         ((shen/predicate->shen
           (null V14696))
          nil)
         ((shen/and
           (shen/cons\? V14696)
           (shen/and
            (shen/cons\?
             (shen/hd V14696))
            (shen/=
             (shen/hd
              (shen/hd V14696))
             V14695)))
          (shen/hd V14696))
         ((shen/cons\? V14696)
          (vector
           (list V14695
                 (nthcdr 1 V14696))))
         (shen/true
          (shen/shen\.f_error 'assoc)))))
    (let
        ((result
          (funcall #'tail-trampoline V14695 V14696)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/boolean\?
    (V14702)
  (shen/cond
   ((shen/= 'true V14702)
    'true)
   ((shen/= 'false V14702)
    'true)
   (shen/true 'false)))
(defun shen/nl
    (V14704)
  (cl-flet
      ((tail-trampoline
        (V14704)
        (shen/cond
         ((shen/= 0 V14704)
          0)
         (shen/true
          (shen/do
           (shen/shen\.prhush "\n"
                              (shen/stoutput))
           (vector
            (list
             (shen/- V14704 1))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14704)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/difference
    (V14709 V14710)
  (cl-flet
      ((tail-trampoline
        (V14709 V14710)
        (shen/cond
         ((shen/predicate->shen
           (null V14709))
          nil)
         ((shen/cons\? V14709)
          (shen/if
           (shen/element\?
            (shen/hd V14709)
            V14710)
           (vector
            (list
             (nthcdr 1 V14709)
             V14710))
           (append
            (list
             (shen/hd V14709))
            (shen/difference
             (nthcdr 1 V14709)
             V14710))))
         (shen/true
          (shen/shen\.f_error 'difference)))))
    (let
        ((result
          (funcall #'tail-trampoline V14709 V14710)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/do
    (V14713 V14714)
  V14714)
(defun shen/element\?
    (V14726 V14727)
  (cl-flet
      ((tail-trampoline
        (V14726 V14727)
        (shen/cond
         ((shen/predicate->shen
           (null V14727))
          'false)
         ((shen/and
           (shen/cons\? V14727)
           (shen/=
            (shen/hd V14727)
            V14726))
          'true)
         ((shen/cons\? V14727)
          (vector
           (list V14726
                 (nthcdr 1 V14727))))
         (shen/true
          (shen/shen\.f_error 'element\?)))))
    (let
        ((result
          (funcall #'tail-trampoline V14726 V14727)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/empty\?
    (V14733)
  (shen/cond
   ((shen/predicate->shen
     (null V14733))
    'true)
   (shen/true 'false)))
(defun shen/fix
    (V14736 V14737)
  (shen/shen\.fix-help V14736 V14737
                       (shen/internal/apply-higher-order-function V14736
                                                                  (list V14737))))
(defun shen/shen\.fix-help
    (V14748 V14749 V14750)
  (cl-flet
      ((tail-trampoline
        (V14748 V14749 V14750)
        (shen/cond
         ((shen/= V14750 V14749)
          V14750)
         (shen/true
          (vector
           (list V14748 V14750
                 (shen/internal/apply-higher-order-function V14748
                                                            (list V14750))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14748 V14749 V14750)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/put
    (Pointer Key Value Table)
  (let
      ((Subtable
        (gethash Pointer Table)))
    (if
        (not Subtable)
        (let
            ((Subtable
              (make-hash-table :test 'equal)))
          (progn
            (puthash Pointer Subtable Table)
            (puthash Key Value Subtable)))
      (puthash Key Value Subtable))))
(defun shen/unput
    (Pointer Key Table)
  (let
      ((Subtable
        (gethash Pointer Table)))
    (and Subtable
         (remhash Key Subtable))
    Pointer))
(defun shen/shen\.remove-pointer
    (V14772 V14773 V14774)
  (shen/cond
   ((shen/predicate->shen
     (null V14774))
    nil)
   ((shen/and
     (shen/cons\? V14774)
     (shen/and
      (shen/cons\?
       (shen/hd V14774))
      (shen/and
       (shen/cons\?
        (shen/hd
         (shen/hd V14774)))
       (shen/and
        (shen/cons\?
         (nthcdr 1
                 (shen/hd
                  (shen/hd V14774))))
        (shen/and
         (shen/predicate->shen
          (null
           (nthcdr 2
                   (shen/hd
                    (shen/hd V14774)))))
         (shen/and
          (shen/=
           (shen/hd
            (nthcdr 1
                    (shen/hd
                     (shen/hd V14774))))
           V14773)
          (shen/=
           (shen/hd
            (shen/hd
             (shen/hd V14774)))
           V14772)))))))
    (nthcdr 1 V14774))
   ((shen/cons\? V14774)
    (append
     (list
      (shen/hd V14774))
     (shen/shen\.remove-pointer V14772 V14773
                                (nthcdr 1 V14774))))
   (shen/true
    (shen/shen\.f_error 'shen\.remove-pointer))))
(defun shen/shen\.change-pointer-value
    (V14783 V14784 V14785 V14786)
  (shen/cond
   ((shen/predicate->shen
     (null V14786))
    (list
     (append
      (list
       (list V14783 V14784))
      V14785)))
   ((shen/and
     (shen/cons\? V14786)
     (shen/and
      (shen/cons\?
       (shen/hd V14786))
      (shen/and
       (shen/cons\?
        (shen/hd
         (shen/hd V14786)))
       (shen/and
        (shen/cons\?
         (nthcdr 1
                 (shen/hd
                  (shen/hd V14786))))
        (shen/and
         (shen/predicate->shen
          (null
           (nthcdr 2
                   (shen/hd
                    (shen/hd V14786)))))
         (shen/and
          (shen/=
           (shen/hd
            (nthcdr 1
                    (shen/hd
                     (shen/hd V14786))))
           V14784)
          (shen/=
           (shen/hd
            (shen/hd
             (shen/hd V14786)))
           V14783)))))))
    (append
     (list
      (append
       (list
        (shen/hd
         (shen/hd V14786)))
       V14785))
     (nthcdr 1 V14786)))
   ((shen/cons\? V14786)
    (append
     (list
      (shen/hd V14786))
     (shen/shen\.change-pointer-value V14783 V14784 V14785
                                      (nthcdr 1 V14786))))
   (shen/true
    (shen/shen\.f_error 'shen\.change-pointer-value))))
(defun shen/get
    (Pointer Key Table)
  (let
      ((Subtable
        (gethash Pointer Table)))
    (if
        (not Subtable)
        (shen/simple-error
         (format "pointer not found: %s\n" Pointer))
      (let
          ((Value
            (gethash Key Subtable)))
        (if
            (not Value)
            (shen/simple-error
             (format "value not found: %s\n"
                     (list Pointer Key))))
        Value))))
(defun shen/hash
    (V14795 V14796)
  (shen/let Hash
            (shen/shen\.mod
             (shen/sum
              (shen/map
               (shen/lambda X
                            (shen/string->n X))
               (shen/explode V14795)))
             V14796)
            (shen/if
             (shen/= 0 Hash)
             1 Hash)))
(defun shen/shen\.mod
    (N Div)
  (mod N Div))
(defun shen/shen\.multiples
    (V14803 V14804)
  (cl-flet
      ((tail-trampoline
        (V14803 V14804)
        (shen/cond
         ((shen/and
           (shen/cons\? V14804)
           (shen/>
            (shen/hd V14804)
            V14803))
          (nthcdr 1 V14804))
         ((shen/cons\? V14804)
          (vector
           (list V14803
                 (append
                  (list
                   (shen/* 2
                           (shen/hd V14804)))
                  V14804))))
         (shen/true
          (shen/shen\.f_error 'shen\.multiples)))))
    (let
        ((result
          (funcall #'tail-trampoline V14803 V14804)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.modh
    (V14809 V14810)
  (cl-flet
      ((tail-trampoline
        (V14809 V14810)
        (shen/cond
         ((shen/= 0 V14809)
          0)
         ((shen/predicate->shen
           (null V14810))
          V14809)
         ((shen/and
           (shen/cons\? V14810)
           (shen/>
            (shen/hd V14810)
            V14809))
          (shen/if
           (shen/empty\?
            (nthcdr 1 V14810))
           V14809
           (vector
            (list V14809
                  (nthcdr 1 V14810)))))
         ((shen/cons\? V14810)
          (vector
           (list
            (shen/- V14809
                    (shen/hd V14810))
            V14810)))
         (shen/true
          (shen/shen\.f_error 'shen\.modh)))))
    (let
        ((result
          (funcall #'tail-trampoline V14809 V14810)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/sum
    (V14812)
  (shen/cond
   ((shen/predicate->shen
     (null V14812))
    0)
   ((shen/cons\? V14812)
    (shen/+
     (shen/hd V14812)
     (shen/sum
      (nthcdr 1 V14812))))
   (shen/true
    (shen/shen\.f_error 'sum))))
(defun shen/head
    (V14820)
  (shen/cond
   ((shen/cons\? V14820)
    (shen/hd V14820))
   (shen/true
    (shen/simple-error "head expects a non-empty list"))))
(defun shen/tail
    (V14828)
  (shen/cond
   ((shen/cons\? V14828)
    (nthcdr 1 V14828))
   (shen/true
    (shen/simple-error "tail expects a non-empty list"))))
(defun shen/hdstr
    (V14830)
  (shen/pos V14830 0))
(defun shen/intersection
    (V14835 V14836)
  (cl-flet
      ((tail-trampoline
        (V14835 V14836)
        (shen/cond
         ((shen/predicate->shen
           (null V14835))
          nil)
         ((shen/cons\? V14835)
          (shen/if
           (shen/element\?
            (shen/hd V14835)
            V14836)
           (append
            (list
             (shen/hd V14835))
            (shen/intersection
             (nthcdr 1 V14835)
             V14836))
           (vector
            (list
             (nthcdr 1 V14835)
             V14836))))
         (shen/true
          (shen/shen\.f_error 'intersection)))))
    (let
        ((result
          (funcall #'tail-trampoline V14835 V14836)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/reverse
    (V14838)
  (shen/shen\.reverse_help V14838 nil))
(defun shen/shen\.reverse_help
    (V14841 V14842)
  (cl-flet
      ((tail-trampoline
        (V14841 V14842)
        (shen/cond
         ((shen/predicate->shen
           (null V14841))
          V14842)
         ((shen/cons\? V14841)
          (vector
           (list
            (nthcdr 1 V14841)
            (append
             (list
              (shen/hd V14841))
             V14842))))
         (shen/true
          (shen/shen\.f_error 'shen\.reverse_help)))))
    (let
        ((result
          (funcall #'tail-trampoline V14841 V14842)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/union
    (V14845 V14846)
  (cl-flet
      ((tail-trampoline
        (V14845 V14846)
        (shen/cond
         ((shen/predicate->shen
           (null V14845))
          V14846)
         ((shen/cons\? V14845)
          (shen/if
           (shen/element\?
            (shen/hd V14845)
            V14846)
           (vector
            (list
             (nthcdr 1 V14845)
             V14846))
           (append
            (list
             (shen/hd V14845))
            (shen/union
             (nthcdr 1 V14845)
             V14846))))
         (shen/true
          (shen/shen\.f_error 'union)))))
    (let
        ((result
          (funcall #'tail-trampoline V14845 V14846)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/y-or-n\?
    (V14848)
  (cl-flet
      ((tail-trampoline
        (V14848)
        (shen/let Message
                  (shen/shen\.prhush
                   (shen/shen\.proc-nl V14848)
                   (shen/stoutput))
                  (shen/let Y-or-N
                            (shen/shen\.prhush " (y/n) "
                                               (shen/stoutput))
                            (shen/let Input
                                      (shen/shen\.app
                                       (shen/read
                                        (shen/stinput))
                                       "" 'shen\.s)
                                      (shen/if
                                       (shen/= "y" Input)
                                       'true
                                       (shen/if
                                        (shen/= "n" Input)
                                        'false
                                        (shen/do
                                         (shen/shen\.prhush "please answer y or n\n"
                                                            (shen/stoutput))
                                         (vector
                                          (list V14848))))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14848)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/not
    (V14850)
  (shen/if V14850 'false 'true))
(defun shen/subst
    (V14863 V14864 V14865)
  (shen/cond
   ((shen/= V14865 V14864)
    V14863)
   ((shen/cons\? V14865)
    (shen/map
     (shen/lambda W
                  (shen/subst V14863 V14864 W))
     V14865))
   (shen/true V14865)))
(defun shen/explode
    (V14867)
  (shen/shen\.explode-h
   (shen/shen\.app V14867 "" 'shen\.a)))
(defun shen/shen\.explode-h
    (V14869)
  (shen/cond
   ((shen/= "" V14869)
    nil)
   ((shen/shen\.+string\? V14869)
    (append
     (list
      (shen/pos V14869 0))
     (shen/shen\.explode-h
      (shen/tlstr V14869))))
   (shen/true
    (shen/shen\.f_error 'shen\.explode-h))))
(defun shen/cd
    (V14871)
  (shen/set '*home-directory*
            (shen/if
             (shen/= V14871 "")
             ""
             (shen/shen\.app V14871 "/" 'shen\.a))))
(defun shen/map
    (F Xs)
  (mapcar
   (lambda
     (X)
     (shen/internal/apply-higher-order-function F
                                                (list X)))
   Xs))
(defun shen/shen\.map-h
    (V14881 V14882 V14883)
  (cl-flet
      ((tail-trampoline
        (V14881 V14882 V14883)
        (shen/cond
         ((shen/predicate->shen
           (null V14882))
          (shen/reverse V14883))
         ((shen/cons\? V14882)
          (vector
           (list V14881
                 (nthcdr 1 V14882)
                 (append
                  (list
                   (shen/internal/apply-higher-order-function V14881
                                                              (list
                                                               (shen/hd V14882))))
                  V14883))))
         (shen/true
          (shen/shen\.f_error 'shen\.map-h)))))
    (let
        ((result
          (funcall #'tail-trampoline V14881 V14882 V14883)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/length
    (V14885)
  (shen/shen\.length-h V14885 0))
(defun shen/shen\.length-h
    (V14888 V14889)
  (cl-flet
      ((tail-trampoline
        (V14888 V14889)
        (shen/cond
         ((shen/predicate->shen
           (null V14888))
          V14889)
         (shen/true
          (vector
           (list
            (nthcdr 1 V14888)
            (1+ V14889)))))))
    (let
        ((result
          (funcall #'tail-trampoline V14888 V14889)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/occurrences
    (V14901 V14902)
  (shen/cond
   ((shen/= V14902 V14901)
    1)
   ((shen/cons\? V14902)
    (shen/+
     (shen/occurrences V14901
                       (shen/hd V14902))
     (shen/occurrences V14901
                       (nthcdr 1 V14902))))
   (shen/true 0)))
(defun shen/nth
    (I Xs)
  (nth I Xs))
(defun shen/integer\?
    (N)
  (integerp N))
(defun shen/shen\.abs
    (V14916)
  (shen/if
   (shen/> V14916 0)
   V14916
   (shen/- 0 V14916)))
(defun shen/shen\.magless
    (V14919 V14920)
  (cl-flet
      ((tail-trampoline
        (V14919 V14920)
        (shen/let Nx2
                  (shen/* V14920 2)
                  (shen/if
                   (shen/> Nx2 V14919)
                   V14920
                   (vector
                    (list V14919 Nx2))))))
    (let
        ((result
          (funcall #'tail-trampoline V14919 V14920)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.integer-test\?
    (V14926 V14927)
  (cl-flet
      ((tail-trampoline
        (V14926 V14927)
        (shen/cond
         ((shen/= 0 V14926)
          'true)
         ((shen/> 1 V14926)
          'false)
         (shen/true
          (shen/let Abs-N
                    (shen/- V14926 V14927)
                    (shen/if
                     (shen/> 0 Abs-N)
                     (shen/integer\? V14926)
                     (vector
                      (list Abs-N V14927))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14926 V14927)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/mapcan
    (V14932 V14933)
  (shen/cond
   ((shen/predicate->shen
     (null V14933))
    nil)
   ((shen/cons\? V14933)
    (shen/append
     (shen/internal/apply-higher-order-function V14932
                                                (list
                                                 (shen/hd V14933)))
     (shen/mapcan V14932
                  (nthcdr 1 V14933))))
   (shen/true
    (shen/shen\.f_error 'mapcan))))
(defun shen/==
    (V14945 V14946)
  (shen/cond
   ((shen/= V14946 V14945)
    'true)
   (shen/true 'false)))
(defun shen/abort nil
  (shen/simple-error ""))
(defun shen/bound\?
    (V14948)
  (shen/and
   (shen/symbol\? V14948)
   (shen/let Val
             (shen/trap-error
              (shen/value V14948)
              (shen/lambda E 'shen\.this-symbol-is-unbound))
             (shen/if
              (shen/= Val 'shen\.this-symbol-is-unbound)
              'false 'true))))
(defun shen/shen\.string->bytes
    (S)
  (string-to-list S))
(defun shen/maxinferences
    (V14952)
  (shen/set 'shen\.*maxinferences* V14952))
(defun shen/inferences nil
  (shen/value 'shen\.*infs*))
(defun shen/protect
    (V14954)
  V14954)
(defun shen/stoutput nil
  (shen/value '*stoutput*))
(defun shen/string->symbol
    (V14956)
  (shen/let Symbol
            (shen/intern V14956)
            (shen/if
             (shen/symbol\? Symbol)
             Symbol
             (shen/simple-error
              (shen/cn "cannot intern "
                       (shen/shen\.app V14956 " to a symbol" 'shen\.s))))))
(defun shen/optimise
    (V14962)
  (shen/cond
   ((shen/= '+ V14962)
    (shen/set 'shen\.*optimise* 'true))
   ((shen/= '- V14962)
    (shen/set 'shen\.*optimise* 'false))
   (shen/true
    (shen/simple-error "optimise expects a + or a -.\n"))))
(defun shen/os nil
  (shen/value '*os*))
(defun shen/language nil
  (shen/value '*language*))
(defun shen/version nil
  (shen/value '*version*))
(defun shen/port nil
  (shen/value '*port*))
(defun shen/porters nil
  (shen/value '*porters*))
(defun shen/implementation nil
  (shen/value '*implementation*))
(defun shen/release nil
  (shen/value '*release*))
(defun shen/package\?
    (V14964)
  (shen/trap-error
   (shen/do
    (shen/external V14964)
    'true)
   (shen/lambda E 'false)))
(defun shen/function
    (S)
  (shen/shen\.lookup-func
   (shen/internal/unprefix-symbol S)
   (shen/value 'shen\.*symbol-table*)))
(defun shen/shen\.lookup-func
    (V14976 V14977)
  (cl-flet
      ((tail-trampoline
        (V14976 V14977)
        (shen/cond
         ((shen/predicate->shen
           (null V14977))
          (shen/simple-error
           (shen/shen\.app V14976 " has no lambda expansion\n" 'shen\.a)))
         ((shen/and
           (shen/cons\? V14977)
           (shen/and
            (shen/cons\?
             (shen/hd V14977))
            (shen/=
             (shen/hd
              (shen/hd V14977))
             V14976)))
          (nthcdr 1
                  (shen/hd V14977)))
         ((shen/cons\? V14977)
          (vector
           (list V14976
                 (nthcdr 1 V14977))))
         (shen/true
          (shen/shen\.f_error 'shen\.lookup-func)))))
    (let
        ((result
          (funcall #'tail-trampoline V14976 V14977)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.datatype-error
    (V14350)
  (shen/cond
   ((shen/and
     (shen/cons\? V14350)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14350))
      (shen/predicate->shen
       (null
        (nthcdr 2 V14350)))))
    (shen/simple-error
     (shen/cn "datatype syntax error here:\n\n "
              (shen/shen\.app
               (shen/shen\.next-50 50
                                   (shen/hd V14350))
               "\n" 'shen\.a))))
   (shen/true
    (shen/shen\.f_error 'shen\.datatype-error))))
(defun shen/shen\.<datatype-rules>
    (V14352)
  (shen/let YaccParse
            (shen/let Parse_shen\.<datatype-rule>
                      (shen/shen\.<datatype-rule> V14352)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<datatype-rule>))
                       (shen/let Parse_shen\.<datatype-rules>
                                 (shen/shen\.<datatype-rules> Parse_shen\.<datatype-rule>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<datatype-rules>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<datatype-rules>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<datatype-rule>))
                                    (shen/shen\.hdtl Parse_shen\.<datatype-rules>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14352)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<datatype-rule>
    (V14354)
  (shen/let YaccParse
            (shen/let Parse_shen\.<side-conditions>
                      (shen/shen\.<side-conditions> V14354)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<side-conditions>))
                       (shen/let Parse_shen\.<premises>
                                 (shen/shen\.<premises> Parse_shen\.<side-conditions>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<premises>))
                                  (shen/let Parse_shen\.<singleunderline>
                                            (shen/shen\.<singleunderline> Parse_shen\.<premises>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<singleunderline>))
                                             (shen/let Parse_shen\.<conclusion>
                                                       (shen/shen\.<conclusion> Parse_shen\.<singleunderline>)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<conclusion>))
                                                        (shen/shen\.pair
                                                         (shen/hd Parse_shen\.<conclusion>)
                                                         (shen/shen\.sequent 'shen\.single
                                                                             (list
                                                                              (shen/shen\.hdtl Parse_shen\.<side-conditions>)
                                                                              (shen/shen\.hdtl Parse_shen\.<premises>)
                                                                              (shen/shen\.hdtl Parse_shen\.<conclusion>))))
                                                        (shen/fail)))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<side-conditions>
                       (shen/shen\.<side-conditions> V14354)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<side-conditions>))
                        (shen/let Parse_shen\.<premises>
                                  (shen/shen\.<premises> Parse_shen\.<side-conditions>)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<premises>))
                                   (shen/let Parse_shen\.<doubleunderline>
                                             (shen/shen\.<doubleunderline> Parse_shen\.<premises>)
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<doubleunderline>))
                                              (shen/let Parse_shen\.<conclusion>
                                                        (shen/shen\.<conclusion> Parse_shen\.<doubleunderline>)
                                                        (shen/if
                                                         (shen/not
                                                          (shen/=
                                                           (shen/fail)
                                                           Parse_shen\.<conclusion>))
                                                         (shen/shen\.pair
                                                          (shen/hd Parse_shen\.<conclusion>)
                                                          (shen/shen\.sequent 'shen\.double
                                                                              (list
                                                                               (shen/shen\.hdtl Parse_shen\.<side-conditions>)
                                                                               (shen/shen\.hdtl Parse_shen\.<premises>)
                                                                               (shen/shen\.hdtl Parse_shen\.<conclusion>))))
                                                         (shen/fail)))
                                              (shen/fail)))
                                   (shen/fail)))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<side-conditions>
    (V14356)
  (shen/let YaccParse
            (shen/let Parse_shen\.<side-condition>
                      (shen/shen\.<side-condition> V14356)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<side-condition>))
                       (shen/let Parse_shen\.<side-conditions>
                                 (shen/shen\.<side-conditions> Parse_shen\.<side-condition>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<side-conditions>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<side-conditions>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<side-condition>))
                                    (shen/shen\.hdtl Parse_shen\.<side-conditions>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14356)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<side-condition>
    (V14358)
  (shen/let YaccParse
            (shen/if
             (shen/and
              (shen/cons\?
               (shen/hd V14358))
              (shen/= 'if
                      (shen/hd
                       (shen/hd V14358))))
             (shen/let Parse_shen\.<expr>
                       (shen/shen\.<expr>
                        (shen/shen\.pair
                         (nthcdr 1
                                 (shen/hd V14358))
                         (shen/shen\.hdtl V14358)))
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<expr>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<expr>)
                         (list 'if
                               (shen/shen\.hdtl Parse_shen\.<expr>)))
                        (shen/fail)))
             (shen/fail))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/if
              (shen/and
               (shen/cons\?
                (shen/hd V14358))
               (shen/= 'let
                       (shen/hd
                        (shen/hd V14358))))
              (shen/let Parse_shen\.<variable\?>
                        (shen/shen\.<variable\?>
                         (shen/shen\.pair
                          (nthcdr 1
                                  (shen/hd V14358))
                          (shen/shen\.hdtl V14358)))
                        (shen/if
                         (shen/not
                          (shen/=
                           (shen/fail)
                           Parse_shen\.<variable\?>))
                         (shen/let Parse_shen\.<expr>
                                   (shen/shen\.<expr> Parse_shen\.<variable\?>)
                                   (shen/if
                                    (shen/not
                                     (shen/=
                                      (shen/fail)
                                      Parse_shen\.<expr>))
                                    (shen/shen\.pair
                                     (shen/hd Parse_shen\.<expr>)
                                     (list 'let
                                           (shen/shen\.hdtl Parse_shen\.<variable\?>)
                                           (shen/shen\.hdtl Parse_shen\.<expr>)))
                                    (shen/fail)))
                         (shen/fail)))
              (shen/fail))
             YaccParse)))
(defun shen/shen\.<variable\?>
    (V14360)
  (shen/if
   (shen/cons\?
    (shen/hd V14360))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14360))
             (shen/if
              (shen/variable\? Parse_X)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14360))
                 (shen/shen\.hdtl V14360)))
               Parse_X)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<expr>
    (V14362)
  (shen/if
   (shen/cons\?
    (shen/hd V14362))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14362))
             (shen/if
              (shen/not
               (shen/or
                (shen/element\? Parse_X
                                (list '>> '\;))
                (shen/or
                 (shen/shen\.singleunderline\? Parse_X)
                 (shen/shen\.doubleunderline\? Parse_X))))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14362))
                 (shen/shen\.hdtl V14362)))
               (shen/shen\.remove-bar Parse_X))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.remove-bar
    (V14364)
  (shen/cond
   ((shen/and
     (shen/cons\? V14364)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14364))
      (shen/and
       (shen/cons\?
        (nthcdr 2 V14364))
       (shen/and
        (shen/predicate->shen
         (null
          (nthcdr 3 V14364)))
        (shen/=
         (shen/hd
          (nthcdr 1 V14364))
         'bar!)))))
    (append
     (list
      (shen/hd V14364))
     (shen/hd
      (nthcdr 2 V14364))))
   ((shen/cons\? V14364)
    (append
     (list
      (shen/shen\.remove-bar
       (shen/hd V14364)))
     (shen/shen\.remove-bar
      (nthcdr 1 V14364))))
   (shen/true V14364)))
(defun shen/shen\.<premises>
    (V14366)
  (shen/let YaccParse
            (shen/let Parse_shen\.<premise>
                      (shen/shen\.<premise> V14366)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<premise>))
                       (shen/let Parse_shen\.<semicolon-symbol>
                                 (shen/shen\.<semicolon-symbol> Parse_shen\.<premise>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<semicolon-symbol>))
                                  (shen/let Parse_shen\.<premises>
                                            (shen/shen\.<premises> Parse_shen\.<semicolon-symbol>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<premises>))
                                             (shen/shen\.pair
                                              (shen/hd Parse_shen\.<premises>)
                                              (append
                                               (list
                                                (shen/shen\.hdtl Parse_shen\.<premise>))
                                               (shen/shen\.hdtl Parse_shen\.<premises>)))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14366)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<semicolon-symbol>
    (V14368)
  (shen/if
   (shen/cons\?
    (shen/hd V14368))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14368))
             (shen/if
              (shen/= Parse_X '\;)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14368))
                 (shen/shen\.hdtl V14368)))
               'shen\.skip)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<premise>
    (V14370)
  (shen/let YaccParse
            (shen/if
             (shen/and
              (shen/cons\?
               (shen/hd V14370))
              (shen/= '!
                      (shen/hd
                       (shen/hd V14370))))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V14370))
                (shen/shen\.hdtl V14370)))
              '!)
             (shen/fail))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<formulae>
                                 (shen/shen\.<formulae> V14370)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<formulae>))
                                  (shen/if
                                   (shen/and
                                    (shen/cons\?
                                     (shen/hd Parse_shen\.<formulae>))
                                    (shen/= '>>
                                            (shen/hd
                                             (shen/hd Parse_shen\.<formulae>))))
                                   (shen/let Parse_shen\.<formula>
                                             (shen/shen\.<formula>
                                              (shen/shen\.pair
                                               (nthcdr 1
                                                       (shen/hd Parse_shen\.<formulae>))
                                               (shen/shen\.hdtl Parse_shen\.<formulae>)))
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<formula>))
                                              (shen/shen\.pair
                                               (shen/hd Parse_shen\.<formula>)
                                               (shen/shen\.sequent
                                                (shen/shen\.hdtl Parse_shen\.<formulae>)
                                                (shen/shen\.hdtl Parse_shen\.<formula>)))
                                              (shen/fail)))
                                   (shen/fail))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let Parse_shen\.<formula>
                                  (shen/shen\.<formula> V14370)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<formula>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<formula>)
                                    (shen/shen\.sequent nil
                                                        (shen/shen\.hdtl Parse_shen\.<formula>)))
                                   (shen/fail)))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.<conclusion>
    (V14372)
  (shen/let YaccParse
            (shen/let Parse_shen\.<formulae>
                      (shen/shen\.<formulae> V14372)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<formulae>))
                       (shen/if
                        (shen/and
                         (shen/cons\?
                          (shen/hd Parse_shen\.<formulae>))
                         (shen/= '>>
                                 (shen/hd
                                  (shen/hd Parse_shen\.<formulae>))))
                        (shen/let Parse_shen\.<formula>
                                  (shen/shen\.<formula>
                                   (shen/shen\.pair
                                    (nthcdr 1
                                            (shen/hd Parse_shen\.<formulae>))
                                    (shen/shen\.hdtl Parse_shen\.<formulae>)))
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<formula>))
                                   (shen/let Parse_shen\.<semicolon-symbol>
                                             (shen/shen\.<semicolon-symbol> Parse_shen\.<formula>)
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<semicolon-symbol>))
                                              (shen/shen\.pair
                                               (shen/hd Parse_shen\.<semicolon-symbol>)
                                               (shen/shen\.sequent
                                                (shen/shen\.hdtl Parse_shen\.<formulae>)
                                                (shen/shen\.hdtl Parse_shen\.<formula>)))
                                              (shen/fail)))
                                   (shen/fail)))
                        (shen/fail))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<formula>
                       (shen/shen\.<formula> V14372)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<formula>))
                        (shen/let Parse_shen\.<semicolon-symbol>
                                  (shen/shen\.<semicolon-symbol> Parse_shen\.<formula>)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<semicolon-symbol>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<semicolon-symbol>)
                                    (shen/shen\.sequent nil
                                                        (shen/shen\.hdtl Parse_shen\.<formula>)))
                                   (shen/fail)))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.sequent
    (V14375 V14376)
  (shen/@p V14375 V14376))
(defun shen/shen\.<formulae>
    (V14378)
  (shen/let YaccParse
            (shen/let Parse_shen\.<formula>
                      (shen/shen\.<formula> V14378)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<formula>))
                       (shen/let Parse_shen\.<comma-symbol>
                                 (shen/shen\.<comma-symbol> Parse_shen\.<formula>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<comma-symbol>))
                                  (shen/let Parse_shen\.<formulae>
                                            (shen/shen\.<formulae> Parse_shen\.<comma-symbol>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<formulae>))
                                             (shen/shen\.pair
                                              (shen/hd Parse_shen\.<formulae>)
                                              (append
                                               (list
                                                (shen/shen\.hdtl Parse_shen\.<formula>))
                                               (shen/shen\.hdtl Parse_shen\.<formulae>)))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<formula>
                                 (shen/shen\.<formula> V14378)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<formula>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<formula>)
                                   (list
                                    (shen/shen\.hdtl Parse_shen\.<formula>)))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let Parse_<e>
                                  (shen/<e> V14378)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_<e>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_<e>)
                                    nil)
                                   (shen/fail)))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.<comma-symbol>
    (V14380)
  (shen/if
   (shen/cons\?
    (shen/hd V14380))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14380))
             (shen/if
              (shen/= Parse_X
                      (shen/intern ","))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14380))
                 (shen/shen\.hdtl V14380)))
               'shen\.skip)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<formula>
    (V14382)
  (shen/let YaccParse
            (shen/let Parse_shen\.<expr>
                      (shen/shen\.<expr> V14382)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<expr>))
                       (shen/if
                        (shen/and
                         (shen/cons\?
                          (shen/hd Parse_shen\.<expr>))
                         (shen/= ':
                                 (shen/hd
                                  (shen/hd Parse_shen\.<expr>))))
                        (shen/let Parse_shen\.<type>
                                  (shen/shen\.<type>
                                   (shen/shen\.pair
                                    (nthcdr 1
                                            (shen/hd Parse_shen\.<expr>))
                                    (shen/shen\.hdtl Parse_shen\.<expr>)))
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<type>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<type>)
                                    (list
                                     (shen/shen\.curry
                                      (shen/shen\.hdtl Parse_shen\.<expr>))
                                     ':
                                     (shen/shen\.demodulate
                                      (shen/shen\.hdtl Parse_shen\.<type>))))
                                   (shen/fail)))
                        (shen/fail))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<expr>
                       (shen/shen\.<expr> V14382)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<expr>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<expr>)
                         (shen/shen\.hdtl Parse_shen\.<expr>))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<type>
    (V14384)
  (shen/let Parse_shen\.<expr>
            (shen/shen\.<expr> V14384)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<expr>))
             (shen/shen\.pair
              (shen/hd Parse_shen\.<expr>)
              (shen/shen\.curry-type
               (shen/shen\.hdtl Parse_shen\.<expr>)))
             (shen/fail))))
(defun shen/shen\.<doubleunderline>
    (V14386)
  (shen/if
   (shen/cons\?
    (shen/hd V14386))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14386))
             (shen/if
              (shen/shen\.doubleunderline\? Parse_X)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14386))
                 (shen/shen\.hdtl V14386)))
               Parse_X)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<singleunderline>
    (V14388)
  (shen/if
   (shen/cons\?
    (shen/hd V14388))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14388))
             (shen/if
              (shen/shen\.singleunderline\? Parse_X)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14388))
                 (shen/shen\.hdtl V14388)))
               Parse_X)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.singleunderline\?
    (V14390)
  (shen/and
   (shen/symbol\? V14390)
   (shen/shen\.sh\?
    (shen/str V14390))))
(defun shen/shen\.sh\?
    (V14392)
  (shen/cond
   ((shen/= "_" V14392)
    'true)
   (shen/true
    (shen/and
     (shen/=
      (shen/pos V14392 0)
      "_")
     (shen/shen\.sh\?
      (shen/tlstr V14392))))))
(defun shen/shen\.doubleunderline\?
    (V14394)
  (shen/and
   (shen/symbol\? V14394)
   (shen/shen\.dh\?
    (shen/str V14394))))
(defun shen/shen\.dh\?
    (V14396)
  (shen/cond
   ((shen/= "=" V14396)
    'true)
   (shen/true
    (shen/and
     (shen/=
      (shen/pos V14396 0)
      "=")
     (shen/shen\.dh\?
      (shen/tlstr V14396))))))
(defun shen/shen\.process-datatype
    (V14399 V14400)
  (shen/shen\.remember-datatype
   (shen/shen\.s-prolog
    (shen/shen\.rules->horn-clauses V14399 V14400))))
(defun shen/shen\.remember-datatype
    (V14406)
  (shen/cond
   ((shen/cons\? V14406)
    (shen/do
     (shen/set 'shen\.*datatypes*
               (shen/adjoin
                (shen/hd V14406)
                (shen/value 'shen\.*datatypes*)))
     (shen/do
      (shen/set 'shen\.*alldatatypes*
                (shen/adjoin
                 (shen/hd V14406)
                 (shen/value 'shen\.*alldatatypes*)))
      (shen/hd V14406))))
   (shen/true
    (shen/shen\.f_error 'shen\.remember-datatype))))
(defun shen/shen\.rules->horn-clauses
    (V14411 V14412)
  (cl-flet
      ((tail-trampoline
        (V14411 V14412)
        (shen/cond
         ((shen/predicate->shen
           (null V14412))
          nil)
         ((shen/and
           (shen/cons\? V14412)
           (shen/and
            (shen/tuple\?
             (shen/hd V14412))
            (shen/= 'shen\.single
                    (shen/fst
                     (shen/hd V14412)))))
          (append
           (list
            (shen/shen\.rule->horn-clause V14411
                                          (shen/snd
                                           (shen/hd V14412))))
           (shen/shen\.rules->horn-clauses V14411
                                           (nthcdr 1 V14412))))
         ((shen/and
           (shen/cons\? V14412)
           (shen/and
            (shen/tuple\?
             (shen/hd V14412))
            (shen/= 'shen\.double
                    (shen/fst
                     (shen/hd V14412)))))
          (vector
           (list V14411
                 (shen/append
                  (shen/shen\.double->singles
                   (shen/snd
                    (shen/hd V14412)))
                  (nthcdr 1 V14412)))))
         (shen/true
          (shen/shen\.f_error 'shen\.rules->horn-clauses)))))
    (let
        ((result
          (funcall #'tail-trampoline V14411 V14412)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.double->singles
    (V14414)
  (list
   (shen/shen\.right-rule V14414)
   (shen/shen\.left-rule V14414)))
(defun shen/shen\.right-rule
    (V14416)
  (shen/@p 'shen\.single V14416))
(defun shen/shen\.left-rule
    (V14418)
  (shen/cond
   ((shen/and
     (shen/cons\? V14418)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14418))
      (shen/and
       (shen/cons\?
        (nthcdr 2 V14418))
       (shen/and
        (shen/tuple\?
         (shen/hd
          (nthcdr 2 V14418)))
        (shen/and
         (shen/predicate->shen
          (null
           (shen/fst
            (shen/hd
             (nthcdr 2 V14418)))))
         (shen/predicate->shen
          (null
           (nthcdr 3 V14418))))))))
    (shen/let Q
              (shen/gensym 'Qv)
              (shen/let NewConclusion
                        (shen/@p
                         (list
                          (shen/snd
                           (shen/hd
                            (nthcdr 2 V14418))))
                         Q)
                        (shen/let NewPremises
                                  (list
                                   (shen/@p
                                    (shen/map
                                     (shen/lambda X
                                                  (shen/shen\.right->left X))
                                     (shen/hd
                                      (nthcdr 1 V14418)))
                                    Q))
                                  (shen/@p 'shen\.single
                                           (list
                                            (shen/hd V14418)
                                            NewPremises NewConclusion))))))
   (shen/true
    (shen/shen\.f_error 'shen\.left-rule))))
(defun shen/shen\.right->left
    (V14424)
  (shen/cond
   ((shen/and
     (shen/tuple\? V14424)
     (shen/predicate->shen
      (null
       (shen/fst V14424))))
    (shen/snd V14424))
   (shen/true
    (shen/simple-error "syntax error with ==========\n"))))
(defun shen/shen\.rule->horn-clause
    (V14427 V14428)
  (shen/cond
   ((shen/and
     (shen/cons\? V14428)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14428))
      (shen/and
       (shen/cons\?
        (nthcdr 2 V14428))
       (shen/and
        (shen/tuple\?
         (shen/hd
          (nthcdr 2 V14428)))
        (shen/predicate->shen
         (null
          (nthcdr 3 V14428)))))))
    (list
     (shen/shen\.rule->horn-clause-head V14427
                                        (shen/snd
                                         (shen/hd
                                          (nthcdr 2 V14428))))
     ':-
     (shen/shen\.rule->horn-clause-body
      (shen/hd V14428)
      (shen/hd
       (nthcdr 1 V14428))
      (shen/fst
       (shen/hd
        (nthcdr 2 V14428))))))
   (shen/true
    (shen/shen\.f_error 'shen\.rule->horn-clause))))
(defun shen/shen\.rule->horn-clause-head
    (V14431 V14432)
  (list V14431
        (shen/shen\.mode-ify V14432)
        'Context_1957))
(defun shen/shen\.mode-ify
    (V14434)
  (shen/cond
   ((shen/and
     (shen/cons\? V14434)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14434))
      (shen/and
       (shen/= ':
               (shen/hd
                (nthcdr 1 V14434)))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V14434))
        (shen/predicate->shen
         (null
          (nthcdr 3 V14434)))))))
    (list 'mode
          (list
           (shen/hd V14434)
           ':
           (list 'mode
                 (shen/hd
                  (nthcdr 2 V14434))
                 '+))
          '-))
   (shen/true V14434)))
(defun shen/shen\.rule->horn-clause-body
    (V14438 V14439 V14440)
  (shen/let Variables
            (shen/map
             (shen/lambda X
                          (shen/shen\.extract_vars X))
             V14440)
            (shen/let Predicates
                      (shen/map
                       (shen/lambda X
                                    (shen/gensym 'shen\.cl))
                       V14440)
                      (shen/let SearchLiterals
                                (shen/shen\.construct-search-literals Predicates Variables 'Context_1957 'Context1_1957)
                                (shen/let SearchClauses
                                          (shen/shen\.construct-search-clauses Predicates V14440 Variables)
                                          (shen/let SideLiterals
                                                    (shen/shen\.construct-side-literals V14438)
                                                    (shen/let PremissLiterals
                                                              (shen/map
                                                               (shen/lambda X
                                                                            (shen/shen\.construct-premiss-literal X
                                                                                                                  (shen/empty\? V14440)))
                                                               V14439)
                                                              (shen/append SearchLiterals
                                                                           (shen/append SideLiterals PremissLiterals)))))))))
(defun shen/shen\.construct-search-literals
    (V14449 V14450 V14451 V14452)
  (shen/cond
   ((shen/and
     (shen/predicate->shen
      (null V14449))
     (shen/predicate->shen
      (null V14450)))
    nil)
   (shen/true
    (shen/shen\.csl-help V14449 V14450 V14451 V14452))))
(defun shen/shen\.csl-help
    (V14459 V14460 V14461 V14462)
  (shen/cond
   ((shen/and
     (shen/predicate->shen
      (null V14459))
     (shen/predicate->shen
      (null V14460)))
    (list
     (list 'bind 'ContextOut_1957 V14461)))
   ((shen/and
     (shen/cons\? V14459)
     (shen/cons\? V14460))
    (append
     (list
      (append
       (list
        (shen/hd V14459)
        V14461 V14462)
       (shen/hd V14460)))
     (shen/shen\.csl-help
      (nthcdr 1 V14459)
      (nthcdr 1 V14460)
      V14462
      (shen/gensym 'Context))))
   (shen/true
    (shen/shen\.f_error 'shen\.csl-help))))
(defun shen/shen\.construct-search-clauses
    (V14466 V14467 V14468)
  (cl-flet
      ((tail-trampoline
        (V14466 V14467 V14468)
        (shen/cond
         ((shen/and
           (shen/predicate->shen
            (null V14466))
           (shen/and
            (shen/predicate->shen
             (null V14467))
            (shen/predicate->shen
             (null V14468))))
          'shen\.skip)
         ((shen/and
           (shen/cons\? V14466)
           (shen/and
            (shen/cons\? V14467)
            (shen/cons\? V14468)))
          (shen/do
           (shen/shen\.construct-search-clause
            (shen/hd V14466)
            (shen/hd V14467)
            (shen/hd V14468))
           (vector
            (list
             (nthcdr 1 V14466)
             (nthcdr 1 V14467)
             (nthcdr 1 V14468)))))
         (shen/true
          (shen/shen\.f_error 'shen\.construct-search-clauses)))))
    (let
        ((result
          (funcall #'tail-trampoline V14466 V14467 V14468)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.construct-search-clause
    (V14472 V14473 V14474)
  (shen/shen\.s-prolog
   (list
    (shen/shen\.construct-base-search-clause V14472 V14473 V14474)
    (shen/shen\.construct-recursive-search-clause V14472 V14473 V14474))))
(defun shen/shen\.construct-base-search-clause
    (V14478 V14479 V14480)
  (list
   (append
    (list V14478
          (append
           (list
            (shen/shen\.mode-ify V14479))
           'In_1957)
          'In_1957)
    V14480)
   ':- nil))
(defun shen/shen\.construct-recursive-search-clause
    (V14484 V14485 V14486)
  (list
   (append
    (list V14484
          (append
           (list 'Assumption_1957)
           'Assumptions_1957)
          (append
           (list 'Assumption_1957)
           'Out_1957))
    V14486)
   ':-
   (list
    (append
     (list V14484 'Assumptions_1957 'Out_1957)
     V14486))))
(defun shen/shen\.construct-side-literals
    (V14492)
  (cl-flet
      ((tail-trampoline
        (V14492)
        (shen/cond
         ((shen/predicate->shen
           (null V14492))
          nil)
         ((shen/and
           (shen/cons\? V14492)
           (shen/and
            (shen/cons\?
             (shen/hd V14492))
            (shen/and
             (shen/= 'if
                     (shen/hd
                      (shen/hd V14492)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V14492)))
              (shen/predicate->shen
               (null
                (nthcdr 2
                        (shen/hd V14492))))))))
          (append
           (list
            (append
             (list 'when)
             (nthcdr 1
                     (shen/hd V14492))))
           (shen/shen\.construct-side-literals
            (nthcdr 1 V14492))))
         ((shen/and
           (shen/cons\? V14492)
           (shen/and
            (shen/cons\?
             (shen/hd V14492))
            (shen/and
             (shen/= 'let
                     (shen/hd
                      (shen/hd V14492)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V14492)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V14492)))
               (shen/predicate->shen
                (null
                 (nthcdr 3
                         (shen/hd V14492)))))))))
          (append
           (list
            (append
             (list 'is)
             (nthcdr 1
                     (shen/hd V14492))))
           (shen/shen\.construct-side-literals
            (nthcdr 1 V14492))))
         ((shen/cons\? V14492)
          (vector
           (list
            (nthcdr 1 V14492))))
         (shen/true
          (shen/shen\.f_error 'shen\.construct-side-literals)))))
    (let
        ((result
          (funcall #'tail-trampoline V14492)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.construct-premiss-literal
    (V14499 V14500)
  (shen/cond
   ((shen/tuple\? V14499)
    (list 'shen\.t*
          (shen/shen\.recursive_cons_form
           (shen/snd V14499))
          (shen/shen\.construct-context V14500
                                        (shen/fst V14499))))
   ((shen/= '! V14499)
    (list 'cut 'Throwcontrol))
   (shen/true
    (shen/shen\.f_error 'shen\.construct-premiss-literal))))
(defun shen/shen\.construct-context
    (V14503 V14504)
  (shen/cond
   ((shen/and
     (shen/= 'true V14503)
     (shen/predicate->shen
      (null V14504)))
    'Context_1957)
   ((shen/and
     (shen/= 'false V14503)
     (shen/predicate->shen
      (null V14504)))
    'ContextOut_1957)
   ((shen/cons\? V14504)
    (list 'cons
          (shen/shen\.recursive_cons_form
           (shen/hd V14504))
          (shen/shen\.construct-context V14503
                                        (nthcdr 1 V14504))))
   (shen/true
    (shen/shen\.f_error 'shen\.construct-context))))
(defun shen/shen\.recursive_cons_form
    (V14506)
  (shen/cond
   ((shen/cons\? V14506)
    (list 'cons
          (shen/shen\.recursive_cons_form
           (shen/hd V14506))
          (shen/shen\.recursive_cons_form
           (nthcdr 1 V14506))))
   (shen/true V14506)))
(defun shen/preclude
    (V14508)
  (shen/shen\.preclude-h
   (shen/map
    (shen/lambda X
                 (shen/shen\.intern-type X))
    V14508)))
(defun shen/shen\.preclude-h
    (V14510)
  (shen/let FilterDatatypes
            (shen/set 'shen\.*datatypes*
                      (shen/difference
                       (shen/value 'shen\.*datatypes*)
                       V14510))
            (shen/value 'shen\.*datatypes*)))
(defun shen/include
    (V14512)
  (shen/shen\.include-h
   (shen/map
    (shen/lambda X
                 (shen/shen\.intern-type X))
    V14512)))
(defun shen/shen\.include-h
    (V14514)
  (shen/let ValidTypes
            (shen/intersection V14514
                               (shen/value 'shen\.*alldatatypes*))
            (shen/let NewDatatypes
                      (shen/set 'shen\.*datatypes*
                                (shen/union ValidTypes
                                            (shen/value 'shen\.*datatypes*)))
                      (shen/value 'shen\.*datatypes*))))
(defun shen/preclude-all-but
    (V14516)
  (shen/shen\.preclude-h
   (shen/difference
    (shen/value 'shen\.*alldatatypes*)
    (shen/map
     (shen/lambda X
                  (shen/shen\.intern-type X))
     V14516))))
(defun shen/include-all-but
    (V14518)
  (shen/shen\.include-h
   (shen/difference
    (shen/value 'shen\.*alldatatypes*)
    (shen/map
     (shen/lambda X
                  (shen/shen\.intern-type X))
     V14518))))
(defun shen/shen\.synonyms-help
    (V14524)
  (cl-flet
      ((tail-trampoline
        (V14524)
        (shen/cond
         ((shen/predicate->shen
           (null V14524))
          (shen/shen\.demodulation-function
           (shen/value 'shen\.*tc*)
           (shen/mapcan
            (shen/lambda X
                         (shen/shen\.demod-rule X))
            (shen/value 'shen\.*synonyms*))))
         ((shen/and
           (shen/cons\? V14524)
           (shen/cons\?
            (nthcdr 1 V14524)))
          (shen/let Vs
                    (shen/difference
                     (shen/shen\.extract_vars
                      (shen/hd
                       (nthcdr 1 V14524)))
                     (shen/shen\.extract_vars
                      (shen/hd V14524)))
                    (shen/if
                     (shen/empty\? Vs)
                     (shen/do
                      (shen/shen\.pushnew
                       (list
                        (shen/hd V14524)
                        (shen/hd
                         (nthcdr 1 V14524)))
                       'shen\.*synonyms*)
                      (vector
                       (list
                        (nthcdr 2 V14524))))
                     (shen/shen\.free_variable_warnings
                      (shen/hd
                       (nthcdr 1 V14524))
                      Vs))))
         (shen/true
          (shen/simple-error "odd number of synonyms\n")))))
    (let
        ((result
          (funcall #'tail-trampoline V14524)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.pushnew
    (V14527 V14528)
  (shen/if
   (shen/element\? V14527
                   (shen/value V14528))
   (shen/value V14528)
   (shen/set V14528
             (append
              (list V14527)
              (shen/value V14528)))))
(defun shen/shen\.demod-rule
    (V14530)
  (shen/cond
   ((shen/and
     (shen/cons\? V14530)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14530))
      (shen/predicate->shen
       (null
        (nthcdr 2 V14530)))))
    (list
     (shen/shen\.rcons_form
      (shen/hd V14530))
     '->
     (shen/shen\.rcons_form
      (shen/hd
       (nthcdr 1 V14530)))))
   (shen/true
    (shen/shen\.f_error 'shen\.demod-rule))))
(defun shen/shen\.demodulation-function
    (V14533 V14534)
  (shen/do
   (shen/tc '-)
   (shen/do
    (shen/eval
     (append
      (list 'define 'shen\.demod)
      (shen/append V14534
                   (shen/shen\.default-rule))))
    (shen/do
     (shen/if V14533
              (shen/tc '+)
              'shen\.skip)
     'synonyms))))
(defun shen/shen\.default-rule nil
  (list 'X '-> 'X))
(defun shen/shen\.yacc
    (V15926)
  (shen/cond
   ((shen/and
     (shen/cons\? V15926)
     (shen/and
      (shen/= 'defcc
              (shen/hd V15926))
      (shen/cons\?
       (nthcdr 1 V15926))))
    (shen/shen\.yacc->shen
     (shen/hd
      (nthcdr 1 V15926))
     (nthcdr 2 V15926)))
   (shen/true
    (shen/shen\.f_error 'shen\.yacc))))
(defun shen/shen\.yacc->shen
    (V15929 V15930)
  (shen/let CCRules
            (shen/shen\.split_cc_rules 'true V15930 nil)
            (shen/let CCBody
                      (shen/map
                       (shen/lambda X
                                    (shen/shen\.cc_body X))
                       CCRules)
                      (shen/let YaccCases
                                (shen/shen\.yacc_cases CCBody)
                                (list 'define V15929 'Stream '->
                                      (shen/shen\.kill-code YaccCases))))))
(defun shen/shen\.kill-code
    (V15932)
  (shen/cond
   ((shen/>
     (shen/occurrences 'kill V15932)
     0)
    (list 'trap-error V15932
          (list 'lambda 'E
                (list 'shen\.analyse-kill 'E))))
   (shen/true V15932)))
(defun shen/kill nil
  (shen/simple-error "yacc kill"))
(defun shen/shen\.analyse-kill
    (V15934)
  (shen/let String
            (shen/error-to-string V15934)
            (shen/if
             (shen/= String "yacc kill")
             (shen/fail)
             V15934)))
(defun shen/shen\.split_cc_rules
    (V15940 V15941 V15942)
  (cl-flet
      ((tail-trampoline
        (V15940 V15941 V15942)
        (shen/cond
         ((shen/and
           (shen/predicate->shen
            (null V15941))
           (shen/predicate->shen
            (null V15942)))
          nil)
         ((shen/predicate->shen
           (null V15941))
          (list
           (shen/shen\.split_cc_rule V15940
                                     (shen/reverse V15942)
                                     nil)))
         ((shen/and
           (shen/cons\? V15941)
           (shen/= '\;
                   (shen/hd V15941)))
          (append
           (list
            (shen/shen\.split_cc_rule V15940
                                      (shen/reverse V15942)
                                      nil))
           (shen/shen\.split_cc_rules V15940
                                      (nthcdr 1 V15941)
                                      nil)))
         ((shen/cons\? V15941)
          (vector
           (list V15940
                 (nthcdr 1 V15941)
                 (append
                  (list
                   (shen/hd V15941))
                  V15942))))
         (shen/true
          (shen/shen\.f_error 'shen\.split_cc_rules)))))
    (let
        ((result
          (funcall #'tail-trampoline V15940 V15941 V15942)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.split_cc_rule
    (V15950 V15951 V15952)
  (cl-flet
      ((tail-trampoline
        (V15950 V15951 V15952)
        (shen/cond
         ((shen/and
           (shen/cons\? V15951)
           (shen/and
            (shen/= ':=
                    (shen/hd V15951))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V15951))
             (shen/predicate->shen
              (null
               (nthcdr 2 V15951))))))
          (append
           (list
            (shen/reverse V15952))
           (nthcdr 1 V15951)))
         ((shen/and
           (shen/cons\? V15951)
           (shen/and
            (shen/= ':=
                    (shen/hd V15951))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V15951))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V15951))
              (shen/and
               (shen/= 'where
                       (shen/hd
                        (nthcdr 2 V15951)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V15951))
                (shen/predicate->shen
                 (null
                  (nthcdr 4 V15951)))))))))
          (list
           (shen/reverse V15952)
           (list 'where
                 (shen/hd
                  (nthcdr 3 V15951))
                 (shen/hd
                  (nthcdr 1 V15951)))))
         ((shen/predicate->shen
           (null V15951))
          (shen/do
           (shen/shen\.semantic-completion-warning V15950 V15952)
           (vector
            (list V15950
                  (list ':=
                        (shen/shen\.default_semantics
                         (shen/reverse V15952)))
                  V15952))))
         ((shen/cons\? V15951)
          (vector
           (list V15950
                 (nthcdr 1 V15951)
                 (append
                  (list
                   (shen/hd V15951))
                  V15952))))
         (shen/true
          (shen/shen\.f_error 'shen\.split_cc_rule)))))
    (let
        ((result
          (funcall #'tail-trampoline V15950 V15951 V15952)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.semantic-completion-warning
    (V15963 V15964)
  (shen/cond
   ((shen/= 'true V15963)
    (shen/do
     (shen/shen\.prhush "warning: "
                        (shen/stoutput))
     (shen/do
      (shen/map
       (shen/lambda X
                    (shen/shen\.prhush
                     (shen/shen\.app X " " 'shen\.a)
                     (shen/stoutput)))
       (shen/reverse V15964))
      (shen/shen\.prhush "has no semantics.\n"
                         (shen/stoutput)))))
   (shen/true 'shen\.skip)))
(defun shen/shen\.default_semantics
    (V15966)
  (shen/cond
   ((shen/predicate->shen
     (null V15966))
    nil)
   ((shen/and
     (shen/cons\? V15966)
     (shen/and
      (shen/predicate->shen
       (null
        (nthcdr 1 V15966)))
      (shen/shen\.grammar_symbol\?
       (shen/hd V15966))))
    (shen/hd V15966))
   ((shen/and
     (shen/cons\? V15966)
     (shen/shen\.grammar_symbol\?
      (shen/hd V15966)))
    (list 'append
          (shen/hd V15966)
          (shen/shen\.default_semantics
           (nthcdr 1 V15966))))
   ((shen/cons\? V15966)
    (list 'cons
          (shen/hd V15966)
          (shen/shen\.default_semantics
           (nthcdr 1 V15966))))
   (shen/true
    (shen/shen\.f_error 'shen\.default_semantics))))
(defun shen/shen\.grammar_symbol\?
    (V15968)
  (shen/and
   (shen/symbol\? V15968)
   (shen/let Cs
             (shen/shen\.strip-pathname
              (shen/explode V15968))
             (shen/and
              (shen/=
               (shen/hd Cs)
               "<")
              (shen/=
               (shen/hd
                (shen/reverse Cs))
               ">")))))
(defun shen/shen\.yacc_cases
    (V15970)
  (shen/cond
   ((shen/and
     (shen/cons\? V15970)
     (shen/predicate->shen
      (null
       (nthcdr 1 V15970))))
    (shen/hd V15970))
   ((shen/cons\? V15970)
    (shen/let P 'YaccParse
              (list 'let P
                    (shen/hd V15970)
                    (list 'if
                          (list '= P
                                (list 'fail))
                          (shen/shen\.yacc_cases
                           (nthcdr 1 V15970))
                          P))))
   (shen/true
    (shen/shen\.f_error 'shen\.yacc_cases))))
(defun shen/shen\.cc_body
    (V15972)
  (shen/cond
   ((shen/and
     (shen/cons\? V15972)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V15972))
      (shen/predicate->shen
       (null
        (nthcdr 2 V15972)))))
    (shen/shen\.syntax
     (shen/hd V15972)
     'Stream
     (shen/hd
      (nthcdr 1 V15972))))
   (shen/true
    (shen/shen\.f_error 'shen\.cc_body))))
(defun shen/shen\.syntax
    (V15976 V15977 V15978)
  (shen/cond
   ((shen/and
     (shen/predicate->shen
      (null V15976))
     (shen/and
      (shen/cons\? V15978)
      (shen/and
       (shen/= 'where
               (shen/hd V15978))
       (shen/and
        (shen/cons\?
         (nthcdr 1 V15978))
        (shen/and
         (shen/cons\?
          (nthcdr 2 V15978))
         (shen/predicate->shen
          (null
           (nthcdr 3 V15978))))))))
    (list 'if
          (shen/shen\.semantics
           (shen/hd
            (nthcdr 1 V15978)))
          (list 'shen\.pair
                (list 'hd V15977)
                (shen/shen\.semantics
                 (shen/hd
                  (nthcdr 2 V15978))))
          (list 'fail)))
   ((shen/predicate->shen
     (null V15976))
    (list 'shen\.pair
          (list 'hd V15977)
          (shen/shen\.semantics V15978)))
   ((shen/cons\? V15976)
    (shen/if
     (shen/shen\.grammar_symbol\?
      (shen/hd V15976))
     (shen/shen\.recursive_descent V15976 V15977 V15978)
     (shen/if
      (shen/variable\?
       (shen/hd V15976))
      (shen/shen\.variable-match V15976 V15977 V15978)
      (shen/if
       (shen/shen\.jump_stream\?
        (shen/hd V15976))
       (shen/shen\.jump_stream V15976 V15977 V15978)
       (shen/if
        (shen/shen\.terminal\?
         (shen/hd V15976))
        (shen/shen\.check_stream V15976 V15977 V15978)
        (shen/if
         (shen/cons\?
          (shen/hd V15976))
         (shen/shen\.list-stream
          (shen/shen\.decons
           (shen/hd V15976))
          (nthcdr 1 V15976)
          V15977 V15978)
         (shen/simple-error
          (shen/shen\.app
           (shen/hd V15976)
           " is not legal syntax\n" 'shen\.a))))))))
   (shen/true
    (shen/shen\.f_error 'shen\.syntax))))
(defun shen/shen\.list-stream
    (V15983 V15984 V15985 V15986)
  (shen/let Test
            (list 'and
                  (list 'cons\?
                        (list 'hd V15985))
                  (list 'cons\?
                        (list 'hd
                              (list 'hd V15985))))
            (shen/let Placeholder
                      (shen/gensym 'shen\.place)
                      (shen/let RunOn
                                (shen/shen\.syntax V15984
                                                   (list 'shen\.pair
                                                         (list 'tl
                                                               (list 'hd V15985))
                                                         (list 'hd
                                                               (list 'tl V15985)))
                                                   V15986)
                                (shen/let Action
                                          (shen/shen\.insert-runon RunOn Placeholder
                                                                   (shen/shen\.syntax V15983
                                                                                      (list 'shen\.pair
                                                                                            (list 'hd
                                                                                                  (list 'hd V15985))
                                                                                            (list 'hd
                                                                                                  (list 'tl V15985)))
                                                                                      Placeholder))
                                          (list 'if Test Action
                                                (list 'fail)))))))
(defun shen/shen\.decons
    (V15988)
  (shen/cond
   ((shen/and
     (shen/cons\? V15988)
     (shen/and
      (shen/= 'cons
              (shen/hd V15988))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15988))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15988))
        (shen/and
         (shen/predicate->shen
          (null
           (shen/hd
            (nthcdr 2 V15988))))
         (shen/predicate->shen
          (null
           (nthcdr 3 V15988))))))))
    (list
     (shen/hd
      (nthcdr 1 V15988))))
   ((shen/and
     (shen/cons\? V15988)
     (shen/and
      (shen/= 'cons
              (shen/hd V15988))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15988))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15988))
        (shen/predicate->shen
         (null
          (nthcdr 3 V15988)))))))
    (append
     (list
      (shen/hd
       (nthcdr 1 V15988)))
     (shen/shen\.decons
      (shen/hd
       (nthcdr 2 V15988)))))
   (shen/true V15988)))
(defun shen/shen\.insert-runon
    (V16003 V16004 V16005)
  (shen/cond
   ((shen/and
     (shen/cons\? V16005)
     (shen/and
      (shen/= 'shen\.pair
              (shen/hd V16005))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V16005))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V16005))
        (shen/and
         (shen/predicate->shen
          (null
           (nthcdr 3 V16005)))
         (shen/=
          (shen/hd
           (nthcdr 2 V16005))
          V16004))))))
    V16003)
   ((shen/cons\? V16005)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.insert-runon V16003 V16004 Z))
     V16005))
   (shen/true V16005)))
(defun shen/shen\.strip-pathname
    (V16011)
  (cl-flet
      ((tail-trampoline
        (V16011)
        (shen/cond
         ((shen/not
           (shen/element\? "." V16011))
          V16011)
         ((shen/cons\? V16011)
          (vector
           (list
            (nthcdr 1 V16011))))
         (shen/true
          (shen/shen\.f_error 'shen\.strip-pathname)))))
    (let
        ((result
          (funcall #'tail-trampoline V16011)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.recursive_descent
    (V16015 V16016 V16017)
  (shen/cond
   ((shen/cons\? V16015)
    (shen/let Test
              (list
               (shen/hd V16015)
               V16016)
              (shen/let Action
                        (shen/shen\.syntax
                         (nthcdr 1 V16015)
                         (shen/concat 'Parse_
                                      (shen/hd V16015))
                         V16017)
                        (shen/let Else
                                  (list 'fail)
                                  (list 'let
                                        (shen/concat 'Parse_
                                                     (shen/hd V16015))
                                        Test
                                        (list 'if
                                              (list 'not
                                                    (list '=
                                                          (list 'fail)
                                                          (shen/concat 'Parse_
                                                                       (shen/hd V16015))))
                                              Action Else))))))
   (shen/true
    (shen/shen\.f_error 'shen\.recursive_descent))))
(defun shen/shen\.variable-match
    (V16021 V16022 V16023)
  (shen/cond
   ((shen/cons\? V16021)
    (shen/let Test
              (list 'cons\?
                    (list 'hd V16022))
              (shen/let Action
                        (list 'let
                              (shen/concat 'Parse_
                                           (shen/hd V16021))
                              (list 'hd
                                    (list 'hd V16022))
                              (shen/shen\.syntax
                               (nthcdr 1 V16021)
                               (list 'shen\.pair
                                     (list 'tl
                                           (list 'hd V16022))
                                     (list 'shen\.hdtl V16022))
                               V16023))
                        (shen/let Else
                                  (list 'fail)
                                  (list 'if Test Action Else)))))
   (shen/true
    (shen/shen\.f_error 'shen\.variable-match))))
(defun shen/shen\.terminal\?
    (V16033)
  (shen/cond
   ((shen/cons\? V16033)
    'false)
   ((shen/variable\? V16033)
    'false)
   (shen/true 'true)))
(defun shen/shen\.jump_stream\?
    (V16039)
  (shen/cond
   ((shen/= V16039 '_)
    'true)
   (shen/true 'false)))
(defun shen/shen\.check_stream
    (V16043 V16044 V16045)
  (shen/cond
   ((shen/cons\? V16043)
    (shen/let Test
              (list 'and
                    (list 'cons\?
                          (list 'hd V16044))
                    (list '=
                          (shen/hd V16043)
                          (list 'hd
                                (list 'hd V16044))))
              (shen/let Action
                        (shen/shen\.syntax
                         (nthcdr 1 V16043)
                         (list 'shen\.pair
                               (list 'tl
                                     (list 'hd V16044))
                               (list 'shen\.hdtl V16044))
                         V16045)
                        (shen/let Else
                                  (list 'fail)
                                  (list 'if Test Action Else)))))
   (shen/true
    (shen/shen\.f_error 'shen\.check_stream))))
(defun shen/shen\.jump_stream
    (V16049 V16050 V16051)
  (shen/cond
   ((shen/cons\? V16049)
    (shen/let Test
              (list 'cons\?
                    (list 'hd V16050))
              (shen/let Action
                        (shen/shen\.syntax
                         (nthcdr 1 V16049)
                         (list 'shen\.pair
                               (list 'tl
                                     (list 'hd V16050))
                               (list 'shen\.hdtl V16050))
                         V16051)
                        (shen/let Else
                                  (list 'fail)
                                  (list 'if Test Action Else)))))
   (shen/true
    (shen/shen\.f_error 'shen\.jump_stream))))
(defun shen/shen\.semantics
    (V16053)
  (shen/cond
   ((shen/predicate->shen
     (null V16053))
    nil)
   ((shen/shen\.grammar_symbol\? V16053)
    (list 'shen\.hdtl
          (shen/concat 'Parse_ V16053)))
   ((shen/variable\? V16053)
    (shen/concat 'Parse_ V16053))
   ((shen/cons\? V16053)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.semantics Z))
     V16053))
   (shen/true V16053)))
(defun shen/shen\.snd-or-fail
    (V16061)
  (shen/cond
   ((shen/and
     (shen/cons\? V16061)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V16061))
      (shen/predicate->shen
       (null
        (nthcdr 2 V16061)))))
    (shen/hd
     (nthcdr 1 V16061)))
   (shen/true
    (shen/fail))))
(defun shen/fail nil 'shen\.fail!)
(defun shen/shen\.pair
    (V16064 V16065)
  (list V16064 V16065))
(defun shen/shen\.hdtl
    (V16067)
  (shen/hd
   (nthcdr 1 V16067)))
(defun shen/shen\.<!>
    (V16075)
  (shen/cond
   ((shen/and
     (shen/cons\? V16075)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V16075))
      (shen/predicate->shen
       (null
        (nthcdr 2 V16075)))))
    (list nil
          (shen/hd V16075)))
   (shen/true
    (shen/fail))))
(defun shen/<e>
    (V16081)
  (shen/cond
   ((shen/and
     (shen/cons\? V16081)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V16081))
      (shen/predicate->shen
       (null
        (nthcdr 2 V16081)))))
    (list
     (shen/hd V16081)
     nil))
   (shen/true
    (shen/shen\.f_error '<e>))))
(defun shen/read-file-as-bytelist
    (V14083)
  (shen/let Stream
            (shen/open V14083 'in)
            (shen/let Byte
                      (shen/read-byte Stream)
                      (shen/let Bytes
                                (shen/shen\.read-file-as-bytelist-help Stream Byte nil)
                                (shen/let Close
                                          (shen/close Stream)
                                          (shen/reverse Bytes))))))
(defun shen/shen\.read-file-as-bytelist-help
    (V14087 V14088 V14089)
  (cl-flet
      ((tail-trampoline
        (V14087 V14088 V14089)
        (shen/cond
         ((shen/= -1 V14088)
          V14089)
         (shen/true
          (vector
           (list V14087
                 (shen/read-byte V14087)
                 (append
                  (list V14088)
                  V14089)))))))
    (let
        ((result
          (funcall #'tail-trampoline V14087 V14088 V14089)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/read-file-as-string
    (V14091)
  (shen/let Stream
            (shen/open V14091 'in)
            (shen/shen\.rfas-h Stream
                               (shen/read-byte Stream)
                               "")))
(defun shen/shen\.rfas-h
    (V14095 V14096 V14097)
  (cl-flet
      ((tail-trampoline
        (V14095 V14096 V14097)
        (shen/cond
         ((shen/= -1 V14096)
          (shen/do
           (shen/close V14095)
           V14097))
         (shen/true
          (vector
           (list V14095
                 (shen/read-byte V14095)
                 (shen/cn V14097
                          (shen/n->string V14096))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14095 V14096 V14097)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/input
    (V14099)
  (shen/eval-kl
   (shen/read V14099)))
(defun shen/input+
    (V14102 V14103)
  (shen/let Mono\?
            (shen/shen\.monotype V14102)
            (shen/let Input
                      (shen/read V14103)
                      (shen/if
                       (shen/= 'false
                               (shen/shen\.typecheck Input
                                                     (shen/shen\.demodulate V14102)))
                       (shen/simple-error
                        (shen/cn "type error: "
                                 (shen/shen\.app Input
                                                 (shen/cn " is not of type "
                                                          (shen/shen\.app V14102 "\n" 'shen\.r))
                                                 'shen\.r)))
                       (shen/eval-kl Input)))))
(defun shen/shen\.monotype
    (V14105)
  (shen/cond
   ((shen/cons\? V14105)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.monotype Z))
     V14105))
   (shen/true
    (shen/if
     (shen/variable\? V14105)
     (shen/simple-error
      (shen/cn "input+ expects a monotype: not "
               (shen/shen\.app V14105 "\n" 'shen\.a)))
     V14105))))
(defun shen/read
    (V14107)
  (shen/hd
   (shen/shen\.read-loop V14107
                         (shen/read-byte V14107)
                         nil)))
(defun shen/it nil
  (shen/value 'shen\.*it*))
(defun shen/shen\.read-loop
    (V14115 V14116 V14117)
  (cl-flet
      ((tail-trampoline
        (V14115 V14116 V14117)
        (shen/cond
         ((shen/= 94 V14116)
          (shen/simple-error "read aborted"))
         ((shen/= -1 V14116)
          (shen/if
           (shen/empty\? V14117)
           (shen/simple-error "error: empty stream")
           (shen/compile
            (shen/lambda X
                         (shen/shen\.<st_input> X))
            V14117
            (shen/lambda E E))))
         ((shen/shen\.terminator\? V14116)
          (shen/let AllBytes
                    (shen/append V14117
                                 (list V14116))
                    (shen/let It
                              (shen/shen\.record-it AllBytes)
                              (shen/let Read
                                        (shen/compile
                                         (shen/lambda X
                                                      (shen/shen\.<st_input> X))
                                         AllBytes
                                         (shen/lambda E 'shen\.nextbyte))
                                        (shen/if
                                         (shen/or
                                          (shen/= Read 'shen\.nextbyte)
                                          (shen/empty\? Read))
                                         (vector
                                          (list V14115
                                                (shen/read-byte V14115)
                                                AllBytes))
                                         Read)))))
         (shen/true
          (vector
           (list V14115
                 (shen/read-byte V14115)
                 (shen/append V14117
                              (list V14116))))))))
    (let
        ((result
          (funcall #'tail-trampoline V14115 V14116 V14117)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.terminator\?
    (V14119)
  (shen/element\? V14119
                  (list 9 10 13 32 34 41 93)))
(defun shen/lineread
    (V14121)
  (shen/shen\.lineread-loop
   (shen/read-byte V14121)
   nil V14121))
(defun shen/shen\.lineread-loop
    (V14126 V14127 V14128)
  (cl-flet
      ((tail-trampoline
        (V14126 V14127 V14128)
        (shen/cond
         ((shen/= -1 V14126)
          (shen/if
           (shen/empty\? V14127)
           (shen/simple-error "empty stream")
           (shen/compile
            (shen/lambda X
                         (shen/shen\.<st_input> X))
            V14127
            (shen/lambda E E))))
         ((shen/= V14126
                  (shen/shen\.hat))
          (shen/simple-error "line read aborted"))
         ((shen/element\? V14126
                          (list
                           (shen/shen\.newline)
                           (shen/shen\.carriage-return)))
          (shen/let Line
                    (shen/compile
                     (shen/lambda X
                                  (shen/shen\.<st_input> X))
                     V14127
                     (shen/lambda E 'shen\.nextline))
                    (shen/let It
                              (shen/shen\.record-it V14127)
                              (shen/if
                               (shen/or
                                (shen/= Line 'shen\.nextline)
                                (shen/empty\? Line))
                               (vector
                                (list
                                 (shen/read-byte V14128)
                                 (shen/append V14127
                                              (list V14126))
                                 V14128))
                               Line))))
         (shen/true
          (vector
           (list
            (shen/read-byte V14128)
            (shen/append V14127
                         (list V14126))
            V14128))))))
    (let
        ((result
          (funcall #'tail-trampoline V14126 V14127 V14128)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.record-it
    (V14130)
  (shen/let TrimLeft
            (shen/shen\.trim-whitespace V14130)
            (shen/let TrimRight
                      (shen/shen\.trim-whitespace
                       (shen/reverse TrimLeft))
                      (shen/let Trimmed
                                (shen/reverse TrimRight)
                                (shen/shen\.record-it-h Trimmed)))))
(defun shen/shen\.trim-whitespace
    (V14132)
  (cl-flet
      ((tail-trampoline
        (V14132)
        (shen/cond
         ((shen/and
           (shen/cons\? V14132)
           (shen/element\?
            (shen/hd V14132)
            (list 9 10 13 32)))
          (vector
           (list
            (nthcdr 1 V14132))))
         (shen/true V14132))))
    (let
        ((result
          (funcall #'tail-trampoline V14132)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.record-it-h
    (V14134)
  (shen/do
   (shen/set 'shen\.*it*
             (shen/shen\.cn-all
              (shen/map
               (shen/lambda X
                            (shen/n->string X))
               V14134)))
   V14134))
(defun shen/shen\.cn-all
    (V14136)
  (shen/cond
   ((shen/predicate->shen
     (null V14136))
    "")
   ((shen/cons\? V14136)
    (shen/cn
     (shen/hd V14136)
     (shen/shen\.cn-all
      (nthcdr 1 V14136))))
   (shen/true
    (shen/shen\.f_error 'shen\.cn-all))))
(defun shen/read-file
    (V14138)
  (shen/let Bytelist
            (shen/read-file-as-bytelist V14138)
            (shen/compile
             (shen/lambda X
                          (shen/shen\.<st_input> X))
             Bytelist
             (shen/lambda X
                          (shen/shen\.read-error X)))))
(defun shen/read-from-string
    (V14140)
  (shen/let Ns
            (shen/map
             (shen/lambda X
                          (shen/string->n X))
             (shen/explode V14140))
            (shen/compile
             (shen/lambda X
                          (shen/shen\.<st_input> X))
             Ns
             (shen/lambda X
                          (shen/shen\.read-error X)))))
(defun shen/shen\.read-error
    (V14148)
  (shen/cond
   ((shen/and
     (shen/cons\? V14148)
     (shen/and
      (shen/cons\?
       (shen/hd V14148))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14148))
       (shen/predicate->shen
        (null
         (nthcdr 2 V14148))))))
    (shen/simple-error
     (shen/cn "read error here:\n\n "
              (shen/shen\.app
               (shen/shen\.compress-50 50
                                       (shen/hd V14148))
               "\n" 'shen\.a))))
   (shen/true
    (shen/simple-error "read error\n"))))
(defun shen/shen\.compress-50
    (V14155 V14156)
  (shen/cond
   ((shen/predicate->shen
     (null V14156))
    "")
   ((shen/= 0 V14155)
    "")
   ((shen/cons\? V14156)
    (shen/cn
     (shen/n->string
      (shen/hd V14156))
     (shen/shen\.compress-50
      (shen/- V14155 1)
      (nthcdr 1 V14156))))
   (shen/true
    (shen/shen\.f_error 'shen\.compress-50))))
(defun shen/shen\.<st_input>
    (V14158)
  (shen/let YaccParse
            (shen/let Parse_shen\.<lsb>
                      (shen/shen\.<lsb> V14158)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<lsb>))
                       (shen/let Parse_shen\.<st_input1>
                                 (shen/shen\.<st_input1> Parse_shen\.<lsb>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<st_input1>))
                                  (shen/let Parse_shen\.<rsb>
                                            (shen/shen\.<rsb> Parse_shen\.<st_input1>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<rsb>))
                                             (shen/let Parse_shen\.<st_input2>
                                                       (shen/shen\.<st_input2> Parse_shen\.<rsb>)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<st_input2>))
                                                        (shen/shen\.pair
                                                         (shen/hd Parse_shen\.<st_input2>)
                                                         (append
                                                          (list
                                                           (shen/macroexpand
                                                            (shen/shen\.cons_form
                                                             (shen/shen\.hdtl Parse_shen\.<st_input1>))))
                                                          (shen/shen\.hdtl Parse_shen\.<st_input2>)))
                                                        (shen/fail)))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<lrb>
                                 (shen/shen\.<lrb> V14158)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<lrb>))
                                  (shen/let Parse_shen\.<st_input1>
                                            (shen/shen\.<st_input1> Parse_shen\.<lrb>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<st_input1>))
                                             (shen/let Parse_shen\.<rrb>
                                                       (shen/shen\.<rrb> Parse_shen\.<st_input1>)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<rrb>))
                                                        (shen/let Parse_shen\.<st_input2>
                                                                  (shen/shen\.<st_input2> Parse_shen\.<rrb>)
                                                                  (shen/if
                                                                   (shen/not
                                                                    (shen/=
                                                                     (shen/fail)
                                                                     Parse_shen\.<st_input2>))
                                                                   (shen/shen\.pair
                                                                    (shen/hd Parse_shen\.<st_input2>)
                                                                    (shen/shen\.package-macro
                                                                     (shen/macroexpand
                                                                      (shen/shen\.hdtl Parse_shen\.<st_input1>))
                                                                     (shen/shen\.hdtl Parse_shen\.<st_input2>)))
                                                                   (shen/fail)))
                                                        (shen/fail)))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let YaccParse
                                  (shen/let Parse_shen\.<lcurly>
                                            (shen/shen\.<lcurly> V14158)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<lcurly>))
                                             (shen/let Parse_shen\.<st_input>
                                                       (shen/shen\.<st_input> Parse_shen\.<lcurly>)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<st_input>))
                                                        (shen/shen\.pair
                                                         (shen/hd Parse_shen\.<st_input>)
                                                         (append
                                                          (list '{)
                                                          (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                        (shen/fail)))
                                             (shen/fail)))
                                  (shen/if
                                   (shen/= YaccParse
                                           (shen/fail))
                                   (shen/let YaccParse
                                             (shen/let Parse_shen\.<rcurly>
                                                       (shen/shen\.<rcurly> V14158)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<rcurly>))
                                                        (shen/let Parse_shen\.<st_input>
                                                                  (shen/shen\.<st_input> Parse_shen\.<rcurly>)
                                                                  (shen/if
                                                                   (shen/not
                                                                    (shen/=
                                                                     (shen/fail)
                                                                     Parse_shen\.<st_input>))
                                                                   (shen/shen\.pair
                                                                    (shen/hd Parse_shen\.<st_input>)
                                                                    (append
                                                                     (list '})
                                                                     (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                   (shen/fail)))
                                                        (shen/fail)))
                                             (shen/if
                                              (shen/= YaccParse
                                                      (shen/fail))
                                              (shen/let YaccParse
                                                        (shen/let Parse_shen\.<bar>
                                                                  (shen/shen\.<bar> V14158)
                                                                  (shen/if
                                                                   (shen/not
                                                                    (shen/=
                                                                     (shen/fail)
                                                                     Parse_shen\.<bar>))
                                                                   (shen/let Parse_shen\.<st_input>
                                                                             (shen/shen\.<st_input> Parse_shen\.<bar>)
                                                                             (shen/if
                                                                              (shen/not
                                                                               (shen/=
                                                                                (shen/fail)
                                                                                Parse_shen\.<st_input>))
                                                                              (shen/shen\.pair
                                                                               (shen/hd Parse_shen\.<st_input>)
                                                                               (append
                                                                                (list 'bar!)
                                                                                (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                              (shen/fail)))
                                                                   (shen/fail)))
                                                        (shen/if
                                                         (shen/= YaccParse
                                                                 (shen/fail))
                                                         (shen/let YaccParse
                                                                   (shen/let Parse_shen\.<semicolon>
                                                                             (shen/shen\.<semicolon> V14158)
                                                                             (shen/if
                                                                              (shen/not
                                                                               (shen/=
                                                                                (shen/fail)
                                                                                Parse_shen\.<semicolon>))
                                                                              (shen/let Parse_shen\.<st_input>
                                                                                        (shen/shen\.<st_input> Parse_shen\.<semicolon>)
                                                                                        (shen/if
                                                                                         (shen/not
                                                                                          (shen/=
                                                                                           (shen/fail)
                                                                                           Parse_shen\.<st_input>))
                                                                                         (shen/shen\.pair
                                                                                          (shen/hd Parse_shen\.<st_input>)
                                                                                          (append
                                                                                           (list '\;)
                                                                                           (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                                         (shen/fail)))
                                                                              (shen/fail)))
                                                                   (shen/if
                                                                    (shen/= YaccParse
                                                                            (shen/fail))
                                                                    (shen/let YaccParse
                                                                              (shen/let Parse_shen\.<colon>
                                                                                        (shen/shen\.<colon> V14158)
                                                                                        (shen/if
                                                                                         (shen/not
                                                                                          (shen/=
                                                                                           (shen/fail)
                                                                                           Parse_shen\.<colon>))
                                                                                         (shen/let Parse_shen\.<equal>
                                                                                                   (shen/shen\.<equal> Parse_shen\.<colon>)
                                                                                                   (shen/if
                                                                                                    (shen/not
                                                                                                     (shen/=
                                                                                                      (shen/fail)
                                                                                                      Parse_shen\.<equal>))
                                                                                                    (shen/let Parse_shen\.<st_input>
                                                                                                              (shen/shen\.<st_input> Parse_shen\.<equal>)
                                                                                                              (shen/if
                                                                                                               (shen/not
                                                                                                                (shen/=
                                                                                                                 (shen/fail)
                                                                                                                 Parse_shen\.<st_input>))
                                                                                                               (shen/shen\.pair
                                                                                                                (shen/hd Parse_shen\.<st_input>)
                                                                                                                (append
                                                                                                                 (list ':=)
                                                                                                                 (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                                                               (shen/fail)))
                                                                                                    (shen/fail)))
                                                                                         (shen/fail)))
                                                                              (shen/if
                                                                               (shen/= YaccParse
                                                                                       (shen/fail))
                                                                               (shen/let YaccParse
                                                                                         (shen/let Parse_shen\.<colon>
                                                                                                   (shen/shen\.<colon> V14158)
                                                                                                   (shen/if
                                                                                                    (shen/not
                                                                                                     (shen/=
                                                                                                      (shen/fail)
                                                                                                      Parse_shen\.<colon>))
                                                                                                    (shen/let Parse_shen\.<minus>
                                                                                                              (shen/shen\.<minus> Parse_shen\.<colon>)
                                                                                                              (shen/if
                                                                                                               (shen/not
                                                                                                                (shen/=
                                                                                                                 (shen/fail)
                                                                                                                 Parse_shen\.<minus>))
                                                                                                               (shen/let Parse_shen\.<st_input>
                                                                                                                         (shen/shen\.<st_input> Parse_shen\.<minus>)
                                                                                                                         (shen/if
                                                                                                                          (shen/not
                                                                                                                           (shen/=
                                                                                                                            (shen/fail)
                                                                                                                            Parse_shen\.<st_input>))
                                                                                                                          (shen/shen\.pair
                                                                                                                           (shen/hd Parse_shen\.<st_input>)
                                                                                                                           (append
                                                                                                                            (list ':-)
                                                                                                                            (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                                                                          (shen/fail)))
                                                                                                               (shen/fail)))
                                                                                                    (shen/fail)))
                                                                                         (shen/if
                                                                                          (shen/= YaccParse
                                                                                                  (shen/fail))
                                                                                          (shen/let YaccParse
                                                                                                    (shen/let Parse_shen\.<colon>
                                                                                                              (shen/shen\.<colon> V14158)
                                                                                                              (shen/if
                                                                                                               (shen/not
                                                                                                                (shen/=
                                                                                                                 (shen/fail)
                                                                                                                 Parse_shen\.<colon>))
                                                                                                               (shen/let Parse_shen\.<st_input>
                                                                                                                         (shen/shen\.<st_input> Parse_shen\.<colon>)
                                                                                                                         (shen/if
                                                                                                                          (shen/not
                                                                                                                           (shen/=
                                                                                                                            (shen/fail)
                                                                                                                            Parse_shen\.<st_input>))
                                                                                                                          (shen/shen\.pair
                                                                                                                           (shen/hd Parse_shen\.<st_input>)
                                                                                                                           (append
                                                                                                                            (list ':)
                                                                                                                            (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                                                                          (shen/fail)))
                                                                                                               (shen/fail)))
                                                                                                    (shen/if
                                                                                                     (shen/= YaccParse
                                                                                                             (shen/fail))
                                                                                                     (shen/let YaccParse
                                                                                                               (shen/let Parse_shen\.<comma>
                                                                                                                         (shen/shen\.<comma> V14158)
                                                                                                                         (shen/if
                                                                                                                          (shen/not
                                                                                                                           (shen/=
                                                                                                                            (shen/fail)
                                                                                                                            Parse_shen\.<comma>))
                                                                                                                          (shen/let Parse_shen\.<st_input>
                                                                                                                                    (shen/shen\.<st_input> Parse_shen\.<comma>)
                                                                                                                                    (shen/if
                                                                                                                                     (shen/not
                                                                                                                                      (shen/=
                                                                                                                                       (shen/fail)
                                                                                                                                       Parse_shen\.<st_input>))
                                                                                                                                     (shen/shen\.pair
                                                                                                                                      (shen/hd Parse_shen\.<st_input>)
                                                                                                                                      (append
                                                                                                                                       (list
                                                                                                                                        (shen/intern ","))
                                                                                                                                       (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                                                                                     (shen/fail)))
                                                                                                                          (shen/fail)))
                                                                                                               (shen/if
                                                                                                                (shen/= YaccParse
                                                                                                                        (shen/fail))
                                                                                                                (shen/let YaccParse
                                                                                                                          (shen/let Parse_shen\.<comment>
                                                                                                                                    (shen/shen\.<comment> V14158)
                                                                                                                                    (shen/if
                                                                                                                                     (shen/not
                                                                                                                                      (shen/=
                                                                                                                                       (shen/fail)
                                                                                                                                       Parse_shen\.<comment>))
                                                                                                                                     (shen/let Parse_shen\.<st_input>
                                                                                                                                               (shen/shen\.<st_input> Parse_shen\.<comment>)
                                                                                                                                               (shen/if
                                                                                                                                                (shen/not
                                                                                                                                                 (shen/=
                                                                                                                                                  (shen/fail)
                                                                                                                                                  Parse_shen\.<st_input>))
                                                                                                                                                (shen/shen\.pair
                                                                                                                                                 (shen/hd Parse_shen\.<st_input>)
                                                                                                                                                 (shen/shen\.hdtl Parse_shen\.<st_input>))
                                                                                                                                                (shen/fail)))
                                                                                                                                     (shen/fail)))
                                                                                                                          (shen/if
                                                                                                                           (shen/= YaccParse
                                                                                                                                   (shen/fail))
                                                                                                                           (shen/let YaccParse
                                                                                                                                     (shen/let Parse_shen\.<atom>
                                                                                                                                               (shen/shen\.<atom> V14158)
                                                                                                                                               (shen/if
                                                                                                                                                (shen/not
                                                                                                                                                 (shen/=
                                                                                                                                                  (shen/fail)
                                                                                                                                                  Parse_shen\.<atom>))
                                                                                                                                                (shen/let Parse_shen\.<st_input>
                                                                                                                                                          (shen/shen\.<st_input> Parse_shen\.<atom>)
                                                                                                                                                          (shen/if
                                                                                                                                                           (shen/not
                                                                                                                                                            (shen/=
                                                                                                                                                             (shen/fail)
                                                                                                                                                             Parse_shen\.<st_input>))
                                                                                                                                                           (shen/shen\.pair
                                                                                                                                                            (shen/hd Parse_shen\.<st_input>)
                                                                                                                                                            (append
                                                                                                                                                             (list
                                                                                                                                                              (shen/macroexpand
                                                                                                                                                               (shen/shen\.hdtl Parse_shen\.<atom>)))
                                                                                                                                                             (shen/shen\.hdtl Parse_shen\.<st_input>)))
                                                                                                                                                           (shen/fail)))
                                                                                                                                                (shen/fail)))
                                                                                                                                     (shen/if
                                                                                                                                      (shen/= YaccParse
                                                                                                                                              (shen/fail))
                                                                                                                                      (shen/let YaccParse
                                                                                                                                                (shen/let Parse_shen\.<whitespaces>
                                                                                                                                                          (shen/shen\.<whitespaces> V14158)
                                                                                                                                                          (shen/if
                                                                                                                                                           (shen/not
                                                                                                                                                            (shen/=
                                                                                                                                                             (shen/fail)
                                                                                                                                                             Parse_shen\.<whitespaces>))
                                                                                                                                                           (shen/let Parse_shen\.<st_input>
                                                                                                                                                                     (shen/shen\.<st_input> Parse_shen\.<whitespaces>)
                                                                                                                                                                     (shen/if
                                                                                                                                                                      (shen/not
                                                                                                                                                                       (shen/=
                                                                                                                                                                        (shen/fail)
                                                                                                                                                                        Parse_shen\.<st_input>))
                                                                                                                                                                      (shen/shen\.pair
                                                                                                                                                                       (shen/hd Parse_shen\.<st_input>)
                                                                                                                                                                       (shen/shen\.hdtl Parse_shen\.<st_input>))
                                                                                                                                                                      (shen/fail)))
                                                                                                                                                           (shen/fail)))
                                                                                                                                                (shen/if
                                                                                                                                                 (shen/= YaccParse
                                                                                                                                                         (shen/fail))
                                                                                                                                                 (shen/let Parse_<e>
                                                                                                                                                           (shen/<e> V14158)
                                                                                                                                                           (shen/if
                                                                                                                                                            (shen/not
                                                                                                                                                             (shen/=
                                                                                                                                                              (shen/fail)
                                                                                                                                                              Parse_<e>))
                                                                                                                                                            (shen/shen\.pair
                                                                                                                                                             (shen/hd Parse_<e>)
                                                                                                                                                             nil)
                                                                                                                                                            (shen/fail)))
                                                                                                                                                 YaccParse))
                                                                                                                                      YaccParse))
                                                                                                                           YaccParse))
                                                                                                                YaccParse))
                                                                                                     YaccParse))
                                                                                          YaccParse))
                                                                               YaccParse))
                                                                    YaccParse))
                                                         YaccParse))
                                              YaccParse))
                                   YaccParse))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.<lsb>
    (V14160)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14160))
    (shen/= 91
            (shen/hd
             (shen/hd V14160))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14160))
      (shen/shen\.hdtl V14160)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<rsb>
    (V14162)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14162))
    (shen/= 93
            (shen/hd
             (shen/hd V14162))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14162))
      (shen/shen\.hdtl V14162)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<lcurly>
    (V14164)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14164))
    (shen/= 123
            (shen/hd
             (shen/hd V14164))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14164))
      (shen/shen\.hdtl V14164)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<rcurly>
    (V14166)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14166))
    (shen/= 125
            (shen/hd
             (shen/hd V14166))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14166))
      (shen/shen\.hdtl V14166)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<bar>
    (V14168)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14168))
    (shen/= 124
            (shen/hd
             (shen/hd V14168))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14168))
      (shen/shen\.hdtl V14168)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<semicolon>
    (V14170)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14170))
    (shen/= 59
            (shen/hd
             (shen/hd V14170))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14170))
      (shen/shen\.hdtl V14170)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<colon>
    (V14172)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14172))
    (shen/= 58
            (shen/hd
             (shen/hd V14172))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14172))
      (shen/shen\.hdtl V14172)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<comma>
    (V14174)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14174))
    (shen/= 44
            (shen/hd
             (shen/hd V14174))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14174))
      (shen/shen\.hdtl V14174)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<equal>
    (V14176)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14176))
    (shen/= 61
            (shen/hd
             (shen/hd V14176))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14176))
      (shen/shen\.hdtl V14176)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<minus>
    (V14178)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14178))
    (shen/= 45
            (shen/hd
             (shen/hd V14178))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14178))
      (shen/shen\.hdtl V14178)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<lrb>
    (V14180)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14180))
    (shen/= 40
            (shen/hd
             (shen/hd V14180))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14180))
      (shen/shen\.hdtl V14180)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<rrb>
    (V14182)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14182))
    (shen/= 41
            (shen/hd
             (shen/hd V14182))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14182))
      (shen/shen\.hdtl V14182)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<atom>
    (V14184)
  (shen/let YaccParse
            (shen/let Parse_shen\.<str>
                      (shen/shen\.<str> V14184)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<str>))
                       (shen/shen\.pair
                        (shen/hd Parse_shen\.<str>)
                        (shen/shen\.control-chars
                         (shen/shen\.hdtl Parse_shen\.<str>)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<number>
                                 (shen/shen\.<number> V14184)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<number>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<number>)
                                   (shen/shen\.hdtl Parse_shen\.<number>))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let Parse_shen\.<sym>
                                  (shen/shen\.<sym> V14184)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<sym>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<sym>)
                                    (shen/if
                                     (shen/=
                                      (shen/shen\.hdtl Parse_shen\.<sym>)
                                      "<>")
                                     (list 'vector 0)
                                     (shen/intern
                                      (shen/shen\.hdtl Parse_shen\.<sym>))))
                                   (shen/fail)))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.control-chars
    (V14186)
  (shen/cond
   ((shen/predicate->shen
     (null V14186))
    "")
   ((shen/and
     (shen/cons\? V14186)
     (shen/and
      (shen/= "c"
              (shen/hd V14186))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14186))
       (shen/= "#"
               (shen/hd
                (nthcdr 1 V14186))))))
    (shen/let CodePoint
              (shen/shen\.code-point
               (nthcdr 2 V14186))
              (shen/let AfterCodePoint
                        (shen/shen\.after-codepoint
                         (nthcdr 2 V14186))
                        (concat
                         (concat
                          (shen/n->string
                           (shen/shen\.decimalise CodePoint)))
                         (shen/shen\.control-chars AfterCodePoint)))))
   ((shen/cons\? V14186)
    (concat
     (concat
      (shen/hd V14186))
     (shen/shen\.control-chars
      (nthcdr 1 V14186))))
   (shen/true
    (shen/shen\.f_error 'shen\.control-chars))))
(defun shen/shen\.code-point
    (V14190)
  (shen/cond
   ((shen/and
     (shen/cons\? V14190)
     (shen/= ";"
             (shen/hd V14190)))
    "")
   ((shen/and
     (shen/cons\? V14190)
     (shen/element\?
      (shen/hd V14190)
      (list "0" "1" "2" "3" "4" "5" "6" "7" "8" "9" "0")))
    (append
     (list
      (shen/hd V14190))
     (shen/shen\.code-point
      (nthcdr 1 V14190))))
   (shen/true
    (shen/simple-error
     (shen/cn "code point parse error "
              (shen/shen\.app V14190 "\n" 'shen\.a))))))
(defun shen/shen\.after-codepoint
    (V14196)
  (cl-flet
      ((tail-trampoline
        (V14196)
        (shen/cond
         ((shen/predicate->shen
           (null V14196))
          nil)
         ((shen/and
           (shen/cons\? V14196)
           (shen/= ";"
                   (shen/hd V14196)))
          (nthcdr 1 V14196))
         ((shen/cons\? V14196)
          (vector
           (list
            (nthcdr 1 V14196))))
         (shen/true
          (shen/shen\.f_error 'shen\.after-codepoint)))))
    (let
        ((result
          (funcall #'tail-trampoline V14196)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.decimalise
    (V14198)
  (shen/shen\.pre
   (shen/reverse
    (shen/shen\.digits->integers V14198))
   0))
(defun shen/shen\.digits->integers
    (V14204)
  (shen/cond
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "0"
             (shen/hd V14204)))
    (append
     (list 0)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "1"
             (shen/hd V14204)))
    (append
     (list 1)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "2"
             (shen/hd V14204)))
    (append
     (list 2)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "3"
             (shen/hd V14204)))
    (append
     (list 3)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "4"
             (shen/hd V14204)))
    (append
     (list 4)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "5"
             (shen/hd V14204)))
    (append
     (list 5)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "6"
             (shen/hd V14204)))
    (append
     (list 6)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "7"
             (shen/hd V14204)))
    (append
     (list 7)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "8"
             (shen/hd V14204)))
    (append
     (list 8)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   ((shen/and
     (shen/cons\? V14204)
     (shen/= "9"
             (shen/hd V14204)))
    (append
     (list 9)
     (shen/shen\.digits->integers
      (nthcdr 1 V14204))))
   (shen/true nil)))
(defun shen/shen\.<sym>
    (V14206)
  (shen/let Parse_shen\.<alpha>
            (shen/shen\.<alpha> V14206)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<alpha>))
             (shen/let Parse_shen\.<alphanums>
                       (shen/shen\.<alphanums> Parse_shen\.<alpha>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<alphanums>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<alphanums>)
                         (concat
                          (concat
                           (shen/shen\.hdtl Parse_shen\.<alpha>))
                          (shen/shen\.hdtl Parse_shen\.<alphanums>)))
                        (shen/fail)))
             (shen/fail))))
(defun shen/shen\.<alphanums>
    (V14208)
  (shen/let YaccParse
            (shen/let Parse_shen\.<alphanum>
                      (shen/shen\.<alphanum> V14208)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<alphanum>))
                       (shen/let Parse_shen\.<alphanums>
                                 (shen/shen\.<alphanums> Parse_shen\.<alphanum>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<alphanums>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<alphanums>)
                                   (concat
                                    (concat
                                     (shen/shen\.hdtl Parse_shen\.<alphanum>))
                                    (shen/shen\.hdtl Parse_shen\.<alphanums>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14208)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         "")
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<alphanum>
    (V14210)
  (shen/let YaccParse
            (shen/let Parse_shen\.<alpha>
                      (shen/shen\.<alpha> V14210)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<alpha>))
                       (shen/shen\.pair
                        (shen/hd Parse_shen\.<alpha>)
                        (shen/shen\.hdtl Parse_shen\.<alpha>))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<num>
                       (shen/shen\.<num> V14210)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<num>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<num>)
                         (shen/shen\.hdtl Parse_shen\.<num>))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<num>
    (V14212)
  (shen/if
   (shen/cons\?
    (shen/hd V14212))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14212))
             (shen/if
              (shen/shen\.numbyte\? Parse_Byte)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14212))
                 (shen/shen\.hdtl V14212)))
               (shen/n->string Parse_Byte))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.numbyte\?
    (V14218)
  (shen/cond
   ((shen/= 48 V14218)
    'true)
   ((shen/= 49 V14218)
    'true)
   ((shen/= 50 V14218)
    'true)
   ((shen/= 51 V14218)
    'true)
   ((shen/= 52 V14218)
    'true)
   ((shen/= 53 V14218)
    'true)
   ((shen/= 54 V14218)
    'true)
   ((shen/= 55 V14218)
    'true)
   ((shen/= 56 V14218)
    'true)
   ((shen/= 57 V14218)
    'true)
   (shen/true 'false)))
(defun shen/shen\.<alpha>
    (V14220)
  (shen/if
   (shen/cons\?
    (shen/hd V14220))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14220))
             (shen/if
              (shen/shen\.symbol-code\? Parse_Byte)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14220))
                 (shen/shen\.hdtl V14220)))
               (shen/n->string Parse_Byte))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.symbol-code\?
    (V14222)
  (shen/or
   (shen/= V14222 126)
   (shen/or
    (shen/and
     (shen/> V14222 94)
     (shen/< V14222 123))
    (shen/or
     (shen/and
      (shen/> V14222 59)
      (shen/< V14222 91))
     (shen/or
      (shen/and
       (shen/> V14222 41)
       (shen/and
        (shen/< V14222 58)
        (shen/not
         (shen/= V14222 44))))
      (shen/or
       (shen/and
        (shen/> V14222 34)
        (shen/< V14222 40))
       (shen/= V14222 33)))))))
(defun shen/shen\.<str>
    (V14224)
  (shen/let Parse_shen\.<dbq>
            (shen/shen\.<dbq> V14224)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<dbq>))
             (shen/let Parse_shen\.<strcontents>
                       (shen/shen\.<strcontents> Parse_shen\.<dbq>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<strcontents>))
                        (shen/let Parse_shen\.<dbq>
                                  (shen/shen\.<dbq> Parse_shen\.<strcontents>)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<dbq>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<dbq>)
                                    (shen/shen\.hdtl Parse_shen\.<strcontents>))
                                   (shen/fail)))
                        (shen/fail)))
             (shen/fail))))
(defun shen/shen\.<dbq>
    (V14226)
  (shen/if
   (shen/cons\?
    (shen/hd V14226))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14226))
             (shen/if
              (shen/= Parse_Byte 34)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14226))
                 (shen/shen\.hdtl V14226)))
               Parse_Byte)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<strcontents>
    (V14228)
  (shen/let YaccParse
            (shen/let Parse_shen\.<strc>
                      (shen/shen\.<strc> V14228)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<strc>))
                       (shen/let Parse_shen\.<strcontents>
                                 (shen/shen\.<strcontents> Parse_shen\.<strc>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<strcontents>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<strcontents>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<strc>))
                                    (shen/shen\.hdtl Parse_shen\.<strcontents>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14228)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<byte>
    (V14230)
  (shen/if
   (shen/cons\?
    (shen/hd V14230))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14230))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V14230))
                (shen/shen\.hdtl V14230)))
              (shen/n->string Parse_Byte)))
   (shen/fail)))
(defun shen/shen\.<strc>
    (V14232)
  (shen/if
   (shen/cons\?
    (shen/hd V14232))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14232))
             (shen/if
              (shen/not
               (shen/= Parse_Byte 34))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14232))
                 (shen/shen\.hdtl V14232)))
               (shen/n->string Parse_Byte))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<number>
    (V14234)
  (shen/let YaccParse
            (shen/let Parse_shen\.<minus>
                      (shen/shen\.<minus> V14234)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<minus>))
                       (shen/let Parse_shen\.<number>
                                 (shen/shen\.<number> Parse_shen\.<minus>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<number>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<number>)
                                   (shen/- 0
                                           (shen/shen\.hdtl Parse_shen\.<number>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<plus>
                                 (shen/shen\.<plus> V14234)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<plus>))
                                  (shen/let Parse_shen\.<number>
                                            (shen/shen\.<number> Parse_shen\.<plus>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<number>))
                                             (shen/shen\.pair
                                              (shen/hd Parse_shen\.<number>)
                                              (shen/shen\.hdtl Parse_shen\.<number>))
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/let YaccParse
                                  (shen/let Parse_shen\.<predigits>
                                            (shen/shen\.<predigits> V14234)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<predigits>))
                                             (shen/let Parse_shen\.<stop>
                                                       (shen/shen\.<stop> Parse_shen\.<predigits>)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<stop>))
                                                        (shen/let Parse_shen\.<postdigits>
                                                                  (shen/shen\.<postdigits> Parse_shen\.<stop>)
                                                                  (shen/if
                                                                   (shen/not
                                                                    (shen/=
                                                                     (shen/fail)
                                                                     Parse_shen\.<postdigits>))
                                                                   (shen/let Parse_shen\.<E>
                                                                             (shen/shen\.<E> Parse_shen\.<postdigits>)
                                                                             (shen/if
                                                                              (shen/not
                                                                               (shen/=
                                                                                (shen/fail)
                                                                                Parse_shen\.<E>))
                                                                              (shen/let Parse_shen\.<log10>
                                                                                        (shen/shen\.<log10> Parse_shen\.<E>)
                                                                                        (shen/if
                                                                                         (shen/not
                                                                                          (shen/=
                                                                                           (shen/fail)
                                                                                           Parse_shen\.<log10>))
                                                                                         (shen/shen\.pair
                                                                                          (shen/hd Parse_shen\.<log10>)
                                                                                          (shen/*
                                                                                           (shen/shen\.expt 10
                                                                                                            (shen/shen\.hdtl Parse_shen\.<log10>))
                                                                                           (shen/+
                                                                                            (shen/shen\.pre
                                                                                             (shen/reverse
                                                                                              (shen/shen\.hdtl Parse_shen\.<predigits>))
                                                                                             0)
                                                                                            (shen/shen\.post
                                                                                             (shen/shen\.hdtl Parse_shen\.<postdigits>)
                                                                                             1))))
                                                                                         (shen/fail)))
                                                                              (shen/fail)))
                                                                   (shen/fail)))
                                                        (shen/fail)))
                                             (shen/fail)))
                                  (shen/if
                                   (shen/= YaccParse
                                           (shen/fail))
                                   (shen/let YaccParse
                                             (shen/let Parse_shen\.<digits>
                                                       (shen/shen\.<digits> V14234)
                                                       (shen/if
                                                        (shen/not
                                                         (shen/=
                                                          (shen/fail)
                                                          Parse_shen\.<digits>))
                                                        (shen/let Parse_shen\.<E>
                                                                  (shen/shen\.<E> Parse_shen\.<digits>)
                                                                  (shen/if
                                                                   (shen/not
                                                                    (shen/=
                                                                     (shen/fail)
                                                                     Parse_shen\.<E>))
                                                                   (shen/let Parse_shen\.<log10>
                                                                             (shen/shen\.<log10> Parse_shen\.<E>)
                                                                             (shen/if
                                                                              (shen/not
                                                                               (shen/=
                                                                                (shen/fail)
                                                                                Parse_shen\.<log10>))
                                                                              (shen/shen\.pair
                                                                               (shen/hd Parse_shen\.<log10>)
                                                                               (shen/*
                                                                                (shen/shen\.expt 10
                                                                                                 (shen/shen\.hdtl Parse_shen\.<log10>))
                                                                                (shen/shen\.pre
                                                                                 (shen/reverse
                                                                                  (shen/shen\.hdtl Parse_shen\.<digits>))
                                                                                 0)))
                                                                              (shen/fail)))
                                                                   (shen/fail)))
                                                        (shen/fail)))
                                             (shen/if
                                              (shen/= YaccParse
                                                      (shen/fail))
                                              (shen/let YaccParse
                                                        (shen/let Parse_shen\.<predigits>
                                                                  (shen/shen\.<predigits> V14234)
                                                                  (shen/if
                                                                   (shen/not
                                                                    (shen/=
                                                                     (shen/fail)
                                                                     Parse_shen\.<predigits>))
                                                                   (shen/let Parse_shen\.<stop>
                                                                             (shen/shen\.<stop> Parse_shen\.<predigits>)
                                                                             (shen/if
                                                                              (shen/not
                                                                               (shen/=
                                                                                (shen/fail)
                                                                                Parse_shen\.<stop>))
                                                                              (shen/let Parse_shen\.<postdigits>
                                                                                        (shen/shen\.<postdigits> Parse_shen\.<stop>)
                                                                                        (shen/if
                                                                                         (shen/not
                                                                                          (shen/=
                                                                                           (shen/fail)
                                                                                           Parse_shen\.<postdigits>))
                                                                                         (shen/shen\.pair
                                                                                          (shen/hd Parse_shen\.<postdigits>)
                                                                                          (shen/+
                                                                                           (shen/shen\.pre
                                                                                            (shen/reverse
                                                                                             (shen/shen\.hdtl Parse_shen\.<predigits>))
                                                                                            0)
                                                                                           (shen/shen\.post
                                                                                            (shen/shen\.hdtl Parse_shen\.<postdigits>)
                                                                                            1)))
                                                                                         (shen/fail)))
                                                                              (shen/fail)))
                                                                   (shen/fail)))
                                                        (shen/if
                                                         (shen/= YaccParse
                                                                 (shen/fail))
                                                         (shen/let Parse_shen\.<digits>
                                                                   (shen/shen\.<digits> V14234)
                                                                   (shen/if
                                                                    (shen/not
                                                                     (shen/=
                                                                      (shen/fail)
                                                                      Parse_shen\.<digits>))
                                                                    (shen/shen\.pair
                                                                     (shen/hd Parse_shen\.<digits>)
                                                                     (shen/shen\.pre
                                                                      (shen/reverse
                                                                       (shen/shen\.hdtl Parse_shen\.<digits>))
                                                                      0))
                                                                    (shen/fail)))
                                                         YaccParse))
                                              YaccParse))
                                   YaccParse))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.<E>
    (V14236)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14236))
    (shen/= 101
            (shen/hd
             (shen/hd V14236))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14236))
      (shen/shen\.hdtl V14236)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<log10>
    (V14238)
  (shen/let YaccParse
            (shen/let Parse_shen\.<minus>
                      (shen/shen\.<minus> V14238)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<minus>))
                       (shen/let Parse_shen\.<digits>
                                 (shen/shen\.<digits> Parse_shen\.<minus>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<digits>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<digits>)
                                   (shen/- 0
                                           (shen/shen\.pre
                                            (shen/reverse
                                             (shen/shen\.hdtl Parse_shen\.<digits>))
                                            0)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<digits>
                       (shen/shen\.<digits> V14238)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<digits>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<digits>)
                         (shen/shen\.pre
                          (shen/reverse
                           (shen/shen\.hdtl Parse_shen\.<digits>))
                          0))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<plus>
    (V14240)
  (shen/if
   (shen/cons\?
    (shen/hd V14240))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14240))
             (shen/if
              (shen/= Parse_Byte 43)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14240))
                 (shen/shen\.hdtl V14240)))
               Parse_Byte)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<stop>
    (V14242)
  (shen/if
   (shen/cons\?
    (shen/hd V14242))
   (shen/let Parse_Byte
             (shen/hd
              (shen/hd V14242))
             (shen/if
              (shen/= Parse_Byte 46)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14242))
                 (shen/shen\.hdtl V14242)))
               Parse_Byte)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<predigits>
    (V14244)
  (shen/let YaccParse
            (shen/let Parse_shen\.<digits>
                      (shen/shen\.<digits> V14244)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<digits>))
                       (shen/shen\.pair
                        (shen/hd Parse_shen\.<digits>)
                        (shen/shen\.hdtl Parse_shen\.<digits>))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14244)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<postdigits>
    (V14246)
  (shen/let Parse_shen\.<digits>
            (shen/shen\.<digits> V14246)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<digits>))
             (shen/shen\.pair
              (shen/hd Parse_shen\.<digits>)
              (shen/shen\.hdtl Parse_shen\.<digits>))
             (shen/fail))))
(defun shen/shen\.<digits>
    (V14248)
  (shen/let YaccParse
            (shen/let Parse_shen\.<digit>
                      (shen/shen\.<digit> V14248)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<digit>))
                       (shen/let Parse_shen\.<digits>
                                 (shen/shen\.<digits> Parse_shen\.<digit>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<digits>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<digits>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<digit>))
                                    (shen/shen\.hdtl Parse_shen\.<digits>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<digit>
                       (shen/shen\.<digit> V14248)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<digit>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<digit>)
                         (list
                          (shen/shen\.hdtl Parse_shen\.<digit>)))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<digit>
    (V14250)
  (shen/if
   (shen/cons\?
    (shen/hd V14250))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14250))
             (shen/if
              (shen/shen\.numbyte\? Parse_X)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14250))
                 (shen/shen\.hdtl V14250)))
               (shen/shen\.byte->digit Parse_X))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.byte->digit
    (V14252)
  (shen/cond
   ((shen/= 48 V14252)
    0)
   ((shen/= 49 V14252)
    1)
   ((shen/= 50 V14252)
    2)
   ((shen/= 51 V14252)
    3)
   ((shen/= 52 V14252)
    4)
   ((shen/= 53 V14252)
    5)
   ((shen/= 54 V14252)
    6)
   ((shen/= 55 V14252)
    7)
   ((shen/= 56 V14252)
    8)
   ((shen/= 57 V14252)
    9)
   (shen/true
    (shen/shen\.f_error 'shen\.byte->digit))))
(defun shen/shen\.pre
    (V14257 V14258)
  (shen/cond
   ((shen/predicate->shen
     (null V14257))
    0)
   ((shen/cons\? V14257)
    (shen/+
     (shen/*
      (shen/shen\.expt 10 V14258)
      (shen/hd V14257))
     (shen/shen\.pre
      (nthcdr 1 V14257)
      (1+ V14258))))
   (shen/true
    (shen/shen\.f_error 'shen\.pre))))
(defun shen/shen\.post
    (V14263 V14264)
  (shen/cond
   ((shen/predicate->shen
     (null V14263))
    0)
   ((shen/cons\? V14263)
    (shen/+
     (shen/*
      (shen/shen\.expt 10
                       (shen/- 0 V14264))
      (shen/hd V14263))
     (shen/shen\.post
      (nthcdr 1 V14263)
      (1+ V14264))))
   (shen/true
    (shen/shen\.f_error 'shen\.post))))
(defun shen/shen\.expt
    (V14269 V14270)
  (shen/cond
   ((shen/= 0 V14270)
    1)
   ((shen/> V14270 0)
    (shen/* V14269
            (shen/shen\.expt V14269
                             (shen/- V14270 1))))
   (shen/true
    (shen/* 1.0
            (shen//
             (shen/shen\.expt V14269
                              (1+ V14270))
             V14269)))))
(defun shen/shen\.<st_input1>
    (V14272)
  (shen/let Parse_shen\.<st_input>
            (shen/shen\.<st_input> V14272)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<st_input>))
             (shen/shen\.pair
              (shen/hd Parse_shen\.<st_input>)
              (shen/shen\.hdtl Parse_shen\.<st_input>))
             (shen/fail))))
(defun shen/shen\.<st_input2>
    (V14274)
  (shen/let Parse_shen\.<st_input>
            (shen/shen\.<st_input> V14274)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<st_input>))
             (shen/shen\.pair
              (shen/hd Parse_shen\.<st_input>)
              (shen/shen\.hdtl Parse_shen\.<st_input>))
             (shen/fail))))
(defun shen/shen\.<comment>
    (V14276)
  (shen/let YaccParse
            (shen/let Parse_shen\.<singleline>
                      (shen/shen\.<singleline> V14276)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<singleline>))
                       (shen/shen\.pair
                        (shen/hd Parse_shen\.<singleline>)
                        'shen\.skip)
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<multiline>
                       (shen/shen\.<multiline> V14276)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<multiline>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<multiline>)
                         'shen\.skip)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<singleline>
    (V14278)
  (shen/let Parse_shen\.<backslash>
            (shen/shen\.<backslash> V14278)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<backslash>))
             (shen/let Parse_shen\.<backslash>
                       (shen/shen\.<backslash> Parse_shen\.<backslash>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<backslash>))
                        (shen/let Parse_shen\.<anysingle>
                                  (shen/shen\.<anysingle> Parse_shen\.<backslash>)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<anysingle>))
                                   (shen/let Parse_shen\.<return>
                                             (shen/shen\.<return> Parse_shen\.<anysingle>)
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<return>))
                                              (shen/shen\.pair
                                               (shen/hd Parse_shen\.<return>)
                                               'shen\.skip)
                                              (shen/fail)))
                                   (shen/fail)))
                        (shen/fail)))
             (shen/fail))))
(defun shen/shen\.<backslash>
    (V14280)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14280))
    (shen/= 92
            (shen/hd
             (shen/hd V14280))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14280))
      (shen/shen\.hdtl V14280)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<anysingle>
    (V14282)
  (shen/let YaccParse
            (shen/let Parse_shen\.<non-return>
                      (shen/shen\.<non-return> V14282)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<non-return>))
                       (shen/let Parse_shen\.<anysingle>
                                 (shen/shen\.<anysingle> Parse_shen\.<non-return>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<anysingle>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<anysingle>)
                                   'shen\.skip)
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V14282)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         'shen\.skip)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<non-return>
    (V14284)
  (shen/if
   (shen/cons\?
    (shen/hd V14284))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14284))
             (shen/if
              (shen/not
               (shen/element\? Parse_X
                               (list 10 13)))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14284))
                 (shen/shen\.hdtl V14284)))
               'shen\.skip)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<return>
    (V14286)
  (shen/if
   (shen/cons\?
    (shen/hd V14286))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14286))
             (shen/if
              (shen/element\? Parse_X
                              (list 10 13))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14286))
                 (shen/shen\.hdtl V14286)))
               'shen\.skip)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.<multiline>
    (V14288)
  (shen/let Parse_shen\.<backslash>
            (shen/shen\.<backslash> V14288)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<backslash>))
             (shen/let Parse_shen\.<times>
                       (shen/shen\.<times> Parse_shen\.<backslash>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<times>))
                        (shen/let Parse_shen\.<anymulti>
                                  (shen/shen\.<anymulti> Parse_shen\.<times>)
                                  (shen/if
                                   (shen/not
                                    (shen/=
                                     (shen/fail)
                                     Parse_shen\.<anymulti>))
                                   (shen/shen\.pair
                                    (shen/hd Parse_shen\.<anymulti>)
                                    'shen\.skip)
                                   (shen/fail)))
                        (shen/fail)))
             (shen/fail))))
(defun shen/shen\.<times>
    (V14290)
  (shen/if
   (shen/and
    (shen/cons\?
     (shen/hd V14290))
    (shen/= 42
            (shen/hd
             (shen/hd V14290))))
   (shen/shen\.pair
    (shen/hd
     (shen/shen\.pair
      (nthcdr 1
              (shen/hd V14290))
      (shen/shen\.hdtl V14290)))
    'shen\.skip)
   (shen/fail)))
(defun shen/shen\.<anymulti>
    (V14292)
  (shen/let YaccParse
            (shen/let Parse_shen\.<comment>
                      (shen/shen\.<comment> V14292)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<comment>))
                       (shen/let Parse_shen\.<anymulti>
                                 (shen/shen\.<anymulti> Parse_shen\.<comment>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<anymulti>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<anymulti>)
                                   'shen\.skip)
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let YaccParse
                       (shen/let Parse_shen\.<times>
                                 (shen/shen\.<times> V14292)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<times>))
                                  (shen/let Parse_shen\.<backslash>
                                            (shen/shen\.<backslash> Parse_shen\.<times>)
                                            (shen/if
                                             (shen/not
                                              (shen/=
                                               (shen/fail)
                                               Parse_shen\.<backslash>))
                                             (shen/shen\.pair
                                              (shen/hd Parse_shen\.<backslash>)
                                              'shen\.skip)
                                             (shen/fail)))
                                  (shen/fail)))
                       (shen/if
                        (shen/= YaccParse
                                (shen/fail))
                        (shen/if
                         (shen/cons\?
                          (shen/hd V14292))
                         (shen/let Parse_X
                                   (shen/hd
                                    (shen/hd V14292))
                                   (shen/let Parse_shen\.<anymulti>
                                             (shen/shen\.<anymulti>
                                              (shen/shen\.pair
                                               (nthcdr 1
                                                       (shen/hd V14292))
                                               (shen/shen\.hdtl V14292)))
                                             (shen/if
                                              (shen/not
                                               (shen/=
                                                (shen/fail)
                                                Parse_shen\.<anymulti>))
                                              (shen/shen\.pair
                                               (shen/hd Parse_shen\.<anymulti>)
                                               'shen\.skip)
                                              (shen/fail))))
                         (shen/fail))
                        YaccParse))
             YaccParse)))
(defun shen/shen\.<whitespaces>
    (V14294)
  (shen/let YaccParse
            (shen/let Parse_shen\.<whitespace>
                      (shen/shen\.<whitespace> V14294)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<whitespace>))
                       (shen/let Parse_shen\.<whitespaces>
                                 (shen/shen\.<whitespaces> Parse_shen\.<whitespace>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<whitespaces>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<whitespaces>)
                                   'shen\.skip)
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<whitespace>
                       (shen/shen\.<whitespace> V14294)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<whitespace>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<whitespace>)
                         'shen\.skip)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<whitespace>
    (V14296)
  (shen/if
   (shen/cons\?
    (shen/hd V14296))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V14296))
             (shen/if
              (shen/let Parse_Case Parse_X
                        (shen/or
                         (shen/= Parse_Case 32)
                         (shen/or
                          (shen/= Parse_Case 13)
                          (shen/or
                           (shen/= Parse_Case 10)
                           (shen/= Parse_Case 9)))))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V14296))
                 (shen/shen\.hdtl V14296)))
               'shen\.skip)
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.cons_form
    (V14298)
  (shen/cond
   ((shen/predicate->shen
     (null V14298))
    nil)
   ((shen/and
     (shen/cons\? V14298)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14298))
      (shen/and
       (shen/cons\?
        (nthcdr 2 V14298))
       (shen/and
        (shen/predicate->shen
         (null
          (nthcdr 3 V14298)))
        (shen/=
         (shen/hd
          (nthcdr 1 V14298))
         'bar!)))))
    (append
     (list 'cons
           (shen/hd V14298))
     (nthcdr 2 V14298)))
   ((shen/cons\? V14298)
    (list 'cons
          (shen/hd V14298)
          (shen/shen\.cons_form
           (nthcdr 1 V14298))))
   (shen/true
    (shen/shen\.f_error 'shen\.cons_form))))
(defun shen/shen\.package-macro
    (V14303 V14304)
  (shen/cond
   ((shen/and
     (shen/cons\? V14303)
     (shen/and
      (shen/= '$
              (shen/hd V14303))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14303))
       (shen/predicate->shen
        (null
         (nthcdr 2 V14303))))))
    (shen/append
     (shen/explode
      (shen/hd
       (nthcdr 1 V14303)))
     V14304))
   ((shen/and
     (shen/cons\? V14303)
     (shen/and
      (shen/= 'package
              (shen/hd V14303))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14303))
       (shen/and
        (shen/= 'null
                (shen/hd
                 (nthcdr 1 V14303)))
        (shen/cons\?
         (nthcdr 2 V14303))))))
    (shen/append
     (nthcdr 3 V14303)
     V14304))
   ((shen/and
     (shen/cons\? V14303)
     (shen/and
      (shen/= 'package
              (shen/hd V14303))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V14303))
       (shen/cons\?
        (nthcdr 2 V14303)))))
    (shen/let ListofExceptions
              (shen/shen\.eval-without-macros
               (shen/hd
                (nthcdr 2 V14303)))
              (shen/let External
                        (shen/shen\.record-exceptions ListofExceptions
                                                      (shen/hd
                                                       (nthcdr 1 V14303)))
                        (shen/let PackageNameDot
                                  (shen/intern
                                   (shen/cn
                                    (shen/str
                                     (shen/hd
                                      (nthcdr 1 V14303)))
                                    "."))
                                  (shen/let ExpPackageName
                                            (shen/explode
                                             (shen/hd
                                              (nthcdr 1 V14303)))
                                            (shen/let Packaged
                                                      (shen/shen\.packageh PackageNameDot ListofExceptions
                                                                           (nthcdr 3 V14303)
                                                                           ExpPackageName)
                                                      (shen/let Internal
                                                                (shen/shen\.record-internal
                                                                 (shen/hd
                                                                  (nthcdr 1 V14303))
                                                                 (shen/shen\.internal-symbols ExpPackageName Packaged))
                                                                (shen/append Packaged V14304))))))))
   (shen/true
    (append
     (list V14303)
     V14304))))
(defun shen/shen\.record-exceptions
    (V14307 V14308)
  (shen/let CurrExceptions
            (shen/trap-error
             (shen/get V14308 'shen\.external-symbols
                       (shen/value '*property-vector*))
             (shen/lambda E nil))
            (shen/let AllExceptions
                      (shen/union V14307 CurrExceptions)
                      (shen/put V14308 'shen\.external-symbols AllExceptions
                                (shen/value '*property-vector*)))))
(defun shen/shen\.record-internal
    (V14311 V14312)
  (shen/put V14311 'shen\.internal-symbols
            (shen/union V14312
                        (shen/trap-error
                         (shen/get V14311 'shen\.internal-symbols
                                   (shen/value '*property-vector*))
                         (shen/lambda E nil)))
            (shen/value '*property-vector*)))
(defun shen/shen\.internal-symbols
    (V14323 V14324)
  (shen/cond
   ((shen/and
     (shen/symbol\? V14324)
     (shen/shen\.prefix\? V14323
                          (shen/explode V14324)))
    (list V14324))
   ((shen/cons\? V14324)
    (shen/union
     (shen/shen\.internal-symbols V14323
                                  (shen/hd V14324))
     (shen/shen\.internal-symbols V14323
                                  (nthcdr 1 V14324))))
   (shen/true nil)))
(defun shen/shen\.packageh
    (V14341 V14342 V14343 V14344)
  (shen/cond
   ((shen/cons\? V14343)
    (append
     (list
      (shen/shen\.packageh V14341 V14342
                           (shen/hd V14343)
                           V14344))
     (shen/shen\.packageh V14341 V14342
                          (nthcdr 1 V14343)
                          V14344)))
   ((shen/or
     (shen/shen\.sysfunc\? V14343)
     (shen/or
      (shen/variable\? V14343)
      (shen/or
       (shen/element\? V14343 V14342)
       (shen/or
        (shen/shen\.doubleunderline\? V14343)
        (shen/shen\.singleunderline\? V14343)))))
    V14343)
   ((shen/and
     (shen/symbol\? V14343)
     (shen/let ExplodeX
               (shen/explode V14343)
               (shen/and
                (shen/not
                 (shen/shen\.prefix\?
                  (list "s" "h" "e" "n" ".")
                  ExplodeX))
                (shen/not
                 (shen/shen\.prefix\? V14344 ExplodeX)))))
    (shen/concat V14341 V14343))
   (shen/true V14343)))
(defun shen/shen\.<defprolog>
    (V13538)
  (shen/let Parse_shen\.<predicate*>
            (shen/shen\.<predicate*> V13538)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<predicate*>))
             (shen/let Parse_shen\.<clauses*>
                       (shen/shen\.<clauses*> Parse_shen\.<predicate*>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<clauses*>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<clauses*>)
                         (shen/hd
                          (shen/shen\.prolog->shen
                           (shen/map
                            (shen/lambda Parse_X
                                         (shen/shen\.insert-predicate
                                          (shen/shen\.hdtl Parse_shen\.<predicate*>)
                                          Parse_X))
                            (shen/shen\.hdtl Parse_shen\.<clauses*>)))))
                        (shen/fail)))
             (shen/fail))))
(defun shen/shen\.prolog-error
    (V13547 V13548)
  (shen/cond
   ((shen/and
     (shen/cons\? V13548)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13548))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13548)))))
    (shen/simple-error
     (shen/cn "prolog syntax error in "
              (shen/shen\.app V13547
                              (shen/cn " here:\n\n "
                                       (shen/shen\.app
                                        (shen/shen\.next-50 50
                                                            (shen/hd V13548))
                                        "\n" 'shen\.a))
                              'shen\.a))))
   (shen/true
    (shen/simple-error
     (shen/cn "prolog syntax error in "
              (shen/shen\.app V13547 "\n" 'shen\.a))))))
(defun shen/shen\.next-50
    (V13555 V13556)
  (shen/cond
   ((shen/predicate->shen
     (null V13556))
    "")
   ((shen/= 0 V13555)
    "")
   ((shen/cons\? V13556)
    (shen/cn
     (shen/shen\.decons-string
      (shen/hd V13556))
     (shen/shen\.next-50
      (shen/- V13555 1)
      (nthcdr 1 V13556))))
   (shen/true
    (shen/shen\.f_error 'shen\.next-50))))
(defun shen/shen\.decons-string
    (V13558)
  (shen/cond
   ((shen/and
     (shen/cons\? V13558)
     (shen/and
      (shen/= 'cons
              (shen/hd V13558))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13558))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13558))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13558)))))))
    (shen/shen\.app
     (shen/shen\.eval-cons V13558)
     " " 'shen\.s))
   (shen/true
    (shen/shen\.app V13558 " " 'shen\.r))))
(defun shen/shen\.insert-predicate
    (V13561 V13562)
  (shen/cond
   ((shen/and
     (shen/cons\? V13562)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13562))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13562)))))
    (append
     (list
      (append
       (list V13561)
       (shen/hd V13562))
      ':-)
     (nthcdr 1 V13562)))
   (shen/true
    (shen/shen\.f_error 'shen\.insert-predicate))))
(defun shen/shen\.<predicate*>
    (V13564)
  (shen/if
   (shen/cons\?
    (shen/hd V13564))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V13564))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V13564))
                (shen/shen\.hdtl V13564)))
              Parse_X))
   (shen/fail)))
(defun shen/shen\.<clauses*>
    (V13566)
  (shen/let YaccParse
            (shen/let Parse_shen\.<clause*>
                      (shen/shen\.<clause*> V13566)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<clause*>))
                       (shen/let Parse_shen\.<clauses*>
                                 (shen/shen\.<clauses*> Parse_shen\.<clause*>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<clauses*>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<clauses*>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<clause*>))
                                    (shen/shen\.hdtl Parse_shen\.<clauses*>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V13566)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<clause*>
    (V13568)
  (shen/let Parse_shen\.<head*>
            (shen/shen\.<head*> V13568)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<head*>))
             (shen/if
              (shen/and
               (shen/cons\?
                (shen/hd Parse_shen\.<head*>))
               (shen/= '<--
                       (shen/hd
                        (shen/hd Parse_shen\.<head*>))))
              (shen/let Parse_shen\.<body*>
                        (shen/shen\.<body*>
                         (shen/shen\.pair
                          (nthcdr 1
                                  (shen/hd Parse_shen\.<head*>))
                          (shen/shen\.hdtl Parse_shen\.<head*>)))
                        (shen/if
                         (shen/not
                          (shen/=
                           (shen/fail)
                           Parse_shen\.<body*>))
                         (shen/let Parse_shen\.<end*>
                                   (shen/shen\.<end*> Parse_shen\.<body*>)
                                   (shen/if
                                    (shen/not
                                     (shen/=
                                      (shen/fail)
                                      Parse_shen\.<end*>))
                                    (shen/shen\.pair
                                     (shen/hd Parse_shen\.<end*>)
                                     (list
                                      (shen/shen\.hdtl Parse_shen\.<head*>)
                                      (shen/shen\.hdtl Parse_shen\.<body*>)))
                                    (shen/fail)))
                         (shen/fail)))
              (shen/fail))
             (shen/fail))))
(defun shen/shen\.<head*>
    (V13570)
  (shen/let YaccParse
            (shen/let Parse_shen\.<term*>
                      (shen/shen\.<term*> V13570)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<term*>))
                       (shen/let Parse_shen\.<head*>
                                 (shen/shen\.<head*> Parse_shen\.<term*>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<head*>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<head*>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<term*>))
                                    (shen/shen\.hdtl Parse_shen\.<head*>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V13570)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<term*>
    (V13572)
  (shen/if
   (shen/cons\?
    (shen/hd V13572))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V13572))
             (shen/if
              (shen/and
               (shen/not
                (shen/= '<-- Parse_X))
               (shen/shen\.legitimate-term\? Parse_X))
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V13572))
                 (shen/shen\.hdtl V13572)))
               (shen/shen\.eval-cons Parse_X))
              (shen/fail)))
   (shen/fail)))
(defun shen/shen\.legitimate-term\?
    (V13578)
  (cl-flet
      ((tail-trampoline
        (V13578)
        (shen/cond
         ((shen/and
           (shen/cons\? V13578)
           (shen/and
            (shen/= 'cons
                    (shen/hd V13578))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13578))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13578))
              (shen/predicate->shen
               (null
                (nthcdr 3 V13578)))))))
          (shen/and
           (shen/shen\.legitimate-term\?
            (shen/hd
             (nthcdr 1 V13578)))
           (shen/shen\.legitimate-term\?
            (shen/hd
             (nthcdr 2 V13578)))))
         ((shen/and
           (shen/cons\? V13578)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13578))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13578))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13578))
              (shen/and
               (shen/= '+
                       (shen/hd
                        (nthcdr 2 V13578)))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13578))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 1 V13578)))))
         ((shen/and
           (shen/cons\? V13578)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13578))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13578))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13578))
              (shen/and
               (shen/= '-
                       (shen/hd
                        (nthcdr 2 V13578)))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13578))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 1 V13578)))))
         ((shen/cons\? V13578)
          'false)
         (shen/true 'true))))
    (let
        ((result
          (funcall #'tail-trampoline V13578)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.eval-cons
    (V13580)
  (shen/cond
   ((shen/and
     (shen/cons\? V13580)
     (shen/and
      (shen/= 'cons
              (shen/hd V13580))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13580))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13580))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13580)))))))
    (append
     (list
      (shen/shen\.eval-cons
       (shen/hd
        (nthcdr 1 V13580))))
     (shen/shen\.eval-cons
      (shen/hd
       (nthcdr 2 V13580)))))
   ((shen/and
     (shen/cons\? V13580)
     (shen/and
      (shen/= 'mode
              (shen/hd V13580))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13580))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13580))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13580)))))))
    (append
     (list 'mode
           (shen/shen\.eval-cons
            (shen/hd
             (nthcdr 1 V13580))))
     (nthcdr 2 V13580)))
   (shen/true V13580)))
(defun shen/shen\.<body*>
    (V13582)
  (shen/let YaccParse
            (shen/let Parse_shen\.<literal*>
                      (shen/shen\.<literal*> V13582)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<literal*>))
                       (shen/let Parse_shen\.<body*>
                                 (shen/shen\.<body*> Parse_shen\.<literal*>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<body*>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<body*>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<literal*>))
                                    (shen/shen\.hdtl Parse_shen\.<body*>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_<e>
                       (shen/<e> V13582)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_<e>))
                        (shen/shen\.pair
                         (shen/hd Parse_<e>)
                         nil)
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.<literal*>
    (V13584)
  (shen/let YaccParse
            (shen/if
             (shen/and
              (shen/cons\?
               (shen/hd V13584))
              (shen/= '!
                      (shen/hd
                       (shen/hd V13584))))
             (shen/shen\.pair
              (shen/hd
               (shen/shen\.pair
                (nthcdr 1
                        (shen/hd V13584))
                (shen/shen\.hdtl V13584)))
              (list 'cut
                    (shen/intern "Throwcontrol")))
             (shen/fail))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/if
              (shen/cons\?
               (shen/hd V13584))
              (shen/let Parse_X
                        (shen/hd
                         (shen/hd V13584))
                        (shen/if
                         (shen/cons\? Parse_X)
                         (shen/shen\.pair
                          (shen/hd
                           (shen/shen\.pair
                            (nthcdr 1
                                    (shen/hd V13584))
                            (shen/shen\.hdtl V13584)))
                          Parse_X)
                         (shen/fail)))
              (shen/fail))
             YaccParse)))
(defun shen/shen\.<end*>
    (V13586)
  (shen/if
   (shen/cons\?
    (shen/hd V13586))
   (shen/let Parse_X
             (shen/hd
              (shen/hd V13586))
             (shen/if
              (shen/= Parse_X '\;)
              (shen/shen\.pair
               (shen/hd
                (shen/shen\.pair
                 (nthcdr 1
                         (shen/hd V13586))
                 (shen/shen\.hdtl V13586)))
               Parse_X)
              (shen/fail)))
   (shen/fail)))
(defun shen/cut
    (V13590 V13591 V13592)
  (shen/let Result
            (shen/thaw V13592)
            (shen/if
             (shen/= Result 'false)
             V13590 Result)))
(defun shen/shen\.insert_modes
    (V13594)
  (shen/cond
   ((shen/and
     (shen/cons\? V13594)
     (shen/and
      (shen/= 'mode
              (shen/hd V13594))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13594))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13594))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13594)))))))
    V13594)
   ((shen/predicate->shen
     (null V13594))
    nil)
   ((shen/cons\? V13594)
    (list
     (list 'mode
           (shen/hd V13594)
           '+)
     'mode
     (shen/shen\.insert_modes
      (nthcdr 1 V13594))
     '-))
   (shen/true V13594)))
(defun shen/shen\.s-prolog
    (V13596)
  (shen/map
   (shen/lambda X
                (shen/eval X))
   (shen/shen\.prolog->shen V13596)))
(defun shen/shen\.prolog->shen
    (V13598)
  (shen/map
   (shen/lambda X
                (shen/shen\.compile_prolog_procedure X))
   (shen/shen\.group_clauses
    (shen/map
     (shen/lambda X
                  (shen/shen\.s-prolog_clause X))
     (shen/mapcan
      (shen/lambda X
                   (shen/shen\.head_abstraction X))
      V13598)))))
(defun shen/shen\.s-prolog_clause
    (V13600)
  (shen/cond
   ((shen/and
     (shen/cons\? V13600)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13600))
      (shen/and
       (shen/= ':-
               (shen/hd
                (nthcdr 1 V13600)))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13600))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13600)))))))
    (list
     (shen/hd V13600)
     ':-
     (shen/map
      (shen/lambda X
                   (shen/shen\.s-prolog_literal X))
      (shen/hd
       (nthcdr 2 V13600)))))
   (shen/true
    (shen/shen\.f_error 'shen\.s-prolog_clause))))
(defun shen/shen\.head_abstraction
    (V13602)
  (shen/cond
   ((shen/and
     (shen/cons\? V13602)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13602))
      (shen/and
       (shen/= ':-
               (shen/hd
                (nthcdr 1 V13602)))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13602))
        (shen/and
         (shen/predicate->shen
          (null
           (nthcdr 3 V13602)))
         (shen/<
          (shen/shen\.complexity_head
           (shen/hd V13602))
          (shen/value 'shen\.*maxcomplexity*)))))))
    (list V13602))
   ((shen/and
     (shen/cons\? V13602)
     (shen/and
      (shen/cons\?
       (shen/hd V13602))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13602))
       (shen/and
        (shen/= ':-
                (shen/hd
                 (nthcdr 1 V13602)))
        (shen/and
         (shen/cons\?
          (nthcdr 2 V13602))
         (shen/predicate->shen
          (null
           (nthcdr 3 V13602))))))))
    (shen/let Terms
              (shen/map
               (shen/lambda Y
                            (shen/gensym 'V))
               (nthcdr 1
                       (shen/hd V13602)))
              (shen/let XTerms
                        (shen/shen\.rcons_form
                         (shen/shen\.remove_modes
                          (nthcdr 1
                                  (shen/hd V13602))))
                        (shen/let Literal
                                  (list 'unify
                                        (shen/shen\.cons_form Terms)
                                        XTerms)
                                  (shen/let Clause
                                            (list
                                             (append
                                              (list
                                               (shen/hd
                                                (shen/hd V13602)))
                                              Terms)
                                             ':-
                                             (append
                                              (list Literal)
                                              (shen/hd
                                               (nthcdr 2 V13602))))
                                            (list Clause))))))
   (shen/true
    (shen/shen\.f_error 'shen\.head_abstraction))))
(defun shen/shen\.complexity_head
    (V13608)
  (shen/cond
   ((shen/cons\? V13608)
    (shen/shen\.product
     (shen/map
      (shen/lambda X
                   (shen/shen\.complexity X))
      (nthcdr 1 V13608))))
   (shen/true
    (shen/shen\.f_error 'shen\.complexity_head))))
(defun shen/shen\.complexity
    (V13617)
  (cl-flet
      ((tail-trampoline
        (V13617)
        (shen/cond
         ((shen/and
           (shen/cons\? V13617)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13617))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13617))
             (shen/and
              (shen/cons\?
               (shen/hd
                (nthcdr 1 V13617)))
              (shen/and
               (shen/= 'mode
                       (shen/hd
                        (shen/hd
                         (nthcdr 1 V13617))))
               (shen/and
                (shen/cons\?
                 (nthcdr 1
                         (shen/hd
                          (nthcdr 1 V13617))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 2
                          (shen/hd
                           (nthcdr 1 V13617))))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 3
                            (shen/hd
                             (nthcdr 1 V13617)))))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 2 V13617))
                   (shen/predicate->shen
                    (null
                     (nthcdr 3 V13617))))))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 1 V13617)))))
         ((shen/and
           (shen/cons\? V13617)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13617))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13617))
             (shen/and
              (shen/cons\?
               (shen/hd
                (nthcdr 1 V13617)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13617))
               (shen/and
                (shen/= '+
                        (shen/hd
                         (nthcdr 2 V13617)))
                (shen/predicate->shen
                 (null
                  (nthcdr 3 V13617)))))))))
          (shen/* 2
                  (shen/*
                   (shen/shen\.complexity
                    (append
                     (list 'mode
                           (shen/hd
                            (shen/hd
                             (nthcdr 1 V13617))))
                     (nthcdr 2 V13617)))
                   (shen/shen\.complexity
                    (append
                     (list 'mode
                           (nthcdr 1
                                   (shen/hd
                                    (nthcdr 1 V13617))))
                     (nthcdr 2 V13617))))))
         ((shen/and
           (shen/cons\? V13617)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13617))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13617))
             (shen/and
              (shen/cons\?
               (shen/hd
                (nthcdr 1 V13617)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13617))
               (shen/and
                (shen/= '-
                        (shen/hd
                         (nthcdr 2 V13617)))
                (shen/predicate->shen
                 (null
                  (nthcdr 3 V13617)))))))))
          (shen/*
           (shen/shen\.complexity
            (append
             (list 'mode
                   (shen/hd
                    (shen/hd
                     (nthcdr 1 V13617))))
             (nthcdr 2 V13617)))
           (shen/shen\.complexity
            (append
             (list 'mode
                   (nthcdr 1
                           (shen/hd
                            (nthcdr 1 V13617))))
             (nthcdr 2 V13617)))))
         ((shen/and
           (shen/cons\? V13617)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13617))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13617))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13617))
              (shen/and
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13617)))
               (shen/variable\?
                (shen/hd
                 (nthcdr 1 V13617))))))))
          1)
         ((shen/and
           (shen/cons\? V13617)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13617))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13617))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13617))
              (shen/and
               (shen/= '+
                       (shen/hd
                        (nthcdr 2 V13617)))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13617))))))))
          2)
         ((shen/and
           (shen/cons\? V13617)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13617))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13617))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13617))
              (shen/and
               (shen/= '-
                       (shen/hd
                        (nthcdr 2 V13617)))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13617))))))))
          1)
         (shen/true
          (vector
           (list
            (list 'mode V13617 '+)))))))
    (let
        ((result
          (funcall #'tail-trampoline V13617)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.product
    (V13619)
  (shen/cond
   ((shen/predicate->shen
     (null V13619))
    1)
   ((shen/cons\? V13619)
    (shen/*
     (shen/hd V13619)
     (shen/shen\.product
      (nthcdr 1 V13619))))
   (shen/true
    (shen/shen\.f_error 'shen\.product))))
(defun shen/shen\.s-prolog_literal
    (V13621)
  (shen/cond
   ((shen/and
     (shen/cons\? V13621)
     (shen/and
      (shen/= 'is
              (shen/hd V13621))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13621))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13621))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13621)))))))
    (list 'bind
          (shen/hd
           (nthcdr 1 V13621))
          (shen/shen\.insert_deref
           (shen/hd
            (nthcdr 2 V13621)))))
   ((shen/and
     (shen/cons\? V13621)
     (shen/and
      (shen/= 'when
              (shen/hd V13621))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13621))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13621))))))
    (list 'fwhen
          (shen/shen\.insert_deref
           (shen/hd
            (nthcdr 1 V13621)))))
   ((shen/and
     (shen/cons\? V13621)
     (shen/and
      (shen/= 'bind
              (shen/hd V13621))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13621))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13621))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13621)))))))
    (list 'bind
          (shen/hd
           (nthcdr 1 V13621))
          (shen/shen\.insert_lazyderef
           (shen/hd
            (nthcdr 2 V13621)))))
   ((shen/and
     (shen/cons\? V13621)
     (shen/and
      (shen/= 'fwhen
              (shen/hd V13621))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13621))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13621))))))
    (list 'fwhen
          (shen/shen\.insert_lazyderef
           (shen/hd
            (nthcdr 1 V13621)))))
   ((shen/cons\? V13621)
    V13621)
   (shen/true
    (shen/shen\.f_error 'shen\.s-prolog_literal))))
(defun shen/shen\.insert_deref
    (V13623)
  (shen/cond
   ((shen/variable\? V13623)
    (list 'shen\.deref V13623 'ProcessN))
   ((shen/cons\? V13623)
    (append
     (list
      (shen/shen\.insert_deref
       (shen/hd V13623)))
     (shen/shen\.insert_deref
      (nthcdr 1 V13623))))
   (shen/true V13623)))
(defun shen/shen\.insert_lazyderef
    (V13625)
  (shen/cond
   ((shen/variable\? V13625)
    (list 'shen\.lazyderef V13625 'ProcessN))
   ((shen/cons\? V13625)
    (append
     (list
      (shen/shen\.insert_lazyderef
       (shen/hd V13625)))
     (shen/shen\.insert_lazyderef
      (nthcdr 1 V13625))))
   (shen/true V13625)))
(defun shen/shen\.group_clauses
    (V13627)
  (shen/cond
   ((shen/predicate->shen
     (null V13627))
    nil)
   ((shen/cons\? V13627)
    (shen/let Group
              (shen/shen\.collect
               (shen/lambda X
                            (shen/shen\.same_predicate\?
                             (shen/hd V13627)
                             X))
               V13627)
              (shen/let Rest
                        (shen/difference V13627 Group)
                        (append
                         (list Group)
                         (shen/shen\.group_clauses Rest)))))
   (shen/true
    (shen/shen\.f_error 'shen\.group_clauses))))
(defun shen/shen\.collect
    (V13632 V13633)
  (cl-flet
      ((tail-trampoline
        (V13632 V13633)
        (shen/cond
         ((shen/predicate->shen
           (null V13633))
          nil)
         ((shen/cons\? V13633)
          (shen/if
           (shen/internal/apply-higher-order-function V13632
                                                      (list
                                                       (shen/hd V13633)))
           (append
            (list
             (shen/hd V13633))
            (shen/shen\.collect V13632
                                (nthcdr 1 V13633)))
           (vector
            (list V13632
                  (nthcdr 1 V13633)))))
         (shen/true
          (shen/shen\.f_error 'shen\.collect)))))
    (let
        ((result
          (funcall #'tail-trampoline V13632 V13633)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.same_predicate\?
    (V13652 V13653)
  (shen/cond
   ((shen/and
     (shen/cons\? V13652)
     (shen/and
      (shen/cons\?
       (shen/hd V13652))
      (shen/and
       (shen/cons\? V13653)
       (shen/cons\?
        (shen/hd V13653)))))
    (shen/=
     (shen/hd
      (shen/hd V13652))
     (shen/hd
      (shen/hd V13653))))
   (shen/true
    (shen/shen\.f_error 'shen\.same_predicate\?))))
(defun shen/shen\.compile_prolog_procedure
    (V13655)
  (shen/let F
            (shen/shen\.procedure_name V13655)
            (shen/let Shen
                      (shen/shen\.clauses-to-shen F V13655)
                      Shen)))
(defun shen/shen\.procedure_name
    (V13669)
  (shen/cond
   ((shen/and
     (shen/cons\? V13669)
     (shen/and
      (shen/cons\?
       (shen/hd V13669))
      (shen/cons\?
       (shen/hd
        (shen/hd V13669)))))
    (shen/hd
     (shen/hd
      (shen/hd V13669))))
   (shen/true
    (shen/shen\.f_error 'shen\.procedure_name))))
(defun shen/shen\.clauses-to-shen
    (V13672 V13673)
  (shen/let Linear
            (shen/map
             (shen/lambda X
                          (shen/shen\.linearise-clause X))
             V13673)
            (shen/let Arity
                      (shen/shen\.prolog-aritycheck V13672
                                                    (shen/map
                                                     (shen/lambda X
                                                                  (shen/head X))
                                                     V13673))
                      (shen/let Parameters
                                (shen/shen\.parameters Arity)
                                (shen/let AUM_instructions
                                          (shen/map
                                           (shen/lambda X
                                                        (shen/shen\.aum X Parameters))
                                           Linear)
                                          (shen/let Code
                                                    (shen/shen\.catch-cut
                                                     (shen/shen\.nest-disjunct
                                                      (shen/map
                                                       (shen/lambda X
                                                                    (shen/shen\.aum_to_shen X))
                                                       AUM_instructions)))
                                                    (shen/let ShenDef
                                                              (append
                                                               (list 'define V13672)
                                                               (shen/append Parameters
                                                                            (shen/append
                                                                             (list 'ProcessN 'Continuation)
                                                                             (list '-> Code))))
                                                              ShenDef)))))))
(defun shen/shen\.catch-cut
    (V13675)
  (shen/cond
   ((shen/not
     (shen/shen\.occurs\? 'cut V13675))
    V13675)
   (shen/true
    (list 'let 'Throwcontrol
          (list 'shen\.catchpoint)
          (list 'shen\.cutpoint 'Throwcontrol V13675)))))
(defun shen/shen\.catchpoint nil
  (shen/set 'shen\.*catch*
            (1+
             (shen/value 'shen\.*catch*))))
(defun shen/shen\.cutpoint
    (V13683 V13684)
  (shen/cond
   ((shen/= V13684 V13683)
    'false)
   (shen/true V13684)))
(defun shen/shen\.nest-disjunct
    (V13686)
  (shen/cond
   ((shen/and
     (shen/cons\? V13686)
     (shen/predicate->shen
      (null
       (nthcdr 1 V13686))))
    (shen/hd V13686))
   ((shen/cons\? V13686)
    (shen/shen\.lisp-or
     (shen/hd V13686)
     (shen/shen\.nest-disjunct
      (nthcdr 1 V13686))))
   (shen/true
    (shen/shen\.f_error 'shen\.nest-disjunct))))
(defun shen/shen\.lisp-or
    (V13689 V13690)
  (list 'let 'Case V13689
        (list 'if
              (list '= 'Case 'false)
              V13690 'Case)))
(defun shen/shen\.prolog-aritycheck
    (V13695 V13696)
  (cl-flet
      ((tail-trampoline
        (V13695 V13696)
        (shen/cond
         ((shen/and
           (shen/cons\? V13696)
           (shen/predicate->shen
            (null
             (nthcdr 1 V13696))))
          (shen/-
           (shen/length
            (shen/hd V13696))
           1))
         ((shen/and
           (shen/cons\? V13696)
           (shen/cons\?
            (nthcdr 1 V13696)))
          (shen/if
           (shen/=
            (shen/length
             (shen/hd V13696))
            (shen/length
             (shen/hd
              (nthcdr 1 V13696))))
           (vector
            (list V13695
                  (nthcdr 1 V13696)))
           (shen/simple-error
            (shen/cn "arity error in prolog procedure "
                     (shen/shen\.app
                      (list V13695)
                      "\n" 'shen\.a)))))
         (shen/true
          (shen/shen\.f_error 'shen\.prolog-aritycheck)))))
    (let
        ((result
          (funcall #'tail-trampoline V13695 V13696)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.linearise-clause
    (V13698)
  (shen/cond
   ((shen/and
     (shen/cons\? V13698)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13698))
      (shen/and
       (shen/= ':-
               (shen/hd
                (nthcdr 1 V13698)))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13698))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13698)))))))
    (shen/let Linear
              (shen/shen\.linearise
               (append
                (list
                 (shen/hd V13698))
                (nthcdr 2 V13698)))
              (shen/shen\.clause_form Linear)))
   (shen/true
    (shen/shen\.f_error 'shen\.linearise-clause))))
(defun shen/shen\.clause_form
    (V13700)
  (shen/cond
   ((shen/and
     (shen/cons\? V13700)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13700))
      (shen/predicate->shen
       (null
        (nthcdr 2 V13700)))))
    (list
     (shen/shen\.explicit_modes
      (shen/hd V13700))
     ':-
     (shen/shen\.cf_help
      (shen/hd
       (nthcdr 1 V13700)))))
   (shen/true
    (shen/shen\.f_error 'shen\.clause_form))))
(defun shen/shen\.explicit_modes
    (V13702)
  (shen/cond
   ((shen/cons\? V13702)
    (append
     (list
      (shen/hd V13702))
     (shen/map
      (shen/lambda X
                   (shen/shen\.em_help X))
      (nthcdr 1 V13702))))
   (shen/true
    (shen/shen\.f_error 'shen\.explicit_modes))))
(defun shen/shen\.em_help
    (V13704)
  (shen/cond
   ((shen/and
     (shen/cons\? V13704)
     (shen/and
      (shen/= 'mode
              (shen/hd V13704))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13704))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13704))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13704)))))))
    V13704)
   (shen/true
    (list 'mode V13704 '+))))
(defun shen/shen\.cf_help
    (V13706)
  (shen/cond
   ((shen/and
     (shen/cons\? V13706)
     (shen/and
      (shen/= 'where
              (shen/hd V13706))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13706))
       (shen/and
        (shen/cons\?
         (shen/hd
          (nthcdr 1 V13706)))
        (shen/and
         (shen/= '=
                 (shen/hd
                  (shen/hd
                   (nthcdr 1 V13706))))
         (shen/and
          (shen/cons\?
           (nthcdr 1
                   (shen/hd
                    (nthcdr 1 V13706))))
          (shen/and
           (shen/cons\?
            (nthcdr 2
                    (shen/hd
                     (nthcdr 1 V13706))))
           (shen/and
            (shen/predicate->shen
             (null
              (nthcdr 3
                      (shen/hd
                       (nthcdr 1 V13706)))))
            (shen/and
             (shen/cons\?
              (nthcdr 2 V13706))
             (shen/predicate->shen
              (null
               (nthcdr 3 V13706))))))))))))
    (append
     (list
      (append
       (list
        (shen/if
         (shen/value 'shen\.*occurs*)
         'unify! 'unify))
       (nthcdr 1
               (shen/hd
                (nthcdr 1 V13706)))))
     (shen/shen\.cf_help
      (shen/hd
       (nthcdr 2 V13706)))))
   (shen/true V13706)))
(defun shen/occurs-check
    (V13712)
  (shen/cond
   ((shen/= '+ V13712)
    (shen/set 'shen\.*occurs* 'true))
   ((shen/= '- V13712)
    (shen/set 'shen\.*occurs* 'false))
   (shen/true
    (shen/simple-error "occurs-check expects + or -\n"))))
(defun shen/shen\.aum
    (V13715 V13716)
  (shen/cond
   ((shen/and
     (shen/cons\? V13715)
     (shen/and
      (shen/cons\?
       (shen/hd V13715))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13715))
       (shen/and
        (shen/= ':-
                (shen/hd
                 (nthcdr 1 V13715)))
        (shen/and
         (shen/cons\?
          (nthcdr 2 V13715))
         (shen/predicate->shen
          (null
           (nthcdr 3 V13715))))))))
    (shen/let MuApplication
              (shen/shen\.make_mu_application
               (list 'shen\.mu
                     (nthcdr 1
                             (shen/hd V13715))
                     (shen/shen\.continuation_call
                      (nthcdr 1
                              (shen/hd V13715))
                      (shen/hd
                       (nthcdr 2 V13715))))
               V13716)
              (shen/shen\.mu_reduction MuApplication '+)))
   (shen/true
    (shen/shen\.f_error 'shen\.aum))))
(defun shen/shen\.continuation_call
    (V13719 V13720)
  (shen/let VTerms
            (append
             (list 'ProcessN)
             (shen/shen\.extract_vars V13719))
            (shen/let VBody
                      (shen/shen\.extract_vars V13720)
                      (shen/let Free
                                (shen/remove 'Throwcontrol
                                             (shen/difference VBody VTerms))
                                (shen/shen\.cc_help Free V13720)))))
(defun shen/remove
    (V13723 V13724)
  (shen/shen\.remove-h V13723 V13724 nil))
(defun shen/shen\.remove-h
    (V13731 V13732 V13733)
  (cl-flet
      ((tail-trampoline
        (V13731 V13732 V13733)
        (shen/cond
         ((shen/predicate->shen
           (null V13732))
          (shen/reverse V13733))
         ((shen/and
           (shen/cons\? V13732)
           (shen/=
            (shen/hd V13732)
            V13731))
          (vector
           (list
            (shen/hd V13732)
            (nthcdr 1 V13732)
            V13733)))
         ((shen/cons\? V13732)
          (vector
           (list V13731
                 (nthcdr 1 V13732)
                 (append
                  (list
                   (shen/hd V13732))
                  V13733))))
         (shen/true
          (shen/shen\.f_error 'shen\.remove-h)))))
    (let
        ((result
          (funcall #'tail-trampoline V13731 V13732 V13733)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.cc_help
    (V13736 V13737)
  (shen/cond
   ((shen/and
     (shen/predicate->shen
      (null V13736))
     (shen/predicate->shen
      (null V13737)))
    (list 'shen\.pop 'shen\.the 'shen\.stack))
   ((shen/predicate->shen
     (null V13737))
    (list 'shen\.rename 'shen\.the 'shen\.variables 'in V13736 'and 'shen\.then
          (list 'shen\.pop 'shen\.the 'shen\.stack)))
   ((shen/predicate->shen
     (null V13736))
    (list 'call 'shen\.the 'shen\.continuation V13737))
   (shen/true
    (list 'shen\.rename 'shen\.the 'shen\.variables 'in V13736 'and 'shen\.then
          (list 'call 'shen\.the 'shen\.continuation V13737)))))
(defun shen/shen\.make_mu_application
    (V13740 V13741)
  (shen/cond
   ((shen/and
     (shen/cons\? V13740)
     (shen/and
      (shen/= 'shen\.mu
              (shen/hd V13740))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13740))
       (shen/and
        (shen/predicate->shen
         (null
          (shen/hd
           (nthcdr 1 V13740))))
        (shen/and
         (shen/cons\?
          (nthcdr 2 V13740))
         (shen/and
          (shen/predicate->shen
           (null
            (nthcdr 3 V13740)))
          (shen/predicate->shen
           (null V13741))))))))
    (shen/hd
     (nthcdr 2 V13740)))
   ((shen/and
     (shen/cons\? V13740)
     (shen/and
      (shen/= 'shen\.mu
              (shen/hd V13740))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13740))
       (shen/and
        (shen/cons\?
         (shen/hd
          (nthcdr 1 V13740)))
        (shen/and
         (shen/cons\?
          (nthcdr 2 V13740))
         (shen/and
          (shen/predicate->shen
           (null
            (nthcdr 3 V13740)))
          (shen/cons\? V13741)))))))
    (list
     (list 'shen\.mu
           (shen/hd
            (shen/hd
             (nthcdr 1 V13740)))
           (shen/shen\.make_mu_application
            (append
             (list 'shen\.mu
                   (nthcdr 1
                           (shen/hd
                            (nthcdr 1 V13740))))
             (nthcdr 2 V13740))
            (nthcdr 1 V13741)))
     (shen/hd V13741)))
   (shen/true
    (shen/shen\.f_error 'shen\.make_mu_application))))
(defun shen/shen\.mu_reduction
    (V13750 V13751)
  (cl-flet
      ((tail-trampoline
        (V13750 V13751)
        (shen/cond
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13750))))
               (shen/and
                (shen/= 'mode
                        (shen/hd
                         (shen/hd
                          (nthcdr 1
                                  (shen/hd V13750)))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13750)))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 2
                           (shen/hd
                            (nthcdr 1
                                    (shen/hd V13750)))))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 3
                             (shen/hd
                              (nthcdr 1
                                      (shen/hd V13750))))))
                   (shen/and
                    (shen/cons\?
                     (nthcdr 2
                             (shen/hd V13750)))
                    (shen/and
                     (shen/predicate->shen
                      (null
                       (nthcdr 3
                               (shen/hd V13750))))
                     (shen/and
                      (shen/cons\?
                       (nthcdr 1 V13750))
                      (shen/predicate->shen
                       (null
                        (nthcdr 2 V13750)))))))))))))))
          (vector
           (list
            (append
             (list
              (append
               (list 'shen\.mu
                     (shen/hd
                      (nthcdr 1
                              (shen/hd
                               (nthcdr 1
                                       (shen/hd V13750))))))
               (nthcdr 2
                       (shen/hd V13750))))
             (nthcdr 1 V13750))
            (shen/hd
             (nthcdr 2
                     (shen/hd
                      (nthcdr 1
                              (shen/hd V13750))))))))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13750)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13750))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13750))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 2 V13750)))
                  (shen/= '_
                          (shen/hd
                           (nthcdr 1
                                   (shen/hd V13750))))))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 2
                     (shen/hd V13750)))
            V13751)))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13750)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13750))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13750))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 2 V13750)))
                  (shen/shen\.ephemeral_variable\?
                   (shen/hd
                    (nthcdr 1
                            (shen/hd V13750)))
                   (shen/hd
                    (nthcdr 1 V13750)))))))))))
          (shen/subst
           (shen/hd
            (nthcdr 1 V13750))
           (shen/hd
            (nthcdr 1
                    (shen/hd V13750)))
           (shen/shen\.mu_reduction
            (shen/hd
             (nthcdr 2
                     (shen/hd V13750)))
            V13751)))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13750)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13750))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13750))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 2 V13750)))
                  (shen/variable\?
                   (shen/hd
                    (nthcdr 1
                            (shen/hd V13750))))))))))))
          (list 'let
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13750)))
                'shen\.be
                (shen/hd
                 (nthcdr 1 V13750))
                'in
                (shen/shen\.mu_reduction
                 (shen/hd
                  (nthcdr 2
                          (shen/hd V13750)))
                 V13751)))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13750)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13750))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13750))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 2 V13750)))
                  (shen/and
                   (shen/= '- V13751)
                   (shen/shen\.prolog_constant\?
                    (shen/hd
                     (nthcdr 1
                             (shen/hd V13750)))))))))))))
          (shen/let Z
                    (shen/gensym 'V)
                    (list 'let Z 'shen\.be
                          (append
                           (list 'shen\.the 'shen\.result 'shen\.of 'shen\.dereferencing)
                           (nthcdr 1 V13750))
                          'in
                          (list 'if
                                (list Z 'is 'identical 'shen\.to
                                      (shen/hd
                                       (nthcdr 1
                                               (shen/hd V13750))))
                                'shen\.then
                                (shen/shen\.mu_reduction
                                 (shen/hd
                                  (nthcdr 2
                                          (shen/hd V13750)))
                                 '-)
                                'shen\.else 'shen\.failed!))))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (nthcdr 2
                        (shen/hd V13750)))
               (shen/and
                (shen/predicate->shen
                 (null
                  (nthcdr 3
                          (shen/hd V13750))))
                (shen/and
                 (shen/cons\?
                  (nthcdr 1 V13750))
                 (shen/and
                  (shen/predicate->shen
                   (null
                    (nthcdr 2 V13750)))
                  (shen/and
                   (shen/= '+ V13751)
                   (shen/shen\.prolog_constant\?
                    (shen/hd
                     (nthcdr 1
                             (shen/hd V13750)))))))))))))
          (shen/let Z
                    (shen/gensym 'V)
                    (list 'let Z 'shen\.be
                          (append
                           (list 'shen\.the 'shen\.result 'shen\.of 'shen\.dereferencing)
                           (nthcdr 1 V13750))
                          'in
                          (list 'if
                                (list Z 'is 'identical 'shen\.to
                                      (shen/hd
                                       (nthcdr 1
                                               (shen/hd V13750))))
                                'shen\.then
                                (shen/shen\.mu_reduction
                                 (shen/hd
                                  (nthcdr 2
                                          (shen/hd V13750)))
                                 '+)
                                'shen\.else
                                (list 'if
                                      (list Z 'is 'shen\.a 'shen\.variable)
                                      'shen\.then
                                      (list 'bind Z 'shen\.to
                                            (shen/hd
                                             (nthcdr 1
                                                     (shen/hd V13750)))
                                            'in
                                            (shen/shen\.mu_reduction
                                             (shen/hd
                                              (nthcdr 2
                                                      (shen/hd V13750)))
                                             '+))
                                      'shen\.else 'shen\.failed!)))))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13750))))
               (shen/and
                (shen/cons\?
                 (nthcdr 2
                         (shen/hd V13750)))
                (shen/and
                 (shen/predicate->shen
                  (null
                   (nthcdr 3
                           (shen/hd V13750))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 1 V13750))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 2 V13750)))
                   (shen/= '- V13751))))))))))
          (shen/let Z
                    (shen/gensym 'V)
                    (list 'let Z 'shen\.be
                          (append
                           (list 'shen\.the 'shen\.result 'shen\.of 'shen\.dereferencing)
                           (nthcdr 1 V13750))
                          'in
                          (list 'if
                                (list Z 'is 'shen\.a 'shen\.non-empty 'list)
                                'shen\.then
                                (shen/shen\.mu_reduction
                                 (list
                                  (list 'shen\.mu
                                        (shen/hd
                                         (shen/hd
                                          (nthcdr 1
                                                  (shen/hd V13750))))
                                        (list
                                         (append
                                          (list 'shen\.mu
                                                (nthcdr 1
                                                        (shen/hd
                                                         (nthcdr 1
                                                                 (shen/hd V13750)))))
                                          (nthcdr 2
                                                  (shen/hd V13750)))
                                         (list 'shen\.the 'tail 'shen\.of Z)))
                                  (list 'shen\.the 'head 'shen\.of Z))
                                 '-)
                                'shen\.else 'shen\.failed!))))
         ((shen/and
           (shen/cons\? V13750)
           (shen/and
            (shen/cons\?
             (shen/hd V13750))
            (shen/and
             (shen/= 'shen\.mu
                     (shen/hd
                      (shen/hd V13750)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13750)))
              (shen/and
               (shen/cons\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd V13750))))
               (shen/and
                (shen/cons\?
                 (nthcdr 2
                         (shen/hd V13750)))
                (shen/and
                 (shen/predicate->shen
                  (null
                   (nthcdr 3
                           (shen/hd V13750))))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 1 V13750))
                  (shen/and
                   (shen/predicate->shen
                    (null
                     (nthcdr 2 V13750)))
                   (shen/= '+ V13751))))))))))
          (shen/let Z
                    (shen/gensym 'V)
                    (list 'let Z 'shen\.be
                          (append
                           (list 'shen\.the 'shen\.result 'shen\.of 'shen\.dereferencing)
                           (nthcdr 1 V13750))
                          'in
                          (list 'if
                                (list Z 'is 'shen\.a 'shen\.non-empty 'list)
                                'shen\.then
                                (shen/shen\.mu_reduction
                                 (list
                                  (list 'shen\.mu
                                        (shen/hd
                                         (shen/hd
                                          (nthcdr 1
                                                  (shen/hd V13750))))
                                        (list
                                         (append
                                          (list 'shen\.mu
                                                (nthcdr 1
                                                        (shen/hd
                                                         (nthcdr 1
                                                                 (shen/hd V13750)))))
                                          (nthcdr 2
                                                  (shen/hd V13750)))
                                         (list 'shen\.the 'tail 'shen\.of Z)))
                                  (list 'shen\.the 'head 'shen\.of Z))
                                 '+)
                                'shen\.else
                                (list 'if
                                      (list Z 'is 'shen\.a 'shen\.variable)
                                      'shen\.then
                                      (list 'shen\.rename 'shen\.the 'shen\.variables 'in
                                            (shen/shen\.extract_vars
                                             (shen/hd
                                              (nthcdr 1
                                                      (shen/hd V13750))))
                                            'and 'shen\.then
                                            (list 'bind Z 'shen\.to
                                                  (shen/shen\.rcons_form
                                                   (shen/shen\.remove_modes
                                                    (shen/hd
                                                     (nthcdr 1
                                                             (shen/hd V13750)))))
                                                  'in
                                                  (shen/shen\.mu_reduction
                                                   (shen/hd
                                                    (nthcdr 2
                                                            (shen/hd V13750)))
                                                   '+)))
                                      'shen\.else 'shen\.failed!)))))
         (shen/true V13750))))
    (let
        ((result
          (funcall #'tail-trampoline V13750 V13751)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.rcons_form
    (V13753)
  (shen/cond
   ((shen/cons\? V13753)
    (list 'cons
          (shen/shen\.rcons_form
           (shen/hd V13753))
          (shen/shen\.rcons_form
           (nthcdr 1 V13753))))
   (shen/true V13753)))
(defun shen/shen\.remove_modes
    (V13755)
  (cl-flet
      ((tail-trampoline
        (V13755)
        (shen/cond
         ((shen/and
           (shen/cons\? V13755)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13755))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13755))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13755))
              (shen/and
               (shen/= '+
                       (shen/hd
                        (nthcdr 2 V13755)))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13755))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 1 V13755)))))
         ((shen/and
           (shen/cons\? V13755)
           (shen/and
            (shen/= 'mode
                    (shen/hd V13755))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13755))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13755))
              (shen/and
               (shen/= '-
                       (shen/hd
                        (nthcdr 2 V13755)))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13755))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 1 V13755)))))
         ((shen/cons\? V13755)
          (append
           (list
            (shen/shen\.remove_modes
             (shen/hd V13755)))
           (shen/shen\.remove_modes
            (nthcdr 1 V13755))))
         (shen/true V13755))))
    (let
        ((result
          (funcall #'tail-trampoline V13755)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.ephemeral_variable\?
    (V13758 V13759)
  (shen/and
   (shen/variable\? V13758)
   (shen/variable\? V13759)))
(defun shen/shen\.prolog_constant\?
    (V13769)
  (shen/cond
   ((shen/cons\? V13769)
    'false)
   (shen/true 'true)))
(defun shen/shen\.aum_to_shen
    (V13771)
  (cl-flet
      ((tail-trampoline
        (V13771)
        (shen/cond
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'let
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13771))
              (shen/and
               (shen/= 'shen\.be
                       (shen/hd
                        (nthcdr 2 V13771)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V13771))
                (shen/and
                 (shen/cons\?
                  (nthcdr 4 V13771))
                 (shen/and
                  (shen/= 'in
                          (shen/hd
                           (nthcdr 4 V13771)))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 5 V13771))
                   (shen/predicate->shen
                    (null
                     (nthcdr 6 V13771))))))))))))
          (list 'let
                (shen/hd
                 (nthcdr 1 V13771))
                (shen/shen\.aum_to_shen
                 (shen/hd
                  (nthcdr 3 V13771)))
                (shen/shen\.aum_to_shen
                 (shen/hd
                  (nthcdr 5 V13771)))))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'shen\.the
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'shen\.result
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.of
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 3 V13771))
                 (shen/and
                  (shen/= 'shen\.dereferencing
                          (shen/hd
                           (nthcdr 3 V13771)))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 4 V13771))
                   (shen/predicate->shen
                    (null
                     (nthcdr 5 V13771))))))))))))
          (list 'shen\.lazyderef
                (shen/shen\.aum_to_shen
                 (shen/hd
                  (nthcdr 4 V13771)))
                'ProcessN))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'if
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13771))
              (shen/and
               (shen/= 'shen\.then
                       (shen/hd
                        (nthcdr 2 V13771)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V13771))
                (shen/and
                 (shen/cons\?
                  (nthcdr 4 V13771))
                 (shen/and
                  (shen/= 'shen\.else
                          (shen/hd
                           (nthcdr 4 V13771)))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 5 V13771))
                   (shen/predicate->shen
                    (null
                     (nthcdr 6 V13771))))))))))))
          (list 'if
                (shen/shen\.aum_to_shen
                 (shen/hd
                  (nthcdr 1 V13771)))
                (shen/shen\.aum_to_shen
                 (shen/hd
                  (nthcdr 3 V13771)))
                (shen/shen\.aum_to_shen
                 (shen/hd
                  (nthcdr 5 V13771)))))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13771))
            (shen/and
             (shen/= 'is
                     (shen/hd
                      (nthcdr 1 V13771)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13771))
              (shen/and
               (shen/= 'shen\.a
                       (shen/hd
                        (nthcdr 2 V13771)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V13771))
                (shen/and
                 (shen/= 'shen\.variable
                         (shen/hd
                          (nthcdr 3 V13771)))
                 (shen/predicate->shen
                  (null
                   (nthcdr 4 V13771))))))))))
          (list 'shen\.pvar\?
                (shen/hd V13771)))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13771))
            (shen/and
             (shen/= 'is
                     (shen/hd
                      (nthcdr 1 V13771)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13771))
              (shen/and
               (shen/= 'shen\.a
                       (shen/hd
                        (nthcdr 2 V13771)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V13771))
                (shen/and
                 (shen/= 'shen\.non-empty
                         (shen/hd
                          (nthcdr 3 V13771)))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 4 V13771))
                  (shen/and
                   (shen/= 'list
                           (shen/hd
                            (nthcdr 4 V13771)))
                   (shen/predicate->shen
                    (null
                     (nthcdr 5 V13771))))))))))))
          (list 'cons\?
                (shen/hd V13771)))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'shen\.rename
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'shen\.the
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.variables
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 3 V13771))
                 (shen/and
                  (shen/= 'in
                          (shen/hd
                           (nthcdr 3 V13771)))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 4 V13771))
                   (shen/and
                    (shen/predicate->shen
                     (null
                      (shen/hd
                       (nthcdr 4 V13771))))
                    (shen/and
                     (shen/cons\?
                      (nthcdr 5 V13771))
                     (shen/and
                      (shen/= 'and
                              (shen/hd
                               (nthcdr 5 V13771)))
                      (shen/and
                       (shen/cons\?
                        (nthcdr 6 V13771))
                       (shen/and
                        (shen/= 'shen\.then
                                (shen/hd
                                 (nthcdr 6 V13771)))
                        (shen/and
                         (shen/cons\?
                          (nthcdr 7 V13771))
                         (shen/predicate->shen
                          (null
                           (nthcdr 8 V13771))))))))))))))))))
          (vector
           (list
            (shen/hd
             (nthcdr 7 V13771)))))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'shen\.rename
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'shen\.the
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.variables
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 3 V13771))
                 (shen/and
                  (shen/= 'in
                          (shen/hd
                           (nthcdr 3 V13771)))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 4 V13771))
                   (shen/and
                    (shen/cons\?
                     (shen/hd
                      (nthcdr 4 V13771)))
                    (shen/and
                     (shen/cons\?
                      (nthcdr 5 V13771))
                     (shen/and
                      (shen/= 'and
                              (shen/hd
                               (nthcdr 5 V13771)))
                      (shen/and
                       (shen/cons\?
                        (nthcdr 6 V13771))
                       (shen/and
                        (shen/= 'shen\.then
                                (shen/hd
                                 (nthcdr 6 V13771)))
                        (shen/and
                         (shen/cons\?
                          (nthcdr 7 V13771))
                         (shen/predicate->shen
                          (null
                           (nthcdr 8 V13771))))))))))))))))))
          (list 'let
                (shen/hd
                 (shen/hd
                  (nthcdr 4 V13771)))
                (list 'shen\.newpv 'ProcessN)
                (shen/shen\.aum_to_shen
                 (append
                  (list 'shen\.rename 'shen\.the 'shen\.variables 'in
                        (nthcdr 1
                                (shen/hd
                                 (nthcdr 4 V13771))))
                  (nthcdr 5 V13771)))))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'bind
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13771))
              (shen/and
               (shen/= 'shen\.to
                       (shen/hd
                        (nthcdr 2 V13771)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V13771))
                (shen/and
                 (shen/cons\?
                  (nthcdr 4 V13771))
                 (shen/and
                  (shen/= 'in
                          (shen/hd
                           (nthcdr 4 V13771)))
                  (shen/and
                   (shen/cons\?
                    (nthcdr 5 V13771))
                   (shen/predicate->shen
                    (null
                     (nthcdr 6 V13771))))))))))))
          (list 'do
                (list 'shen\.bindv
                      (shen/hd
                       (nthcdr 1 V13771))
                      (shen/shen\.chwild
                       (shen/hd
                        (nthcdr 3 V13771)))
                      'ProcessN)
                (list 'let 'Result
                      (shen/shen\.aum_to_shen
                       (shen/hd
                        (nthcdr 5 V13771)))
                      (list 'do
                            (list 'shen\.unbindv
                                  (shen/hd
                                   (nthcdr 1 V13771))
                                  'ProcessN)
                            'Result))))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V13771))
            (shen/and
             (shen/= 'is
                     (shen/hd
                      (nthcdr 1 V13771)))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13771))
              (shen/and
               (shen/= 'identical
                       (shen/hd
                        (nthcdr 2 V13771)))
               (shen/and
                (shen/cons\?
                 (nthcdr 3 V13771))
                (shen/and
                 (shen/= 'shen\.to
                         (shen/hd
                          (nthcdr 3 V13771)))
                 (shen/and
                  (shen/cons\?
                   (nthcdr 4 V13771))
                  (shen/predicate->shen
                   (null
                    (nthcdr 5 V13771)))))))))))
          (list '=
                (shen/hd
                 (nthcdr 4 V13771))
                (shen/hd V13771)))
         ((shen/= 'shen\.failed! V13771)
          'false)
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'shen\.the
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'head
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.of
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 3 V13771))
                 (shen/predicate->shen
                  (null
                   (nthcdr 4 V13771))))))))))
          (append
           (list 'hd)
           (nthcdr 3 V13771)))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'shen\.the
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'tail
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.of
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 3 V13771))
                 (shen/predicate->shen
                  (null
                   (nthcdr 4 V13771))))))))))
          (append
           (list 'tl)
           (nthcdr 3 V13771)))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'shen\.pop
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'shen\.the
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.stack
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/predicate->shen
                 (null
                  (nthcdr 3 V13771)))))))))
          (list 'do
                (list 'shen\.incinfs)
                (list 'thaw 'Continuation)))
         ((shen/and
           (shen/cons\? V13771)
           (shen/and
            (shen/= 'call
                    (shen/hd V13771))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13771))
             (shen/and
              (shen/= 'shen\.the
                      (shen/hd
                       (nthcdr 1 V13771)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V13771))
               (shen/and
                (shen/= 'shen\.continuation
                        (shen/hd
                         (nthcdr 2 V13771)))
                (shen/and
                 (shen/cons\?
                  (nthcdr 3 V13771))
                 (shen/predicate->shen
                  (null
                   (nthcdr 4 V13771))))))))))
          (list 'do
                (list 'shen\.incinfs)
                (shen/shen\.call_the_continuation
                 (shen/shen\.chwild
                  (shen/hd
                   (nthcdr 3 V13771)))
                 'ProcessN 'Continuation)))
         (shen/true V13771))))
    (let
        ((result
          (funcall #'tail-trampoline V13771)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.chwild
    (V13773)
  (shen/cond
   ((shen/= V13773 '_)
    (list 'shen\.newpv 'ProcessN))
   ((shen/cons\? V13773)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.chwild Z))
     V13773))
   (shen/true V13773)))
(defun shen/shen\.newpv
    (V13775)
  (shen/let Count+1
            (1+
             (shen/<-address
              (shen/value 'shen\.*varcounter*)
              V13775))
            (shen/let IncVar
                      (shen/address->
                       (shen/value 'shen\.*varcounter*)
                       V13775 Count+1)
                      (shen/let Vector
                                (shen/<-address
                                 (shen/value 'shen\.*prologvectors*)
                                 V13775)
                                (shen/let ResizeVectorIfNeeded
                                          (shen/if
                                           (shen/= Count+1
                                                   (shen/limit Vector))
                                           (shen/shen\.resizeprocessvector V13775 Count+1)
                                           'shen\.skip)
                                          (shen/shen\.mk-pvar Count+1))))))
(defun shen/shen\.resizeprocessvector
    (V13778 V13779)
  (shen/let Vector
            (shen/<-address
             (shen/value 'shen\.*prologvectors*)
             V13778)
            (shen/let BigVector
                      (shen/shen\.resize-vector Vector
                                                (shen/+ V13779 V13779)
                                                'shen\.-null-)
                      (shen/address->
                       (shen/value 'shen\.*prologvectors*)
                       V13778 BigVector))))
(defun shen/shen\.resize-vector
    (Vector NewSize Fill)
  (let*
      ((VectorLimit
        (shen/<-address Vector 0))
       (Current-Index
        (1+ VectorLimit)))
    (puthash 0 NewSize Vector)
    (while
        (<= Current-Index NewSize)
      (puthash Current-Index Fill Vector)
      (setq Current-Index
            (1+ Current-Index)))
    Vector))
(defun shen/shen\.copy-vector
    (V13791 V13792 V13793 V13794 V13795)
  (shen/shen\.copy-vector-stage-2
   (1+ V13793)
   (1+ V13794)
   V13795
   (shen/shen\.copy-vector-stage-1 1 V13791 V13792
                                   (1+ V13793))))
(defun shen/shen\.copy-vector-stage-1
    (V13803 V13804 V13805 V13806)
  (cl-flet
      ((tail-trampoline
        (V13803 V13804 V13805 V13806)
        (shen/cond
         ((shen/= V13806 V13803)
          V13805)
         (shen/true
          (vector
           (list
            (1+ V13803)
            V13804
            (shen/address-> V13805 V13803
                            (shen/<-address V13804 V13803))
            V13806))))))
    (let
        ((result
          (funcall #'tail-trampoline V13803 V13804 V13805 V13806)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.copy-vector-stage-2
    (V13814 V13815 V13816 V13817)
  (cl-flet
      ((tail-trampoline
        (V13814 V13815 V13816 V13817)
        (shen/cond
         ((shen/= V13815 V13814)
          V13817)
         (shen/true
          (vector
           (list
            (1+ V13814)
            V13815 V13816
            (shen/address-> V13817 V13814 V13816)))))))
    (let
        ((result
          (funcall #'tail-trampoline V13814 V13815 V13816 V13817)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.mk-pvar
    (V13819)
  (shen/address->
   (shen/address->
    (shen/absvector 2)
    0 'shen\.pvar)
   1 V13819))
(defun shen/shen\.pvar\?
    (V13821)
  (shen/trap-error
   (shen/and
    (shen/absvector\? V13821)
    (shen/=
     (shen/<-address V13821 0)
     'shen\.pvar))
   (shen/lambda E 'false)))
(defun shen/shen\.bindv
    (V13825 V13826 V13827)
  (shen/let Vector
            (shen/<-address
             (shen/value 'shen\.*prologvectors*)
             V13827)
            (shen/address-> Vector
                            (shen/<-address V13825 1)
                            V13826)))
(defun shen/shen\.unbindv
    (V13830 V13831)
  (shen/let Vector
            (shen/<-address
             (shen/value 'shen\.*prologvectors*)
             V13831)
            (shen/address-> Vector
                            (shen/<-address V13830 1)
                            'shen\.-null-)))
(defun shen/shen\.incinfs nil
  (shen/set 'shen\.*infs*
            (1+
             (shen/value 'shen\.*infs*))))
(defun shen/shen\.call_the_continuation
    (V13835 V13836 V13837)
  (shen/cond
   ((shen/and
     (shen/cons\? V13835)
     (shen/and
      (shen/cons\?
       (shen/hd V13835))
      (shen/predicate->shen
       (null
        (nthcdr 1 V13835)))))
    (append
     (list
      (shen/hd
       (shen/hd V13835)))
     (shen/append
      (nthcdr 1
              (shen/hd V13835))
      (list V13836 V13837))))
   ((shen/and
     (shen/cons\? V13835)
     (shen/cons\?
      (shen/hd V13835)))
    (shen/let NewContinuation
              (shen/shen\.newcontinuation
               (nthcdr 1 V13835)
               V13836 V13837)
              (append
               (list
                (shen/hd
                 (shen/hd V13835)))
               (shen/append
                (nthcdr 1
                        (shen/hd V13835))
                (list V13836 NewContinuation)))))
   (shen/true
    (shen/shen\.f_error 'shen\.call_the_continuation))))
(defun shen/shen\.newcontinuation
    (V13841 V13842 V13843)
  (shen/cond
   ((shen/predicate->shen
     (null V13841))
    V13843)
   ((shen/and
     (shen/cons\? V13841)
     (shen/cons\?
      (shen/hd V13841)))
    (list 'freeze
          (append
           (list
            (shen/hd
             (shen/hd V13841)))
           (shen/append
            (nthcdr 1
                    (shen/hd V13841))
            (list V13842
                  (shen/shen\.newcontinuation
                   (nthcdr 1 V13841)
                   V13842 V13843))))))
   (shen/true
    (shen/shen\.f_error 'shen\.newcontinuation))))
(defun shen/return
    (V13851 V13852 V13853)
  (shen/shen\.deref V13851 V13852))
(defun shen/shen\.measure&return
    (V13861 V13862 V13863)
  (shen/do
   (shen/shen\.prhush
    (shen/shen\.app
     (shen/value 'shen\.*infs*)
     " inferences\n" 'shen\.a)
    (shen/stoutput))
   (shen/shen\.deref V13861 V13862)))
(defun shen/unify
    (V13868 V13869 V13870 V13871)
  (shen/shen\.lzy=
   (shen/shen\.lazyderef V13868 V13870)
   (shen/shen\.lazyderef V13869 V13870)
   V13870 V13871))
(defun shen/shen\.lzy=
    (V13893 V13894 V13895 V13896)
  (cl-flet
      ((tail-trampoline
        (V13893 V13894 V13895 V13896)
        (shen/cond
         ((shen/= V13894 V13893)
          (shen/thaw V13896))
         ((shen/shen\.pvar\? V13893)
          (shen/bind V13893 V13894 V13895 V13896))
         ((shen/shen\.pvar\? V13894)
          (shen/bind V13894 V13893 V13895 V13896))
         ((shen/and
           (shen/cons\? V13893)
           (shen/cons\? V13894))
          (vector
           (list
            (shen/shen\.lazyderef
             (shen/hd V13893)
             V13895)
            (shen/shen\.lazyderef
             (shen/hd V13894)
             V13895)
            V13895
            (shen/freeze
             (shen/shen\.lzy=
              (shen/shen\.lazyderef
               (nthcdr 1 V13893)
               V13895)
              (shen/shen\.lazyderef
               (nthcdr 1 V13894)
               V13895)
              V13895 V13896)))))
         (shen/true 'false))))
    (let
        ((result
          (funcall #'tail-trampoline V13893 V13894 V13895 V13896)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.deref
    (V13899 V13900)
  (cl-flet
      ((tail-trampoline
        (V13899 V13900)
        (shen/cond
         ((shen/cons\? V13899)
          (append
           (list
            (shen/shen\.deref
             (shen/hd V13899)
             V13900))
           (shen/shen\.deref
            (nthcdr 1 V13899)
            V13900)))
         (shen/true
          (shen/if
           (shen/shen\.pvar\? V13899)
           (shen/let Value
                     (shen/shen\.valvector V13899 V13900)
                     (shen/if
                      (shen/= Value 'shen\.-null-)
                      V13899
                      (vector
                       (list Value V13900))))
           V13899)))))
    (let
        ((result
          (funcall #'tail-trampoline V13899 V13900)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.lazyderef
    (X ProcessN)
  (let
      ((Current X)
       (KeepLooking 't))
    (while KeepLooking
      (shen/if
       (shen/shen\.pvar\? Current)
       (shen/let Value
                 (shen/shen\.valvector Current ProcessN)
                 (shen/if
                  (shen/= Value 'shen\.-null-)
                  (setq KeepLooking nil)
                  (setq Current Value)))
       (setq KeepLooking nil)))
    Current))
(defun shen/shen\.valvector
    (V13907 V13908)
  (shen/<-address
   (shen/<-address
    (shen/value 'shen\.*prologvectors*)
    V13908)
   (shen/<-address V13907 1)))
(defun shen/unify!
    (V13913 V13914 V13915 V13916)
  (shen/shen\.lzy=!
   (shen/shen\.lazyderef V13913 V13915)
   (shen/shen\.lazyderef V13914 V13915)
   V13915 V13916))
(defun shen/shen\.lzy=!
    (V13938 V13939 V13940 V13941)
  (cl-flet
      ((tail-trampoline
        (V13938 V13939 V13940 V13941)
        (shen/cond
         ((shen/= V13939 V13938)
          (shen/thaw V13941))
         ((shen/and
           (shen/shen\.pvar\? V13938)
           (shen/not
            (shen/shen\.occurs\? V13938
                                 (shen/shen\.deref V13939 V13940))))
          (shen/bind V13938 V13939 V13940 V13941))
         ((shen/and
           (shen/shen\.pvar\? V13939)
           (shen/not
            (shen/shen\.occurs\? V13939
                                 (shen/shen\.deref V13938 V13940))))
          (shen/bind V13939 V13938 V13940 V13941))
         ((shen/and
           (shen/cons\? V13938)
           (shen/cons\? V13939))
          (vector
           (list
            (shen/shen\.lazyderef
             (shen/hd V13938)
             V13940)
            (shen/shen\.lazyderef
             (shen/hd V13939)
             V13940)
            V13940
            (shen/freeze
             (shen/shen\.lzy=!
              (shen/shen\.lazyderef
               (nthcdr 1 V13938)
               V13940)
              (shen/shen\.lazyderef
               (nthcdr 1 V13939)
               V13940)
              V13940 V13941)))))
         (shen/true 'false))))
    (let
        ((result
          (funcall #'tail-trampoline V13938 V13939 V13940 V13941)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.occurs\?
    (V13953 V13954)
  (shen/cond
   ((shen/= V13954 V13953)
    'true)
   ((shen/cons\? V13954)
    (shen/or
     (shen/shen\.occurs\? V13953
                          (shen/hd V13954))
     (shen/shen\.occurs\? V13953
                          (nthcdr 1 V13954))))
   (shen/true 'false)))
(defun shen/identical
    (V13959 V13960 V13961 V13962)
  (shen/shen\.lzy==
   (shen/shen\.lazyderef V13959 V13961)
   (shen/shen\.lazyderef V13960 V13961)
   V13961 V13962))
(defun shen/shen\.lzy==
    (V13984 V13985 V13986 V13987)
  (cl-flet
      ((tail-trampoline
        (V13984 V13985 V13986 V13987)
        (shen/cond
         ((shen/= V13985 V13984)
          (shen/thaw V13987))
         ((shen/and
           (shen/cons\? V13984)
           (shen/cons\? V13985))
          (vector
           (list
            (shen/shen\.lazyderef
             (shen/hd V13984)
             V13986)
            (shen/shen\.lazyderef
             (shen/hd V13985)
             V13986)
            V13986
            (shen/freeze
             (shen/shen\.lzy==
              (nthcdr 1 V13984)
              (nthcdr 1 V13985)
              V13986 V13987)))))
         (shen/true 'false))))
    (let
        ((result
          (funcall #'tail-trampoline V13984 V13985 V13986 V13987)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.pvar
    (V13989)
  (shen/cn "Var"
           (shen/shen\.app
            (shen/<-address V13989 1)
            "" 'shen\.a)))
(defun shen/bind
    (V13994 V13995 V13996 V13997)
  (shen/do
   (shen/shen\.bindv V13994 V13995 V13996)
   (shen/let Result
             (shen/thaw V13997)
             (shen/do
              (shen/shen\.unbindv V13994 V13996)
              Result))))
(defun shen/fwhen
    (V14015 V14016 V14017)
  (shen/cond
   ((shen/= 'true V14015)
    (shen/thaw V14017))
   ((shen/= 'false V14015)
    'false)
   (shen/true
    (shen/simple-error
     (shen/cn "fwhen expects a boolean: not "
              (shen/shen\.app V14015 "%" 'shen\.s))))))
(defun shen/call
    (V14033 V14034 V14035)
  (shen/cond
   ((shen/cons\? V14033)
    (shen/shen\.call-help
     (shen/function
      (shen/shen\.lazyderef
       (shen/hd V14033)
       V14034))
     (nthcdr 1 V14033)
     V14034 V14035))
   (shen/true 'false)))
(defun shen/shen\.call-help
    (V14040 V14041 V14042 V14043)
  (cl-flet
      ((tail-trampoline
        (V14040 V14041 V14042 V14043)
        (shen/cond
         ((shen/predicate->shen
           (null V14041))
          (shen/internal/apply-higher-order-function V14040
                                                     (list V14042 V14043)))
         ((shen/cons\? V14041)
          (vector
           (list
            (shen/internal/apply-higher-order-function V14040
                                                       (list
                                                        (shen/hd V14041)))
            (nthcdr 1 V14041)
            V14042 V14043)))
         (shen/true
          (shen/shen\.f_error 'shen\.call-help)))))
    (let
        ((result
          (funcall #'tail-trampoline V14040 V14041 V14042 V14043)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.intprolog
    (V14045)
  (shen/cond
   ((shen/and
     (shen/cons\? V14045)
     (shen/cons\?
      (shen/hd V14045)))
    (shen/let ProcessN
              (shen/shen\.start-new-prolog-process)
              (shen/shen\.intprolog-help
               (shen/hd
                (shen/hd V14045))
               (shen/shen\.insert-prolog-variables
                (list
                 (nthcdr 1
                         (shen/hd V14045))
                 (nthcdr 1 V14045))
                ProcessN)
               ProcessN)))
   (shen/true
    (shen/shen\.f_error 'shen\.intprolog))))
(defun shen/shen\.intprolog-help
    (V14049 V14050 V14051)
  (shen/cond
   ((shen/and
     (shen/cons\? V14050)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V14050))
      (shen/predicate->shen
       (null
        (nthcdr 2 V14050)))))
    (shen/shen\.intprolog-help-help V14049
                                    (shen/hd V14050)
                                    (shen/hd
                                     (nthcdr 1 V14050))
                                    V14051))
   (shen/true
    (shen/shen\.f_error 'shen\.intprolog-help))))
(defun shen/shen\.intprolog-help-help
    (V14056 V14057 V14058 V14059)
  (cl-flet
      ((tail-trampoline
        (V14056 V14057 V14058 V14059)
        (shen/cond
         ((shen/predicate->shen
           (null V14057))
          (shen/internal/apply-higher-order-function V14056
                                                     (list V14059
                                                           (shen/freeze
                                                            (shen/shen\.call-rest V14058 V14059)))))
         ((shen/cons\? V14057)
          (vector
           (list
            (shen/internal/apply-higher-order-function V14056
                                                       (list
                                                        (shen/hd V14057)))
            (nthcdr 1 V14057)
            V14058 V14059)))
         (shen/true
          (shen/shen\.f_error 'shen\.intprolog-help-help)))))
    (let
        ((result
          (funcall #'tail-trampoline V14056 V14057 V14058 V14059)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.call-rest
    (V14064 V14065)
  (cl-flet
      ((tail-trampoline
        (V14064 V14065)
        (shen/cond
         ((shen/predicate->shen
           (null V14064))
          'true)
         ((shen/and
           (shen/cons\? V14064)
           (shen/and
            (shen/cons\?
             (shen/hd V14064))
            (shen/cons\?
             (nthcdr 1
                     (shen/hd V14064)))))
          (vector
           (list
            (append
             (list
              (append
               (list
                (shen/internal/apply-function-expression
                 (shen/hd
                  (shen/hd V14064))
                 (list
                  (shen/hd
                   (nthcdr 1
                           (shen/hd V14064))))))
               (nthcdr 2
                       (shen/hd V14064))))
             (nthcdr 1 V14064))
            V14065)))
         ((shen/and
           (shen/cons\? V14064)
           (shen/and
            (shen/cons\?
             (shen/hd V14064))
            (shen/predicate->shen
             (null
              (nthcdr 1
                      (shen/hd V14064))))))
          (shen/internal/apply-function-expression
           (shen/hd
            (shen/hd V14064))
           (list V14065
                 (shen/freeze
                  (shen/shen\.call-rest
                   (nthcdr 1 V14064)
                   V14065)))))
         (shen/true
          (shen/shen\.f_error 'shen\.call-rest)))))
    (let
        ((result
          (funcall #'tail-trampoline V14064 V14065)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.start-new-prolog-process nil
  (shen/let IncrementProcessCounter
            (shen/set 'shen\.*process-counter*
                      (1+
                       (shen/value 'shen\.*process-counter*)))
            (shen/shen\.initialise-prolog IncrementProcessCounter)))
(defun shen/shen\.insert-prolog-variables
    (V14068 V14069)
  (shen/shen\.insert-prolog-variables-help V14068
                                           (shen/shen\.flatten V14068)
                                           V14069))
(defun shen/shen\.insert-prolog-variables-help
    (V14077 V14078 V14079)
  (cl-flet
      ((tail-trampoline
        (V14077 V14078 V14079)
        (shen/cond
         ((shen/predicate->shen
           (null V14078))
          V14077)
         ((shen/and
           (shen/cons\? V14078)
           (shen/variable\?
            (shen/hd V14078)))
          (shen/let V
                    (shen/shen\.newpv V14079)
                    (shen/let XV/Y
                              (shen/subst V
                                          (shen/hd V14078)
                                          V14077)
                              (shen/let Z-Y
                                        (shen/remove
                                         (shen/hd V14078)
                                         (nthcdr 1 V14078))
                                        (vector
                                         (list XV/Y Z-Y V14079))))))
         ((shen/cons\? V14078)
          (vector
           (list V14077
                 (nthcdr 1 V14078)
                 V14079)))
         (shen/true
          (shen/shen\.f_error 'shen\.insert-prolog-variables-help)))))
    (let
        ((result
          (funcall #'tail-trampoline V14077 V14078 V14079)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.initialise-prolog
    (V14081)
  (shen/let Vector
            (shen/address->
             (shen/value 'shen\.*prologvectors*)
             V14081
             (shen/shen\.fillvector
              (shen/vector 10)
              1 10 'shen\.-null-))
            (shen/let Counter
                      (shen/address->
                       (shen/value 'shen\.*varcounter*)
                       V14081 1)
                      V14081)))
(defun shen/shen\.f_error
    (V15701)
  (shen/do
   (shen/shen\.prhush
    (shen/cn "partial function "
             (shen/shen\.app V15701 ";\n" 'shen\.a))
    (shen/stoutput))
   (shen/do
    (shen/if
     (shen/and
      (shen/not
       (shen/shen\.tracked\? V15701))
      (shen/y-or-n\?
       (shen/cn "track "
                (shen/shen\.app V15701 "? " 'shen\.a))))
     (shen/shen\.track-function
      (shen/ps V15701))
     'shen\.ok)
    (shen/simple-error "aborted"))))
(defun shen/shen\.tracked\?
    (V15703)
  (shen/element\? V15703
                  (shen/value 'shen\.*tracking*)))
(defun shen/track
    (V15705)
  (shen/let Source
            (shen/ps V15705)
            (shen/shen\.track-function Source)))
(defun shen/shen\.track-function
    (V15707)
  (shen/cond
   ((shen/and
     (shen/cons\? V15707)
     (shen/and
      (shen/= 'defun
              (shen/hd V15707))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15707))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15707))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V15707))
         (shen/predicate->shen
          (null
           (nthcdr 4 V15707))))))))
    (shen/let KL
              (list 'defun
                    (shen/hd
                     (nthcdr 1 V15707))
                    (shen/hd
                     (nthcdr 2 V15707))
                    (shen/shen\.insert-tracking-code
                     (shen/hd
                      (nthcdr 1 V15707))
                     (shen/hd
                      (nthcdr 2 V15707))
                     (shen/hd
                      (nthcdr 3 V15707))))
              (shen/let Ob
                        (shen/eval-kl KL)
                        (shen/let Tr
                                  (shen/set 'shen\.*tracking*
                                            (append
                                             (list Ob)
                                             (shen/value 'shen\.*tracking*)))
                                  Ob))))
   (shen/true
    (shen/shen\.f_error 'shen\.track-function))))
(defun shen/shen\.insert-tracking-code
    (V15711 V15712 V15713)
  (list 'do
        (list 'set 'shen\.*call*
              (list '+
                    (list 'value 'shen\.*call*)
                    1))
        (list 'do
              (list 'shen\.input-track
                    (list 'value 'shen\.*call*)
                    V15711
                    (shen/shen\.cons_form V15712))
              (list 'do
                    (list 'shen\.terpri-or-read-char)
                    (list 'let 'Result V15713
                          (list 'do
                                (list 'shen\.output-track
                                      (list 'value 'shen\.*call*)
                                      V15711 'Result)
                                (list 'do
                                      (list 'set 'shen\.*call*
                                            (list '-
                                                  (list 'value 'shen\.*call*)
                                                  1))
                                      (list 'do
                                            (list 'shen\.terpri-or-read-char)
                                            'Result))))))))
(shen/set 'shen\.*step* 'false)
(defun shen/step
    (V15719)
  (shen/cond
   ((shen/= '+ V15719)
    (shen/set 'shen\.*step* 'true))
   ((shen/= '- V15719)
    (shen/set 'shen\.*step* 'false))
   (shen/true
    (shen/simple-error "step expects a + or a -.\n"))))
(defun shen/spy
    (V15725)
  (shen/cond
   ((shen/= '+ V15725)
    (shen/set 'shen\.*spy* 'true))
   ((shen/= '- V15725)
    (shen/set 'shen\.*spy* 'false))
   (shen/true
    (shen/simple-error "spy expects a + or a -.\n"))))
(defun shen/shen\.terpri-or-read-char nil
  (shen/if
   (shen/value 'shen\.*step*)
   (shen/shen\.check-byte
    (shen/read-byte
     (shen/value '*stinput*)))
   (shen/nl 1)))
(defun shen/shen\.check-byte
    (V15731)
  (shen/cond
   ((shen/= V15731
            (shen/shen\.hat))
    (shen/simple-error "aborted"))
   (shen/true 'true)))
(defun shen/shen\.input-track
    (V15735 V15736 V15737)
  (shen/do
   (shen/shen\.prhush
    (shen/cn "\n"
             (shen/shen\.app
              (shen/shen\.spaces V15735)
              (shen/cn "<"
                       (shen/shen\.app V15735
                                       (shen/cn "> Inputs to "
                                                (shen/shen\.app V15736
                                                                (shen/cn " \n"
                                                                         (shen/shen\.app
                                                                          (shen/shen\.spaces V15735)
                                                                          "" 'shen\.a))
                                                                'shen\.a))
                                       'shen\.a))
              'shen\.a))
    (shen/stoutput))
   (shen/shen\.recursively-print V15737)))
(defun shen/shen\.recursively-print
    (V15739)
  (cl-flet
      ((tail-trampoline
        (V15739)
        (shen/cond
         ((shen/predicate->shen
           (null V15739))
          (shen/shen\.prhush " ==>"
                             (shen/stoutput)))
         ((shen/cons\? V15739)
          (shen/do
           (shen/print
            (shen/hd V15739))
           (shen/do
            (shen/shen\.prhush ", "
                               (shen/stoutput))
            (vector
             (list
              (nthcdr 1 V15739))))))
         (shen/true
          (shen/shen\.f_error 'shen\.recursively-print)))))
    (let
        ((result
          (funcall #'tail-trampoline V15739)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.spaces
    (V15741)
  (shen/cond
   ((shen/= 0 V15741)
    "")
   (shen/true
    (shen/cn " "
             (shen/shen\.spaces
              (shen/- V15741 1))))))
(defun shen/shen\.output-track
    (V15745 V15746 V15747)
  (shen/shen\.prhush
   (shen/cn "\n"
            (shen/shen\.app
             (shen/shen\.spaces V15745)
             (shen/cn "<"
                      (shen/shen\.app V15745
                                      (shen/cn "> Output from "
                                               (shen/shen\.app V15746
                                                               (shen/cn " \n"
                                                                        (shen/shen\.app
                                                                         (shen/shen\.spaces V15745)
                                                                         (shen/cn "==> "
                                                                                  (shen/shen\.app V15747 "" 'shen\.s))
                                                                         'shen\.a))
                                                               'shen\.a))
                                      'shen\.a))
             'shen\.a))
   (shen/stoutput)))
(defun shen/untrack
    (F)
  (progn
    (shen/set 'shen\.*tracking*
              (shen/internal/delete-first-eq F
                                             (shen/value 'shen\.*tracking*)))
    (shen/eval
     (shen/ps F))))
(defun shen/profile
    (V15751)
  (shen/shen\.profile-help
   (shen/ps V15751)))
(defun shen/shen\.profile-help
    (V15757)
  (shen/cond
   ((shen/and
     (shen/cons\? V15757)
     (shen/and
      (shen/= 'defun
              (shen/hd V15757))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15757))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15757))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V15757))
         (shen/predicate->shen
          (null
           (nthcdr 4 V15757))))))))
    (shen/let G
              (shen/gensym 'shen\.f)
              (shen/let Profile
                        (list 'defun
                              (shen/hd
                               (nthcdr 1 V15757))
                              (shen/hd
                               (nthcdr 2 V15757))
                              (shen/shen\.profile-func
                               (shen/hd
                                (nthcdr 1 V15757))
                               (shen/hd
                                (nthcdr 2 V15757))
                               (append
                                (list G)
                                (shen/hd
                                 (nthcdr 2 V15757)))))
                        (shen/let Def
                                  (list 'defun G
                                        (shen/hd
                                         (nthcdr 2 V15757))
                                        (shen/subst G
                                                    (shen/hd
                                                     (nthcdr 1 V15757))
                                                    (shen/hd
                                                     (nthcdr 3 V15757))))
                                  (shen/let CompileProfile
                                            (shen/shen\.eval-without-macros Profile)
                                            (shen/let CompileG
                                                      (shen/shen\.eval-without-macros Def)
                                                      (shen/hd
                                                       (nthcdr 1 V15757))))))))
   (shen/true
    (shen/simple-error "Cannot profile.\n"))))
(defun shen/unprofile
    (V15759)
  (shen/untrack V15759))
(defun shen/shen\.profile-func
    (V15763 V15764 V15765)
  (list 'let 'Start
        (list 'get-time 'run)
        (list 'let 'Result V15765
              (list 'let 'Finish
                    (list '-
                          (list 'get-time 'run)
                          'Start)
                    (list 'let 'Record
                          (list 'shen\.put-profile V15763
                                (list '+
                                      (list 'shen\.get-profile V15763)
                                      'Finish))
                          'Result)))))
(defun shen/profile-results
    (V15767)
  (shen/let Results
            (shen/shen\.get-profile V15767)
            (shen/let Initialise
                      (shen/shen\.put-profile V15767 0)
                      (shen/@p V15767 Results))))
(defun shen/shen\.get-profile
    (V15769)
  (shen/trap-error
   (shen/get V15769 'profile
             (shen/value '*property-vector*))
   (shen/lambda E 0)))
(defun shen/shen\.put-profile
    (V15772 V15773)
  (shen/put V15772 'profile V15773
            (shen/value '*property-vector*)))
(defun shen/load
    (V13402)
  (shen/let Load
            (shen/let Start
                      (shen/get-time 'run)
                      (shen/let Result
                                (shen/shen\.load-help
                                 (shen/value 'shen\.*tc*)
                                 (shen/read-file V13402))
                                (shen/let Finish
                                          (shen/get-time 'run)
                                          (shen/let Time
                                                    (shen/- Finish Start)
                                                    (shen/let Message
                                                              (shen/shen\.prhush
                                                               (shen/cn "\nrun time: "
                                                                        (shen/cn
                                                                         (shen/str Time)
                                                                         " secs\n"))
                                                               (shen/stoutput))
                                                              Result)))))
            (shen/let Infs
                      (shen/if
                       (shen/value 'shen\.*tc*)
                       (shen/shen\.prhush
                        (shen/cn "\ntypechecked in "
                                 (shen/shen\.app
                                  (shen/inferences)
                                  " inferences\n" 'shen\.a))
                        (shen/stoutput))
                       'shen\.skip)
                      'loaded)))
(defun shen/shen\.load-help
    (V13409 V13410)
  (shen/cond
   ((shen/= 'false V13409)
    (shen/map
     (shen/lambda X
                  (shen/shen\.prhush
                   (shen/shen\.app
                    (shen/shen\.eval-without-macros X)
                    "\n" 'shen\.s)
                   (shen/stoutput)))
     V13410))
   (shen/true
    (shen/let RemoveSynonyms
              (shen/mapcan
               (shen/lambda X
                            (shen/shen\.remove-synonyms X))
               V13410)
              (shen/let Table
                        (shen/mapcan
                         (shen/lambda X
                                      (shen/shen\.typetable X))
                         RemoveSynonyms)
                        (shen/let Assume
                                  (shen/map
                                   (shen/lambda X
                                                (shen/shen\.assumetype X))
                                   Table)
                                  (shen/trap-error
                                   (shen/map
                                    (shen/lambda X
                                                 (shen/shen\.typecheck-and-load X))
                                    RemoveSynonyms)
                                   (shen/lambda E
                                                (shen/shen\.unwind-types E Table)))))))))
(defun shen/shen\.remove-synonyms
    (V13412)
  (shen/cond
   ((shen/and
     (shen/cons\? V13412)
     (shen/= 'shen\.synonyms-help
             (shen/hd V13412)))
    (shen/do
     (shen/eval V13412)
     nil))
   (shen/true
    (list V13412))))
(defun shen/shen\.typecheck-and-load
    (V13414)
  (shen/do
   (shen/nl 1)
   (shen/shen\.typecheck-and-evaluate V13414
                                      (shen/gensym 'A))))
(defun shen/shen\.typetable
    (V13420)
  (shen/cond
   ((shen/and
     (shen/cons\? V13420)
     (shen/and
      (shen/= 'define
              (shen/hd V13420))
      (shen/cons\?
       (nthcdr 1 V13420))))
    (shen/let Sig
              (shen/compile
               (shen/lambda Y
                            (shen/shen\.<sig+rest> Y))
               (nthcdr 2 V13420)
               (shen/lambda E
                            (shen/simple-error
                             (shen/shen\.app
                              (shen/hd
                               (nthcdr 1 V13420))
                              " lacks a proper signature.\n" 'shen\.a))))
              (list
               (append
                (list
                 (shen/hd
                  (nthcdr 1 V13420)))
                Sig))))
   (shen/true nil)))
(defun shen/shen\.assumetype
    (V13422)
  (shen/cond
   ((shen/cons\? V13422)
    (shen/declare
     (shen/hd V13422)
     (nthcdr 1 V13422)))
   (shen/true
    (shen/shen\.f_error 'shen\.assumetype))))
(defun shen/shen\.unwind-types
    (V13429 V13430)
  (cl-flet
      ((tail-trampoline
        (V13429 V13430)
        (shen/cond
         ((shen/predicate->shen
           (null V13430))
          (shen/simple-error
           (shen/error-to-string V13429)))
         ((shen/and
           (shen/cons\? V13430)
           (shen/cons\?
            (shen/hd V13430)))
          (shen/do
           (shen/shen\.remtype
            (shen/hd
             (shen/hd V13430)))
           (vector
            (list V13429
                  (nthcdr 1 V13430)))))
         (shen/true
          (shen/shen\.f_error 'shen\.unwind-types)))))
    (let
        ((result
          (funcall #'tail-trampoline V13429 V13430)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.remtype
    (V13432)
  (shen/set 'shen\.*signedfuncs*
            (shen/shen\.removetype V13432
                                   (shen/value 'shen\.*signedfuncs*))))
(defun shen/shen\.removetype
    (V13440 V13441)
  (cl-flet
      ((tail-trampoline
        (V13440 V13441)
        (shen/cond
         ((shen/predicate->shen
           (null V13441))
          nil)
         ((shen/and
           (shen/cons\? V13441)
           (shen/and
            (shen/cons\?
             (shen/hd V13441))
            (shen/=
             (shen/hd
              (shen/hd V13441))
             V13440)))
          (vector
           (list
            (shen/hd
             (shen/hd V13441))
            (nthcdr 1 V13441))))
         ((shen/cons\? V13441)
          (append
           (list
            (shen/hd V13441))
           (shen/shen\.removetype V13440
                                  (nthcdr 1 V13441))))
         (shen/true
          (shen/shen\.f_error 'shen\.removetype)))))
    (let
        ((result
          (funcall #'tail-trampoline V13440 V13441)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.<sig+rest>
    (V13443)
  (shen/let Parse_shen\.<signature>
            (shen/shen\.<signature> V13443)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<signature>))
             (shen/let Parse_shen\.<!>
                       (shen/shen\.<!> Parse_shen\.<signature>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<!>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<!>)
                         (shen/shen\.hdtl Parse_shen\.<signature>))
                        (shen/fail)))
             (shen/fail))))
(defun shen/write-to-file
    (V13446 V13447)
  (shen/let Stream
            (shen/open V13446 'out)
            (shen/let String
                      (shen/if
                       (shen/string\? V13447)
                       (shen/shen\.app V13447 "\n\n" 'shen\.a)
                       (shen/shen\.app V13447 "\n\n" 'shen\.s))
                      (shen/let Write
                                (shen/pr String Stream)
                                (shen/let Close
                                          (shen/close Stream)
                                          V13447)))))
(defun shen/pr
    (V15800 V15801)
  (shen/trap-error
   (shen/shen\.prh V15800 V15801 0)
   (shen/lambda E V15800)))
(defun shen/shen\.prh
    (V15805 V15806 V15807)
  (cl-flet
      ((tail-trampoline
        (V15805 V15806 V15807)
        (vector
         (list V15805 V15806
               (shen/shen\.write-char-and-inc V15805 V15806 V15807)))))
    (let
        ((result
          (funcall #'tail-trampoline V15805 V15806 V15807)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.write-char-and-inc
    (V15811 V15812 V15813)
  (shen/do
   (shen/write-byte
    (shen/string->n
     (shen/pos V15811 V15813))
    V15812)
   (1+ V15813)))
(defun shen/print
    (V15815)
  (shen/let String
            (shen/shen\.insert V15815 "~S")
            (shen/let Print
                      (shen/shen\.prhush String
                                         (shen/stoutput))
                      V15815)))
(defun shen/shen\.prhush
    (V15818 V15819)
  (shen/if
   (shen/value '*hush*)
   V15818
   (shen/pr V15818 V15819)))
(defun shen/shen\.mkstr
    (V15822 V15823)
  (shen/cond
   ((shen/string\? V15822)
    (shen/shen\.mkstr-l
     (shen/shen\.proc-nl V15822)
     V15823))
   (shen/true
    (shen/shen\.mkstr-r
     (list 'shen\.proc-nl V15822)
     V15823))))
(defun shen/shen\.mkstr-l
    (V15826 V15827)
  (cl-flet
      ((tail-trampoline
        (V15826 V15827)
        (shen/cond
         ((shen/predicate->shen
           (null V15827))
          V15826)
         ((shen/cons\? V15827)
          (vector
           (list
            (shen/shen\.insert-l
             (shen/hd V15827)
             V15826)
            (nthcdr 1 V15827))))
         (shen/true
          (shen/shen\.f_error 'shen\.mkstr-l)))))
    (let
        ((result
          (funcall #'tail-trampoline V15826 V15827)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.insert-l
    (V15832 V15833)
  (shen/cond
   ((shen/= "" V15833)
    "")
   ((shen/and
     (shen/shen\.+string\? V15833)
     (shen/and
      (shen/= "~"
              (shen/pos V15833 0))
      (shen/and
       (shen/shen\.+string\?
        (shen/tlstr V15833))
       (shen/= "A"
               (shen/pos
                (shen/tlstr V15833)
                0)))))
    (list 'shen\.app V15832
          (shen/tlstr
           (shen/tlstr V15833))
          'shen\.a))
   ((shen/and
     (shen/shen\.+string\? V15833)
     (shen/and
      (shen/= "~"
              (shen/pos V15833 0))
      (shen/and
       (shen/shen\.+string\?
        (shen/tlstr V15833))
       (shen/= "R"
               (shen/pos
                (shen/tlstr V15833)
                0)))))
    (list 'shen\.app V15832
          (shen/tlstr
           (shen/tlstr V15833))
          'shen\.r))
   ((shen/and
     (shen/shen\.+string\? V15833)
     (shen/and
      (shen/= "~"
              (shen/pos V15833 0))
      (shen/and
       (shen/shen\.+string\?
        (shen/tlstr V15833))
       (shen/= "S"
               (shen/pos
                (shen/tlstr V15833)
                0)))))
    (list 'shen\.app V15832
          (shen/tlstr
           (shen/tlstr V15833))
          'shen\.s))
   ((shen/shen\.+string\? V15833)
    (shen/shen\.factor-cn
     (list 'cn
           (shen/pos V15833 0)
           (shen/shen\.insert-l V15832
                                (shen/tlstr V15833)))))
   ((shen/and
     (shen/cons\? V15833)
     (shen/and
      (shen/= 'cn
              (shen/hd V15833))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15833))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15833))
        (shen/predicate->shen
         (null
          (nthcdr 3 V15833)))))))
    (list 'cn
          (shen/hd
           (nthcdr 1 V15833))
          (shen/shen\.insert-l V15832
                               (shen/hd
                                (nthcdr 2 V15833)))))
   ((shen/and
     (shen/cons\? V15833)
     (shen/and
      (shen/= 'shen\.app
              (shen/hd V15833))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15833))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15833))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V15833))
         (shen/predicate->shen
          (null
           (nthcdr 4 V15833))))))))
    (append
     (list 'shen\.app
           (shen/hd
            (nthcdr 1 V15833))
           (shen/shen\.insert-l V15832
                                (shen/hd
                                 (nthcdr 2 V15833))))
     (nthcdr 3 V15833)))
   (shen/true
    (shen/shen\.f_error 'shen\.insert-l))))
(defun shen/shen\.factor-cn
    (V15835)
  (shen/cond
   ((shen/and
     (shen/cons\? V15835)
     (shen/and
      (shen/= 'cn
              (shen/hd V15835))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15835))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15835))
        (shen/and
         (shen/cons\?
          (shen/hd
           (nthcdr 2 V15835)))
         (shen/and
          (shen/= 'cn
                  (shen/hd
                   (shen/hd
                    (nthcdr 2 V15835))))
          (shen/and
           (shen/cons\?
            (nthcdr 1
                    (shen/hd
                     (nthcdr 2 V15835))))
           (shen/and
            (shen/cons\?
             (nthcdr 2
                     (shen/hd
                      (nthcdr 2 V15835))))
            (shen/and
             (shen/predicate->shen
              (null
               (nthcdr 3
                       (shen/hd
                        (nthcdr 2 V15835)))))
             (shen/and
              (shen/predicate->shen
               (null
                (nthcdr 3 V15835)))
              (shen/and
               (shen/string\?
                (shen/hd
                 (nthcdr 1 V15835)))
               (shen/string\?
                (shen/hd
                 (nthcdr 1
                         (shen/hd
                          (nthcdr 2 V15835))))))))))))))))
    (append
     (list 'cn
           (shen/cn
            (shen/hd
             (nthcdr 1 V15835))
            (shen/hd
             (nthcdr 1
                     (shen/hd
                      (nthcdr 2 V15835))))))
     (nthcdr 2
             (shen/hd
              (nthcdr 2 V15835)))))
   (shen/true V15835)))
(defun shen/shen\.proc-nl
    (V15837)
  (shen/cond
   ((shen/= "" V15837)
    "")
   ((shen/and
     (shen/shen\.+string\? V15837)
     (shen/and
      (shen/= "~"
              (shen/pos V15837 0))
      (shen/and
       (shen/shen\.+string\?
        (shen/tlstr V15837))
       (shen/= "%"
               (shen/pos
                (shen/tlstr V15837)
                0)))))
    (shen/cn
     (shen/n->string 10)
     (shen/shen\.proc-nl
      (shen/tlstr
       (shen/tlstr V15837)))))
   ((shen/shen\.+string\? V15837)
    (shen/cn
     (shen/pos V15837 0)
     (shen/shen\.proc-nl
      (shen/tlstr V15837))))
   (shen/true
    (shen/shen\.f_error 'shen\.proc-nl))))
(defun shen/shen\.mkstr-r
    (V15840 V15841)
  (cl-flet
      ((tail-trampoline
        (V15840 V15841)
        (shen/cond
         ((shen/predicate->shen
           (null V15841))
          V15840)
         ((shen/cons\? V15841)
          (vector
           (list
            (list 'shen\.insert
                  (shen/hd V15841)
                  V15840)
            (nthcdr 1 V15841))))
         (shen/true
          (shen/shen\.f_error 'shen\.mkstr-r)))))
    (let
        ((result
          (funcall #'tail-trampoline V15840 V15841)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.insert
    (V15844 V15845)
  (shen/shen\.insert-h V15844 V15845 ""))
(defun shen/shen\.insert-h
    (V15851 V15852 V15853)
  (cl-flet
      ((tail-trampoline
        (V15851 V15852 V15853)
        (shen/cond
         ((shen/= "" V15852)
          V15853)
         ((shen/and
           (shen/shen\.+string\? V15852)
           (shen/and
            (shen/= "~"
                    (shen/pos V15852 0))
            (shen/and
             (shen/shen\.+string\?
              (shen/tlstr V15852))
             (shen/= "A"
                     (shen/pos
                      (shen/tlstr V15852)
                      0)))))
          (shen/cn V15853
                   (shen/shen\.app V15851
                                   (shen/tlstr
                                    (shen/tlstr V15852))
                                   'shen\.a)))
         ((shen/and
           (shen/shen\.+string\? V15852)
           (shen/and
            (shen/= "~"
                    (shen/pos V15852 0))
            (shen/and
             (shen/shen\.+string\?
              (shen/tlstr V15852))
             (shen/= "R"
                     (shen/pos
                      (shen/tlstr V15852)
                      0)))))
          (shen/cn V15853
                   (shen/shen\.app V15851
                                   (shen/tlstr
                                    (shen/tlstr V15852))
                                   'shen\.r)))
         ((shen/and
           (shen/shen\.+string\? V15852)
           (shen/and
            (shen/= "~"
                    (shen/pos V15852 0))
            (shen/and
             (shen/shen\.+string\?
              (shen/tlstr V15852))
             (shen/= "S"
                     (shen/pos
                      (shen/tlstr V15852)
                      0)))))
          (shen/cn V15853
                   (shen/shen\.app V15851
                                   (shen/tlstr
                                    (shen/tlstr V15852))
                                   'shen\.s)))
         ((shen/shen\.+string\? V15852)
          (vector
           (list V15851
                 (shen/tlstr V15852)
                 (shen/cn V15853
                          (shen/pos V15852 0)))))
         (shen/true
          (shen/shen\.f_error 'shen\.insert-h)))))
    (let
        ((result
          (funcall #'tail-trampoline V15851 V15852 V15853)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.app
    (V15857 V15858 V15859)
  (shen/cn
   (shen/shen\.arg->str V15857 V15859)
   V15858))
(defun shen/shen\.arg->str
    (V15867 V15868)
  (shen/cond
   ((shen/= V15867
            (shen/fail))
    "...")
   ((shen/shen\.list\? V15867)
    (shen/shen\.list->str V15867 V15868))
   ((shen/string\? V15867)
    (shen/shen\.str->str V15867 V15868))
   ((shen/absvector\? V15867)
    (shen/shen\.vector->str V15867 V15868))
   (shen/true
    (shen/shen\.atom->str V15867))))
(defun shen/shen\.list->str
    (V15871 V15872)
  (shen/cond
   ((shen/= 'shen\.r V15872)
    (concat
     (concat "("
             (shen/shen\.iter-list V15871 'shen\.r
                                   (shen/shen\.maxseq)))
     ")"))
   (shen/true
    (concat
     (concat "["
             (shen/shen\.iter-list V15871 V15872
                                   (shen/shen\.maxseq)))
     "]"))))
(defun shen/shen\.maxseq nil
  (shen/value '*maximum-print-sequence-size*))
(defun shen/shen\.iter-list
    (V15886 V15887 V15888)
  (shen/cond
   ((shen/predicate->shen
     (null V15886))
    "")
   ((shen/= 0 V15888)
    "... etc")
   ((shen/and
     (shen/cons\? V15886)
     (shen/predicate->shen
      (null
       (nthcdr 1 V15886))))
    (shen/shen\.arg->str
     (shen/hd V15886)
     V15887))
   ((shen/cons\? V15886)
    (concat
     (concat
      (shen/shen\.arg->str
       (shen/hd V15886)
       V15887)
      " ")
     (shen/shen\.iter-list
      (nthcdr 1 V15886)
      V15887
      (shen/- V15888 1))))
   (shen/true
    (concat
     (concat "|" " ")
     (shen/shen\.arg->str V15886 V15887)))))
(defun shen/shen\.str->str
    (V15895 V15896)
  (shen/cond
   ((shen/= 'shen\.a V15896)
    V15895)
   (shen/true
    (concat
     (concat
      (shen/n->string 34)
      V15895)
     (shen/n->string 34)))))
(defun shen/shen\.vector->str
    (V15899 V15900)
  (shen/if
   (shen/shen\.print-vector\? V15899)
   (shen/internal/apply-function-expression
    (shen/function
     (shen/<-address V15899 0))
    (list V15899))
   (shen/if
    (shen/vector\? V15899)
    (concat
     (concat "<"
             (shen/shen\.iter-vector V15899 1 V15900
                                     (shen/shen\.maxseq)))
     ">")
    (concat
     (concat "<" "<"
             (shen/shen\.iter-vector V15899 0 V15900
                                     (shen/shen\.maxseq)))
     ">>"))))
(defun shen/shen\.print-vector\?
    (V15902)
  (shen/let Zero
            (shen/<-address V15902 0)
            (shen/if
             (shen/= Zero 'shen\.tuple)
             'true
             (shen/if
              (shen/= Zero 'shen\.pvar)
              'true
              (shen/if
               (shen/not
                (shen/number\? Zero))
               (shen/shen\.fbound\? Zero)
               'false)))))
(defun shen/shen\.fbound\?
    (V15904)
  (shen/trap-error
   (shen/do
    (shen/ps V15904)
    'true)
   (shen/lambda E 'false)))
(defun shen/shen\.tuple
    (V15906)
  (shen/cn "(@p "
           (shen/shen\.app
            (shen/<-address V15906 1)
            (shen/cn " "
                     (shen/shen\.app
                      (shen/<-address V15906 2)
                      ")" 'shen\.s))
            'shen\.s)))
(defun shen/shen\.iter-vector
    (V15917 V15918 V15919 V15920)
  (shen/cond
   ((shen/= 0 V15920)
    "... etc")
   (shen/true
    (shen/let Item
              (shen/trap-error
               (shen/<-address V15917 V15918)
               (shen/lambda E 'shen\.out-of-bounds))
              (shen/let Next
                        (shen/trap-error
                         (shen/<-address V15917
                                         (1+ V15918))
                         (shen/lambda E 'shen\.out-of-bounds))
                        (shen/if
                         (shen/= Item 'shen\.out-of-bounds)
                         ""
                         (shen/if
                          (shen/= Next 'shen\.out-of-bounds)
                          (shen/shen\.arg->str Item V15919)
                          (concat
                           (concat
                            (shen/shen\.arg->str Item V15919)
                            " ")
                           (shen/shen\.iter-vector V15917
                                                   (1+ V15918)
                                                   V15919
                                                   (shen/- V15920 1))))))))))
(defun shen/shen\.atom->str
    (V15922)
  (shen/trap-error
   (shen/str V15922)
   (shen/lambda E
                (shen/shen\.funexstring))))
(defun shen/shen\.funexstring nil
  (concat
   (concat "" "f" "u" "n" "e"
           (shen/shen\.arg->str
            (shen/gensym
             (shen/intern "x"))
            'shen\.a))
   ""))
(defun shen/shen\.list\?
    (V15924)
  (shen/or
   (shen/empty\? V15924)
   (shen/cons\? V15924)))
(defun shen/macroexpand
    (V13449)
  (shen/let Y
            (shen/shen\.compose
             (shen/value '*macros*)
             V13449)
            (shen/if
             (shen/= V13449 Y)
             V13449
             (shen/shen\.walk
              (shen/lambda Z
                           (shen/macroexpand Z))
              Y))))
(defun shen/shen\.error-macro
    (V13451)
  (shen/cond
   ((shen/and
     (shen/cons\? V13451)
     (shen/and
      (shen/= 'error
              (shen/hd V13451))
      (shen/cons\?
       (nthcdr 1 V13451))))
    (list 'simple-error
          (shen/shen\.mkstr
           (shen/hd
            (nthcdr 1 V13451))
           (nthcdr 2 V13451))))
   (shen/true V13451)))
(defun shen/shen\.output-macro
    (V13453)
  (shen/cond
   ((shen/and
     (shen/cons\? V13453)
     (shen/and
      (shen/= 'output
              (shen/hd V13453))
      (shen/cons\?
       (nthcdr 1 V13453))))
    (list 'shen\.prhush
          (shen/shen\.mkstr
           (shen/hd
            (nthcdr 1 V13453))
           (nthcdr 2 V13453))
          (list 'stoutput)))
   ((shen/and
     (shen/cons\? V13453)
     (shen/and
      (shen/= 'pr
              (shen/hd V13453))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13453))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13453))))))
    (list 'pr
          (shen/hd
           (nthcdr 1 V13453))
          (list 'stoutput)))
   (shen/true V13453)))
(defun shen/shen\.make-string-macro
    (V13455)
  (shen/cond
   ((shen/and
     (shen/cons\? V13455)
     (shen/and
      (shen/= 'make-string
              (shen/hd V13455))
      (shen/cons\?
       (nthcdr 1 V13455))))
    (shen/shen\.mkstr
     (shen/hd
      (nthcdr 1 V13455))
     (nthcdr 2 V13455)))
   (shen/true V13455)))
(defun shen/shen\.input-macro
    (V13457)
  (shen/cond
   ((shen/and
     (shen/cons\? V13457)
     (shen/and
      (shen/= 'lineread
              (shen/hd V13457))
      (shen/predicate->shen
       (null
        (nthcdr 1 V13457)))))
    (list 'lineread
          (list 'stinput)))
   ((shen/and
     (shen/cons\? V13457)
     (shen/and
      (shen/= 'input
              (shen/hd V13457))
      (shen/predicate->shen
       (null
        (nthcdr 1 V13457)))))
    (list 'input
          (list 'stinput)))
   ((shen/and
     (shen/cons\? V13457)
     (shen/and
      (shen/= 'read
              (shen/hd V13457))
      (shen/predicate->shen
       (null
        (nthcdr 1 V13457)))))
    (list 'read
          (list 'stinput)))
   ((shen/and
     (shen/cons\? V13457)
     (shen/and
      (shen/= 'input+
              (shen/hd V13457))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13457))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13457))))))
    (list 'input+
          (shen/hd
           (nthcdr 1 V13457))
          (list 'stinput)))
   ((shen/and
     (shen/cons\? V13457)
     (shen/and
      (shen/= 'read-byte
              (shen/hd V13457))
      (shen/predicate->shen
       (null
        (nthcdr 1 V13457)))))
    (list 'read-byte
          (list 'stinput)))
   (shen/true V13457)))
(defun shen/shen\.compose
    (V13460 V13461)
  (cl-flet
      ((tail-trampoline
        (V13460 V13461)
        (shen/cond
         ((shen/predicate->shen
           (null V13460))
          V13461)
         ((shen/cons\? V13460)
          (vector
           (list
            (nthcdr 1 V13460)
            (shen/internal/apply-function-expression
             (shen/hd V13460)
             (list V13461)))))
         (shen/true
          (shen/shen\.f_error 'shen\.compose)))))
    (let
        ((result
          (funcall #'tail-trampoline V13460 V13461)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.compile-macro
    (V13463)
  (shen/cond
   ((shen/and
     (shen/cons\? V13463)
     (shen/and
      (shen/= 'compile
              (shen/hd V13463))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13463))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13463))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13463)))))))
    (list 'compile
          (shen/hd
           (nthcdr 1 V13463))
          (shen/hd
           (nthcdr 2 V13463))
          (list 'lambda 'E
                (list 'if
                      (list 'cons\? 'E)
                      (list 'error "parse error here: ~S~%" 'E)
                      (list 'error "parse error~%")))))
   (shen/true V13463)))
(defun shen/shen\.prolog-macro
    (V13465)
  (shen/cond
   ((shen/and
     (shen/cons\? V13465)
     (shen/= 'prolog\?
             (shen/hd V13465)))
    (shen/let F
              (shen/gensym 'shen\.f)
              (shen/let Receive
                        (shen/shen\.receive-terms
                         (nthcdr 1 V13465))
                        (shen/let PrologDef
                                  (shen/eval
                                   (shen/append
                                    (list 'defprolog F)
                                    (shen/append Receive
                                                 (shen/append
                                                  (list '<--)
                                                  (shen/append
                                                   (shen/shen\.pass-literals
                                                    (nthcdr 1 V13465))
                                                   (list '\;))))))
                                  (shen/let Query
                                            (append
                                             (list F)
                                             (shen/append Receive
                                                          (list
                                                           (list 'shen\.start-new-prolog-process)
                                                           (list 'freeze 'true))))
                                            Query)))))
   (shen/true V13465)))
(defun shen/shen\.receive-terms
    (V13471)
  (cl-flet
      ((tail-trampoline
        (V13471)
        (shen/cond
         ((shen/predicate->shen
           (null V13471))
          nil)
         ((shen/and
           (shen/cons\? V13471)
           (shen/and
            (shen/cons\?
             (shen/hd V13471))
            (shen/and
             (shen/= 'receive
                     (shen/hd
                      (shen/hd V13471)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13471)))
              (shen/predicate->shen
               (null
                (nthcdr 2
                        (shen/hd V13471))))))))
          (append
           (list
            (shen/hd
             (nthcdr 1
                     (shen/hd V13471))))
           (shen/shen\.receive-terms
            (nthcdr 1 V13471))))
         ((shen/cons\? V13471)
          (vector
           (list
            (nthcdr 1 V13471))))
         (shen/true
          (shen/shen\.f_error 'shen\.receive-terms)))))
    (let
        ((result
          (funcall #'tail-trampoline V13471)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.pass-literals
    (V13475)
  (cl-flet
      ((tail-trampoline
        (V13475)
        (shen/cond
         ((shen/predicate->shen
           (null V13475))
          nil)
         ((shen/and
           (shen/cons\? V13475)
           (shen/and
            (shen/cons\?
             (shen/hd V13475))
            (shen/and
             (shen/= 'receive
                     (shen/hd
                      (shen/hd V13475)))
             (shen/and
              (shen/cons\?
               (nthcdr 1
                       (shen/hd V13475)))
              (shen/predicate->shen
               (null
                (nthcdr 2
                        (shen/hd V13475))))))))
          (vector
           (list
            (nthcdr 1 V13475))))
         ((shen/cons\? V13475)
          (append
           (list
            (shen/hd V13475))
           (shen/shen\.pass-literals
            (nthcdr 1 V13475))))
         (shen/true
          (shen/shen\.f_error 'shen\.pass-literals)))))
    (let
        ((result
          (funcall #'tail-trampoline V13475)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.defprolog-macro
    (V13477)
  (shen/cond
   ((shen/and
     (shen/cons\? V13477)
     (shen/and
      (shen/= 'defprolog
              (shen/hd V13477))
      (shen/cons\?
       (nthcdr 1 V13477))))
    (shen/compile
     (shen/lambda Y
                  (shen/shen\.<defprolog> Y))
     (nthcdr 1 V13477)
     (shen/lambda Y
                  (shen/shen\.prolog-error
                   (shen/hd
                    (nthcdr 1 V13477))
                   Y))))
   (shen/true V13477)))
(defun shen/shen\.datatype-macro
    (V13479)
  (shen/cond
   ((shen/and
     (shen/cons\? V13479)
     (shen/and
      (shen/= 'datatype
              (shen/hd V13479))
      (shen/cons\?
       (nthcdr 1 V13479))))
    (list 'shen\.process-datatype
          (shen/shen\.intern-type
           (shen/hd
            (nthcdr 1 V13479)))
          (list 'compile
                (list 'lambda 'X
                      (list 'shen\.<datatype-rules> 'X))
                (shen/shen\.rcons_form
                 (nthcdr 2 V13479))
                (list 'function 'shen\.datatype-error))))
   (shen/true V13479)))
(defun shen/shen\.intern-type
    (V13481)
  (shen/intern
   (shen/cn "type#"
            (shen/str V13481))))
(defun shen/shen\.@s-macro
    (V13483)
  (cl-flet
      ((tail-trampoline
        (V13483)
        (shen/cond
         ((shen/and
           (shen/cons\? V13483)
           (shen/and
            (shen/= '@s
                    (shen/hd V13483))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13483))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13483))
              (shen/cons\?
               (nthcdr 3 V13483))))))
          (list '@s
                (shen/hd
                 (nthcdr 1 V13483))
                (shen/shen\.@s-macro
                 (append
                  (list '@s)
                  (nthcdr 2 V13483)))))
         ((shen/and
           (shen/cons\? V13483)
           (shen/and
            (shen/= '@s
                    (shen/hd V13483))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V13483))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V13483))
              (shen/and
               (shen/predicate->shen
                (null
                 (nthcdr 3 V13483)))
               (shen/string\?
                (shen/hd
                 (nthcdr 1 V13483))))))))
          (shen/let E
                    (shen/explode
                     (shen/hd
                      (nthcdr 1 V13483)))
                    (shen/if
                     (shen/>
                      (shen/length E)
                      1)
                     (vector
                      (list
                       (append
                        (list '@s)
                        (shen/append E
                                     (nthcdr 2 V13483)))))
                     V13483)))
         (shen/true V13483))))
    (let
        ((result
          (funcall #'tail-trampoline V13483)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.synonyms-macro
    (V13485)
  (shen/cond
   ((shen/and
     (shen/cons\? V13485)
     (shen/= 'synonyms
             (shen/hd V13485)))
    (list 'shen\.synonyms-help
          (shen/shen\.rcons_form
           (shen/shen\.curry-synonyms
            (nthcdr 1 V13485)))))
   (shen/true V13485)))
(defun shen/shen\.curry-synonyms
    (V13487)
  (shen/map
   (shen/lambda X
                (shen/shen\.curry-type X))
   V13487))
(defun shen/shen\.nl-macro
    (V13489)
  (shen/cond
   ((shen/and
     (shen/cons\? V13489)
     (shen/and
      (shen/= 'nl
              (shen/hd V13489))
      (shen/predicate->shen
       (null
        (nthcdr 1 V13489)))))
    (list 'nl 1))
   (shen/true V13489)))
(defun shen/shen\.assoc-macro
    (V13491)
  (shen/cond
   ((shen/and
     (shen/cons\? V13491)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V13491))
      (shen/and
       (shen/cons\?
        (nthcdr 2 V13491))
       (shen/and
        (shen/cons\?
         (nthcdr 3 V13491))
        (shen/element\?
         (shen/hd V13491)
         (list '@p '@v 'append 'and 'or '+ '* 'do))))))
    (list
     (shen/hd V13491)
     (shen/hd
      (nthcdr 1 V13491))
     (shen/shen\.assoc-macro
      (append
       (list
        (shen/hd V13491))
       (nthcdr 2 V13491)))))
   (shen/true V13491)))
(defun shen/shen\.let-macro
    (V13493)
  (shen/cond
   ((shen/and
     (shen/cons\? V13493)
     (shen/and
      (shen/= 'let
              (shen/hd V13493))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13493))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13493))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V13493))
         (shen/cons\?
          (nthcdr 4 V13493)))))))
    (list 'let
          (shen/hd
           (nthcdr 1 V13493))
          (shen/hd
           (nthcdr 2 V13493))
          (shen/shen\.let-macro
           (append
            (list 'let)
            (nthcdr 3 V13493)))))
   (shen/true V13493)))
(defun shen/shen\.abs-macro
    (V13495)
  (shen/cond
   ((shen/and
     (shen/cons\? V13495)
     (shen/and
      (shen/= '/\.
              (shen/hd V13495))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13495))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13495))
        (shen/cons\?
         (nthcdr 3 V13495))))))
    (list 'lambda
          (shen/hd
           (nthcdr 1 V13495))
          (shen/shen\.abs-macro
           (append
            (list '/\.)
            (nthcdr 2 V13495)))))
   ((shen/and
     (shen/cons\? V13495)
     (shen/and
      (shen/= '/\.
              (shen/hd V13495))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13495))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13495))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13495)))))))
    (append
     (list 'lambda)
     (nthcdr 1 V13495)))
   (shen/true V13495)))
(defun shen/shen\.cases-macro
    (V13499)
  (shen/cond
   ((shen/and
     (shen/cons\? V13499)
     (shen/and
      (shen/= 'cases
              (shen/hd V13499))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13499))
       (shen/and
        (shen/= 'true
                (shen/hd
                 (nthcdr 1 V13499)))
        (shen/cons\?
         (nthcdr 2 V13499))))))
    (shen/hd
     (nthcdr 2 V13499)))
   ((shen/and
     (shen/cons\? V13499)
     (shen/and
      (shen/= 'cases
              (shen/hd V13499))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13499))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13499))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13499)))))))
    (list 'if
          (shen/hd
           (nthcdr 1 V13499))
          (shen/hd
           (nthcdr 2 V13499))
          (list 'simple-error "error: cases exhausted")))
   ((shen/and
     (shen/cons\? V13499)
     (shen/and
      (shen/= 'cases
              (shen/hd V13499))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13499))
       (shen/cons\?
        (nthcdr 2 V13499)))))
    (list 'if
          (shen/hd
           (nthcdr 1 V13499))
          (shen/hd
           (nthcdr 2 V13499))
          (shen/shen\.cases-macro
           (append
            (list 'cases)
            (nthcdr 3 V13499)))))
   ((shen/and
     (shen/cons\? V13499)
     (shen/and
      (shen/= 'cases
              (shen/hd V13499))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13499))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13499))))))
    (shen/simple-error "error: odd number of case elements\n"))
   (shen/true V13499)))
(defun shen/shen\.timer-macro
    (V13501)
  (shen/cond
   ((shen/and
     (shen/cons\? V13501)
     (shen/and
      (shen/= 'time
              (shen/hd V13501))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13501))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13501))))))
    (shen/shen\.let-macro
     (list 'let 'Start
           (list 'get-time 'run)
           'Result
           (shen/hd
            (nthcdr 1 V13501))
           'Finish
           (list 'get-time 'run)
           'Time
           (list '- 'Finish 'Start)
           'Message
           (list 'shen\.prhush
                 (list 'cn "\nrun time: "
                       (list 'cn
                             (list 'str 'Time)
                             " secs\n"))
                 (list 'stoutput))
           'Result)))
   (shen/true V13501)))
(defun shen/shen\.tuple-up
    (V13503)
  (shen/cond
   ((shen/cons\? V13503)
    (list '@p
          (shen/hd V13503)
          (shen/shen\.tuple-up
           (nthcdr 1 V13503))))
   (shen/true V13503)))
(defun shen/shen\.put/get-macro
    (V13505)
  (shen/cond
   ((shen/and
     (shen/cons\? V13505)
     (shen/and
      (shen/= 'put
              (shen/hd V13505))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13505))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13505))
        (shen/and
         (shen/cons\?
          (nthcdr 3 V13505))
         (shen/predicate->shen
          (null
           (nthcdr 4 V13505))))))))
    (list 'put
          (shen/hd
           (nthcdr 1 V13505))
          (shen/hd
           (nthcdr 2 V13505))
          (shen/hd
           (nthcdr 3 V13505))
          (list 'value '*property-vector*)))
   ((shen/and
     (shen/cons\? V13505)
     (shen/and
      (shen/= 'get
              (shen/hd V13505))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13505))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13505))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13505)))))))
    (list 'get
          (shen/hd
           (nthcdr 1 V13505))
          (shen/hd
           (nthcdr 2 V13505))
          (list 'value '*property-vector*)))
   ((shen/and
     (shen/cons\? V13505)
     (shen/and
      (shen/= 'unput
              (shen/hd V13505))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13505))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V13505))
        (shen/predicate->shen
         (null
          (nthcdr 3 V13505)))))))
    (list 'unput
          (shen/hd
           (nthcdr 1 V13505))
          (shen/hd
           (nthcdr 2 V13505))
          (list 'value '*property-vector*)))
   (shen/true V13505)))
(defun shen/shen\.function-macro
    (V13507)
  (shen/cond
   ((shen/and
     (shen/cons\? V13507)
     (shen/and
      (shen/= 'function
              (shen/hd V13507))
      (shen/and
       (shen/cons\?
        (nthcdr 1 V13507))
       (shen/predicate->shen
        (null
         (nthcdr 2 V13507))))))
    (shen/shen\.function-abstraction
     (shen/hd
      (nthcdr 1 V13507))
     (shen/arity
      (shen/hd
       (nthcdr 1 V13507)))))
   (shen/true V13507)))
(defun shen/shen\.function-abstraction
    (V13510 V13511)
  (shen/cond
   ((shen/= 0 V13511)
    (shen/simple-error
     (shen/shen\.app V13510 " has no lambda form\n" 'shen\.a)))
   ((shen/= -1 V13511)
    (list 'function V13510))
   (shen/true
    (shen/shen\.function-abstraction-help V13510 V13511 nil))))
(defun shen/shen\.function-abstraction-help
    (V13515 V13516 V13517)
  (shen/cond
   ((shen/= 0 V13516)
    (append
     (list V13515)
     V13517))
   (shen/true
    (shen/let X
              (shen/gensym 'V)
              (list '/\. X
                    (shen/shen\.function-abstraction-help V13515
                                                          (shen/- V13516 1)
                                                          (shen/append V13517
                                                                       (list X))))))))
(defun shen/undefmacro
    (V13519)
  (shen/let MacroReg
            (shen/value 'shen\.*macroreg*)
            (shen/let Pos
                      (shen/shen\.findpos V13519 MacroReg)
                      (shen/let Remove1
                                (shen/set 'shen\.*macroreg*
                                          (shen/remove V13519 MacroReg))
                                (shen/let Remove2
                                          (shen/set '*macros*
                                                    (shen/shen\.remove-nth Pos
                                                                           (shen/value '*macros*)))
                                          V13519)))))
(defun shen/shen\.findpos
    (V13529 V13530)
  (shen/cond
   ((shen/predicate->shen
     (null V13530))
    (shen/simple-error
     (shen/shen\.app V13529 " is not a macro\n" 'shen\.a)))
   ((shen/and
     (shen/cons\? V13530)
     (shen/=
      (shen/hd V13530)
      V13529))
    1)
   ((shen/cons\? V13530)
    (1+
     (shen/shen\.findpos V13529
                         (nthcdr 1 V13530))))
   (shen/true
    (shen/shen\.f_error 'shen\.findpos))))
(defun shen/shen\.remove-nth
    (V13535 V13536)
  (shen/cond
   ((shen/and
     (shen/= 1 V13535)
     (shen/cons\? V13536))
    (nthcdr 1 V13536))
   ((shen/cons\? V13536)
    (append
     (list
      (shen/hd V13536))
     (shen/shen\.remove-nth
      (shen/- V13535 1)
      (nthcdr 1 V13536))))
   (shen/true
    (shen/shen\.f_error 'shen\.remove-nth))))
(shen/set 'shen\.*installing-kl* 'false)
(shen/set 'shen\.*history* nil)
(shen/set 'shen\.*tc* 'false)
(shen/set '*property-vector*
          (make-hash-table :size 1000 :test 'equal))
(shen/set 'shen\.*process-counter* 0)
(shen/set 'shen\.*varcounter*
          (shen/vector 1000))
(shen/set 'shen\.*prologvectors*
          (shen/vector 1000))
(shen/set 'shen\.*macroreg*
          (list 'shen\.timer-macro 'shen\.cases-macro 'shen\.abs-macro 'shen\.put/get-macro 'shen\.compile-macro 'shen\.datatype-macro 'shen\.let-macro 'shen\.assoc-macro 'shen\.make-string-macro 'shen\.output-macro 'shen\.input-macro 'shen\.error-macro 'shen\.prolog-macro 'shen\.synonyms-macro 'shen\.nl-macro 'shen\.@s-macro 'shen\.defprolog-macro 'shen\.function-macro))
(shen/set '*macros*
          (list
           (shen/lambda X
                        (shen/shen\.timer-macro X))
           (shen/lambda X
                        (shen/shen\.cases-macro X))
           (shen/lambda X
                        (shen/shen\.abs-macro X))
           (shen/lambda X
                        (shen/shen\.put/get-macro X))
           (shen/lambda X
                        (shen/shen\.compile-macro X))
           (shen/lambda X
                        (shen/shen\.datatype-macro X))
           (shen/lambda X
                        (shen/shen\.let-macro X))
           (shen/lambda X
                        (shen/shen\.assoc-macro X))
           (shen/lambda X
                        (shen/shen\.make-string-macro X))
           (shen/lambda X
                        (shen/shen\.output-macro X))
           (shen/lambda X
                        (shen/shen\.input-macro X))
           (shen/lambda X
                        (shen/shen\.error-macro X))
           (shen/lambda X
                        (shen/shen\.prolog-macro X))
           (shen/lambda X
                        (shen/shen\.synonyms-macro X))
           (shen/lambda X
                        (shen/shen\.nl-macro X))
           (shen/lambda X
                        (shen/shen\.@s-macro X))
           (shen/lambda X
                        (shen/shen\.defprolog-macro X))
           (shen/lambda X
                        (shen/shen\.function-macro X))))
(shen/set '*home-directory* nil)
(shen/set 'shen\.*gensym* 0)
(shen/set 'shen\.*tracking* nil)
(shen/set '*home-directory* "")
(shen/set 'shen\.*alphabet*
          (list 'A 'B 'C 'D 'E 'F 'G 'H 'I 'J 'K 'L 'M 'N 'O 'P 'Q 'R 'S 'T 'U 'V 'W 'X 'Y 'Z))
(shen/set 'shen\.*special*
          (list '@p '@s '@v 'cons 'lambda 'let 'where 'set 'open))
(shen/set 'shen\.*extraspecial*
          (list 'define 'shen\.process-datatype 'input+ 'defcc 'shen\.read+ 'defmacro))
(shen/set 'shen\.*spy* 'false)
(shen/set 'shen\.*datatypes* nil)
(shen/set 'shen\.*alldatatypes* nil)
(shen/set 'shen\.*shen-type-theory-enabled\?* 'true)
(shen/set 'shen\.*synonyms* nil)
(shen/set 'shen\.*system* nil)
(shen/set 'shen\.*signedfuncs* nil)
(shen/set 'shen\.*maxcomplexity* 128)
(shen/set 'shen\.*occurs* 'true)
(shen/set 'shen\.*maxinferences* 1000000)
(shen/set '*maximum-print-sequence-size* 20)
(shen/set 'shen\.*catch* 0)
(shen/set 'shen\.*call* 0)
(shen/set 'shen\.*infs* 0)
(shen/set '*hush* 'false)
(shen/set 'shen\.*optimise* 'false)
(shen/set '*version* "Shen 19.2")
(defun shen/shen\.initialise_arity_table
    (V13378)
  (cl-flet
      ((tail-trampoline
        (V13378)
        (shen/cond
         ((shen/predicate->shen
           (null V13378))
          nil)
         ((shen/and
           (shen/cons\? V13378)
           (shen/cons\?
            (nthcdr 1 V13378)))
          (shen/let DecArity
                    (shen/put
                     (shen/hd V13378)
                     'arity
                     (shen/hd
                      (nthcdr 1 V13378))
                     (shen/value '*property-vector*))
                    (vector
                     (list
                      (nthcdr 2 V13378)))))
         (shen/true
          (shen/shen\.f_error 'shen\.initialise_arity_table)))))
    (let
        ((result
          (funcall #'tail-trampoline V13378)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/arity
    (V13380)
  (shen/trap-error
   (shen/get V13380 'arity
             (shen/value '*property-vector*))
   (shen/lambda E -1)))
(shen/shen\.initialise_arity_table
 (list 'abort 0 'absvector\? 1 'absvector 1 'adjoin 2 'and 2 'append 2 'arity 1 'assoc 2 'boolean\? 1 'cd 1 'compile 3 'concat 2 'cons 2 'cons\? 1 'cn 2 'declare 2 'destroy 1 'difference 2 'do 2 'element\? 2 'empty\? 1 'enable-type-theory 1 'shen\.interror 2 'eval 1 'eval-kl 1 'explode 1 'external 1 'fail-if 2 'fail 0 'fix 2 'findall 5 'freeze 1 'fst 1 'gensym 1 'get 3 'get-time 1 'address-> 3 '<-address 2 '<-vector 2 '> 2 '>= 2 '= 2 'hd 1 'hdv 1 'hdstr 1 'head 1 'if 3 'integer\? 1 'intern 1 'identical 4 'inferences 0 'input 1 'input+ 2 'implementation 0 'intersection 2 'internal 1 'it 0 'kill 0 'language 0 'length 1 'lineread 1 'load 1 '< 2 '<= 2 'vector 1 'macroexpand 1 'map 2 'mapcan 2 'maxinferences 1 'not 1 'nth 2 'n->string 1 'number\? 1 'occurs-check 1 'occurrences 2 'occurs-check 1 'optimise 1 'or 2 'os 0 'package 3 'package\? 1 'port 0 'porters 0 'pos 2 'print 1 'profile 1 'profile-results 1 'pr 2 'ps 1 'preclude 1 'preclude-all-but 1 'protect 1 'address-> 3 'put 4 'shen\.reassemble 2 'read-file-as-string 1 'read-file 1 'read 1 'read-byte 1 'read-from-string 1 'receive 1 'release 0 'remove 2 'require 3 'reverse 1 'set 2 'simple-error 1 'snd 1 'specialise 1 'spy 1 'step 1 'stinput 0 'stoutput 0 'string->n 1 'string->symbol 1 'string\? 1 'subst 3 'sum 1 'symbol\? 1 'systemf 1 'tail 1 'tl 1 'tc 1 'tc\? 0 'thaw 1 'tlstr 1 'track 1 'trap-error 2 'tuple\? 1 'type 2 'return 3 'undefmacro 1 'unput 3 'unprofile 1 'unify 4 'unify! 4 'union 2 'untrack 1 'unspecialise 1 'undefmacro 1 'vector 1 'vector-> 3 'value 1 'variable\? 1 'version 0 'write-byte 2 'write-to-file 2 'y-or-n\? 1 '+ 2 '* 2 '/ 2 '- 2 '== 2 '<e> 1 '@p 2 '@v 2 '@s 2 'preclude 1 'include 1 'preclude-all-but 1 'include-all-but 1))
(defun shen/systemf
    (V13382)
  (shen/let Shen
            (shen/intern "shen")
            (shen/let External
                      (shen/get Shen 'shen\.external-symbols
                                (shen/value '*property-vector*))
                      (shen/let Place
                                (shen/put Shen 'shen\.external-symbols
                                          (shen/adjoin V13382 External)
                                          (shen/value '*property-vector*))
                                V13382))))
(defun shen/adjoin
    (V13385 V13386)
  (shen/if
   (shen/element\? V13385 V13386)
   V13386
   (append
    (list V13385)
    V13386)))
(shen/put
 (shen/intern "shen")
 'shen\.external-symbols
 (list '! '} '{ '--> '<-- '&& ': '\; ':- ':= '_ '*language* '*implementation* '*stinput* '*stoutput* '*home-directory* '*version* '*maximum-print-sequence-size* '*macros* '*os* '*release* '*property-vector* '@v '@p '@s '*port* '*porters* '*hush* '<- '-> '<e> '== '= '>= '> '/\. '=! '$ '- '/ '* '+ '<= '< '>>
       (shen/vector 0)
       'y-or-n\? 'write-to-file 'write-byte 'where 'when 'warn 'version 'verified 'variable\? 'value 'vector-> '<-vector 'vector 'vector\? 'unspecialise 'untrack 'unit 'shen\.unix 'union 'unify 'unify! 'unput 'unprofile 'undefmacro 'return 'type 'tuple\? 'true 'trap-error 'track 'time 'thaw 'tc\? 'tc 'tl 'tlstr 'tlv 'tail 'systemf 'synonyms 'symbol 'symbol\? 'string->symbol 'sum 'subst 'string\? 'string->n 'stream 'string 'stinput 'stoutput 'step 'spy 'specialise 'snd 'simple-error 'set 'save 'str 'run 'reverse 'remove 'release 'read 'receive 'read-file 'read-file-as-bytelist 'read-file-as-string 'read-byte 'read-from-string 'package\? 'put 'preclude 'preclude-all-but 'ps 'prolog\? 'protect 'profile-results 'profile 'print 'pr 'pos 'porters 'port 'package 'output 'out 'os 'or 'optimise 'open 'occurrences 'occurs-check 'n->string 'number\? 'number 'null 'nth 'not 'nl 'mode 'macroexpand 'maxinferences 'mapcan 'map 'make-string 'load 'loaded 'list 'lineread 'limit 'length 'let 'lazy 'lambda 'language 'kill 'is 'intersection 'inferences 'intern 'integer\? 'input 'input+ 'include 'include-all-but 'it 'in 'internal 'implementation 'if 'identical 'head 'hd 'hdv 'hdstr 'hash 'get 'get-time 'gensym 'function 'fst 'freeze 'fix 'file 'fail 'fail-if 'fwhen 'findall 'false 'enable-type-theory 'explode 'external 'exception 'eval-kl 'eval 'error-to-string 'error 'empty\? 'element\? 'do 'difference 'destroy 'defun 'define 'defmacro 'defcc 'defprolog 'declare 'datatype 'cut 'cn 'cons\? 'cons 'cond 'concat 'compile 'cd 'cases 'call 'close 'bind 'bound\? 'boolean\? 'boolean 'bar! 'assoc 'arity 'append 'and 'adjoin '<-address 'address-> 'absvector\? 'absvector 'abort)
 (shen/value '*property-vector*))
(defun shen/shen\.symbol-table-entry
    (V13388)
  (shen/let ArityF
            (shen/arity V13388)
            (shen/if
             (shen/= ArityF -1)
             nil
             (shen/if
              (shen/= ArityF 0)
              nil
              (list
               (append
                (list V13388)
                (shen/eval-kl
                 (shen/shen\.lambda-form V13388 ArityF))))))))
(defun shen/shen\.lambda-form
    (V13391 V13392)
  (shen/cond
   ((shen/= 0 V13392)
    V13391)
   (shen/true
    (shen/let X
              (shen/gensym 'V)
              (list 'lambda X
                    (shen/shen\.lambda-form
                     (shen/shen\.add-end V13391 X)
                     (shen/- V13392 1)))))))
(defun shen/shen\.add-end
    (V13395 V13396)
  (shen/cond
   ((shen/cons\? V13395)
    (shen/append V13395
                 (list V13396)))
   (shen/true
    (list V13395 V13396))))
(shen/set 'shen\.*symbol-table*
          (append
           (list
            (append
             (list 'shen\.datatype-error)
             (shen/lambda X
                          (shen/shen\.datatype-error X)))
            (append
             (list 'shen\.tuple)
             (shen/lambda X
                          (shen/shen\.tuple X)))
            (append
             (list 'shen\.pvar)
             (shen/lambda X
                          (shen/shen\.pvar X))))
           (shen/mapcan
            (shen/lambda X
                         (shen/shen\.symbol-table-entry X))
            (shen/external
             (shen/intern "shen")))))
(defun shen/specialise
    (V13398)
  (shen/do
   (shen/set 'shen\.*special*
             (append
              (list V13398)
              (shen/value 'shen\.*special*)))
   V13398))
(defun shen/unspecialise
    (V13400)
  (shen/do
   (shen/set 'shen\.*special*
             (shen/remove V13400
                          (shen/value 'shen\.*special*)))
   V13400))
(defun shen/declare
    (V15776 V15777)
  (shen/let Record
            (shen/set 'shen\.*signedfuncs*
                      (append
                       (list
                        (append
                         (list V15776)
                         V15777))
                       (shen/value 'shen\.*signedfuncs*)))
            (shen/let Variancy
                      (shen/trap-error
                       (shen/shen\.variancy-test V15776 V15777)
                       (shen/lambda E 'shen\.skip))
                      (shen/let Type
                                (shen/shen\.rcons_form
                                 (shen/shen\.demodulate V15777))
                                (shen/let F*
                                          (shen/concat 'shen\.type-signature-of- V15776)
                                          (shen/let Parameters
                                                    (shen/shen\.parameters 1)
                                                    (shen/let Clause
                                                              (list
                                                               (list F* 'X)
                                                               ':-
                                                               (list
                                                                (list 'unify! 'X Type)))
                                                              (shen/let AUM_instruction
                                                                        (shen/shen\.aum Clause Parameters)
                                                                        (shen/let Code
                                                                                  (shen/shen\.aum_to_shen AUM_instruction)
                                                                                  (shen/let ShenDef
                                                                                            (append
                                                                                             (list 'define F*)
                                                                                             (shen/append Parameters
                                                                                                          (shen/append
                                                                                                           (list 'ProcessN 'Continuation)
                                                                                                           (list '-> Code))))
                                                                                            (shen/let Eval
                                                                                                      (shen/shen\.eval-without-macros ShenDef)
                                                                                                      V15776)))))))))))
(defun shen/shen\.demodulate
    (V15779)
  (cl-flet
      ((tail-trampoline
        (V15779)
        (shen/trap-error
         (shen/let Demod
                   (shen/shen\.walk
                    (shen/lambda Y
                                 (shen/shen\.demod Y))
                    V15779)
                   (shen/if
                    (shen/= Demod V15779)
                    V15779
                    (vector
                     (list Demod))))
         (shen/lambda E V15779))))
    (let
        ((result
          (funcall #'tail-trampoline V15779)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.variancy-test
    (V15782 V15783)
  (shen/let TypeF
            (shen/shen\.typecheck V15782 'B)
            (shen/let Check
                      (shen/if
                       (shen/= 'symbol TypeF)
                       'shen\.skip
                       (shen/if
                        (shen/shen\.variant\? TypeF V15783)
                        'shen\.skip
                        (shen/shen\.prhush
                         (shen/cn "warning: changing the type of "
                                  (shen/shen\.app V15782 " may create errors\n" 'shen\.a))
                         (shen/stoutput))))
                      'shen\.skip)))
(defun shen/shen\.variant\?
    (V15796 V15797)
  (cl-flet
      ((tail-trampoline
        (V15796 V15797)
        (shen/cond
         ((shen/= V15797 V15796)
          'true)
         ((shen/and
           (shen/cons\? V15796)
           (shen/and
            (shen/cons\? V15797)
            (shen/=
             (shen/hd V15797)
             (shen/hd V15796))))
          (vector
           (list
            (nthcdr 1 V15796)
            (nthcdr 1 V15797))))
         ((shen/and
           (shen/cons\? V15796)
           (shen/and
            (shen/cons\? V15797)
            (shen/and
             (shen/shen\.pvar\?
              (shen/hd V15796))
             (shen/variable\?
              (shen/hd V15797)))))
          (vector
           (list
            (shen/subst 'shen\.a
                        (shen/hd V15796)
                        (nthcdr 1 V15796))
            (shen/subst 'shen\.a
                        (shen/hd V15797)
                        (nthcdr 1 V15797)))))
         ((shen/and
           (shen/cons\? V15796)
           (shen/and
            (shen/cons\?
             (shen/hd V15796))
            (shen/and
             (shen/cons\? V15797)
             (shen/cons\?
              (shen/hd V15797)))))
          (vector
           (list
            (shen/append
             (shen/hd V15796)
             (nthcdr 1 V15796))
            (shen/append
             (shen/hd V15797)
             (nthcdr 1 V15797)))))
         (shen/true 'false))))
    (let
        ((result
          (funcall #'tail-trampoline V15796 V15797)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(shen/declare 'absvector\?
              (list 'A '--> 'boolean))
(shen/declare 'adjoin
              (list 'A '-->
                    (list
                     (list 'list 'A)
                     '-->
                     (list 'list 'A))))
(shen/declare 'and
              (list 'boolean '-->
                    (list 'boolean '--> 'boolean)))
(shen/declare 'shen\.app
              (list 'A '-->
                    (list 'string '-->
                          (list 'symbol '--> 'string))))
(shen/declare 'append
              (list
               (list 'list 'A)
               '-->
               (list
                (list 'list 'A)
                '-->
                (list 'list 'A))))
(shen/declare 'arity
              (list 'A '--> 'number))
(shen/declare 'assoc
              (list 'A '-->
                    (list
                     (list 'list
                           (list 'list 'A))
                     '-->
                     (list 'list 'A))))
(shen/declare 'boolean\?
              (list 'A '--> 'boolean))
(shen/declare 'bound\?
              (list 'symbol '--> 'boolean))
(shen/declare 'cd
              (list 'string '--> 'string))
(shen/declare 'close
              (list
               (list 'stream 'A)
               '-->
               (list 'list 'B)))
(shen/declare 'cn
              (list 'string '-->
                    (list 'string '--> 'string)))
(shen/declare 'compile
              (list
               (list 'A 'shen\.==> 'B)
               '-->
               (list 'A '-->
                     (list
                      (list 'A '--> 'B)
                      '--> 'B))))
(shen/declare 'cons\?
              (list 'A '--> 'boolean))
(shen/declare 'destroy
              (list
               (list 'A '--> 'B)
               '--> 'symbol))
(shen/declare 'difference
              (list
               (list 'list 'A)
               '-->
               (list
                (list 'list 'A)
                '-->
                (list 'list 'A))))
(shen/declare 'do
              (list 'A '-->
                    (list 'B '--> 'B)))
(shen/declare '<e>
              (list
               (list 'list 'A)
               'shen\.==>
               (list 'list 'B)))
(shen/declare 'shen\.<!>
              (list
               (list 'list 'A)
               'shen\.==>
               (list 'list 'A)))
(shen/declare 'element\?
              (list 'A '-->
                    (list
                     (list 'list 'A)
                     '--> 'boolean)))
(shen/declare 'empty\?
              (list 'A '--> 'boolean))
(shen/declare 'enable-type-theory
              (list 'symbol '--> 'boolean))
(shen/declare 'external
              (list 'symbol '-->
                    (list 'list 'symbol)))
(shen/declare 'error-to-string
              (list 'exception '--> 'string))
(shen/declare 'explode
              (list 'A '-->
                    (list 'list 'string)))
(shen/declare 'fail
              (list '--> 'symbol))
(shen/declare 'fail-if
              (list
               (list 'symbol '--> 'boolean)
               '-->
               (list 'symbol '--> 'symbol)))
(shen/declare 'fix
              (list
               (list 'A '--> 'A)
               '-->
               (list 'A '--> 'A)))
(shen/declare 'freeze
              (list 'A '-->
                    (list 'lazy 'A)))
(shen/declare 'fst
              (list
               (list 'A '* 'B)
               '--> 'A))
(shen/declare 'function
              (list
               (list 'A '--> 'B)
               '-->
               (list 'A '--> 'B)))
(shen/declare 'gensym
              (list 'symbol '--> 'symbol))
(shen/declare '<-vector
              (list
               (list 'vector 'A)
               '-->
               (list 'number '--> 'A)))
(shen/declare 'vector->
              (list
               (list 'vector 'A)
               '-->
               (list 'number '-->
                     (list 'A '-->
                           (list 'vector 'A)))))
(shen/declare 'vector
              (list 'number '-->
                    (list 'vector 'A)))
(shen/declare 'get-time
              (list 'symbol '--> 'number))
(shen/declare 'hash
              (list 'A '-->
                    (list 'number '--> 'number)))
(shen/declare 'head
              (list
               (list 'list 'A)
               '--> 'A))
(shen/declare 'hdv
              (list
               (list 'vector 'A)
               '--> 'A))
(shen/declare 'hdstr
              (list 'string '--> 'string))
(shen/declare 'if
              (list 'boolean '-->
                    (list 'A '-->
                          (list 'A '--> 'A))))
(shen/declare 'it
              (list '--> 'string))
(shen/declare 'implementation
              (list '--> 'string))
(shen/declare 'include
              (list
               (list 'list 'symbol)
               '-->
               (list 'list 'symbol)))
(shen/declare 'include-all-but
              (list
               (list 'list 'symbol)
               '-->
               (list 'list 'symbol)))
(shen/declare 'inferences
              (list '--> 'number))
(shen/declare 'shen\.insert
              (list 'A '-->
                    (list 'string '--> 'string)))
(shen/declare 'integer\?
              (list 'A '--> 'boolean))
(shen/declare 'internal
              (list 'symbol '-->
                    (list 'list 'symbol)))
(shen/declare 'intersection
              (list
               (list 'list 'A)
               '-->
               (list
                (list 'list 'A)
                '-->
                (list 'list 'A))))
(shen/declare 'kill
              (list '--> 'A))
(shen/declare 'language
              (list '--> 'string))
(shen/declare 'length
              (list
               (list 'list 'A)
               '--> 'number))
(shen/declare 'limit
              (list
               (list 'vector 'A)
               '--> 'number))
(shen/declare 'load
              (list 'string '--> 'symbol))
(shen/declare 'map
              (list
               (list 'A '--> 'B)
               '-->
               (list
                (list 'list 'A)
                '-->
                (list 'list 'B))))
(shen/declare 'mapcan
              (list
               (list 'A '-->
                     (list 'list 'B))
               '-->
               (list
                (list 'list 'A)
                '-->
                (list 'list 'B))))
(shen/declare 'maxinferences
              (list 'number '--> 'number))
(shen/declare 'n->string
              (list 'number '--> 'string))
(shen/declare 'nl
              (list 'number '--> 'number))
(shen/declare 'not
              (list 'boolean '--> 'boolean))
(shen/declare 'nth
              (list 'number '-->
                    (list
                     (list 'list 'A)
                     '--> 'A)))
(shen/declare 'number\?
              (list 'A '--> 'boolean))
(shen/declare 'occurrences
              (list 'A '-->
                    (list 'B '--> 'number)))
(shen/declare 'occurs-check
              (list 'symbol '--> 'boolean))
(shen/declare 'optimise
              (list 'symbol '--> 'boolean))
(shen/declare 'or
              (list 'boolean '-->
                    (list 'boolean '--> 'boolean)))
(shen/declare 'os
              (list '--> 'string))
(shen/declare 'package\?
              (list 'symbol '--> 'boolean))
(shen/declare 'port
              (list '--> 'string))
(shen/declare 'porters
              (list '--> 'string))
(shen/declare 'pos
              (list 'string '-->
                    (list 'number '--> 'string)))
(shen/declare 'pr
              (list 'string '-->
                    (list
                     (list 'stream 'out)
                     '--> 'string)))
(shen/declare 'print
              (list 'A '--> 'A))
(shen/declare 'profile
              (list
               (list 'A '--> 'B)
               '-->
               (list 'A '--> 'B)))
(shen/declare 'preclude
              (list
               (list 'list 'symbol)
               '-->
               (list 'list 'symbol)))
(shen/declare 'shen\.proc-nl
              (list 'string '--> 'string))
(shen/declare 'profile-results
              (list
               (list 'A '--> 'B)
               '-->
               (list
                (list 'A '--> 'B)
                '* 'number)))
(shen/declare 'protect
              (list 'symbol '--> 'symbol))
(shen/declare 'preclude-all-but
              (list
               (list 'list 'symbol)
               '-->
               (list 'list 'symbol)))
(shen/declare 'shen\.prhush
              (list 'string '-->
                    (list
                     (list 'stream 'out)
                     '--> 'string)))
(shen/declare 'ps
              (list 'symbol '-->
                    (list 'list 'unit)))
(shen/declare 'read
              (list
               (list 'stream 'in)
               '--> 'unit))
(shen/declare 'read-byte
              (list
               (list 'stream 'in)
               '--> 'number))
(shen/declare 'read-file-as-bytelist
              (list 'string '-->
                    (list 'list 'number)))
(shen/declare 'read-file-as-string
              (list 'string '--> 'string))
(shen/declare 'read-file
              (list 'string '-->
                    (list 'list 'unit)))
(shen/declare 'read-from-string
              (list 'string '-->
                    (list 'list 'unit)))
(shen/declare 'release
              (list '--> 'string))
(shen/declare 'remove
              (list 'A '-->
                    (list
                     (list 'list 'A)
                     '-->
                     (list 'list 'A))))
(shen/declare 'reverse
              (list
               (list 'list 'A)
               '-->
               (list 'list 'A)))
(shen/declare 'simple-error
              (list 'string '--> 'A))
(shen/declare 'snd
              (list
               (list 'A '* 'B)
               '--> 'B))
(shen/declare 'specialise
              (list 'symbol '--> 'symbol))
(shen/declare 'spy
              (list 'symbol '--> 'boolean))
(shen/declare 'step
              (list 'symbol '--> 'boolean))
(shen/declare 'stinput
              (list '-->
                    (list 'stream 'in)))
(shen/declare 'stoutput
              (list '-->
                    (list 'stream 'out)))
(shen/declare 'string\?
              (list 'A '--> 'boolean))
(shen/declare 'str
              (list 'A '--> 'string))
(shen/declare 'string->n
              (list 'string '--> 'number))
(shen/declare 'string->symbol
              (list 'string '--> 'symbol))
(shen/declare 'sum
              (list
               (list 'list 'number)
               '--> 'number))
(shen/declare 'symbol\?
              (list 'A '--> 'boolean))
(shen/declare 'systemf
              (list 'symbol '--> 'symbol))
(shen/declare 'tail
              (list
               (list 'list 'A)
               '-->
               (list 'list 'A)))
(shen/declare 'tlstr
              (list 'string '--> 'string))
(shen/declare 'tlv
              (list
               (list 'vector 'A)
               '-->
               (list 'vector 'A)))
(shen/declare 'tc
              (list 'symbol '--> 'boolean))
(shen/declare 'tc\?
              (list '--> 'boolean))
(shen/declare 'thaw
              (list
               (list 'lazy 'A)
               '--> 'A))
(shen/declare 'track
              (list 'symbol '--> 'symbol))
(shen/declare 'trap-error
              (list 'A '-->
                    (list
                     (list 'exception '--> 'A)
                     '--> 'A)))
(shen/declare 'tuple\?
              (list 'A '--> 'boolean))
(shen/declare 'undefmacro
              (list 'symbol '--> 'symbol))
(shen/declare 'union
              (list
               (list 'list 'A)
               '-->
               (list
                (list 'list 'A)
                '-->
                (list 'list 'A))))
(shen/declare 'unprofile
              (list
               (list 'A '--> 'B)
               '-->
               (list 'A '--> 'B)))
(shen/declare 'untrack
              (list 'symbol '--> 'symbol))
(shen/declare 'unspecialise
              (list 'symbol '--> 'symbol))
(shen/declare 'variable\?
              (list 'A '--> 'boolean))
(shen/declare 'vector\?
              (list 'A '--> 'boolean))
(shen/declare 'version
              (list '--> 'string))
(shen/declare 'write-to-file
              (list 'string '-->
                    (list 'A '--> 'A)))
(shen/declare 'write-byte
              (list 'number '-->
                    (list
                     (list 'stream 'out)
                     '--> 'number)))
(shen/declare 'y-or-n\?
              (list 'string '--> 'boolean))
(shen/declare '>
              (list 'number '-->
                    (list 'number '--> 'boolean)))
(shen/declare '<
              (list 'number '-->
                    (list 'number '--> 'boolean)))
(shen/declare '>=
              (list 'number '-->
                    (list 'number '--> 'boolean)))
(shen/declare '<=
              (list 'number '-->
                    (list 'number '--> 'boolean)))
(shen/declare '=
              (list 'A '-->
                    (list 'A '--> 'boolean)))
(shen/declare '+
              (list 'number '-->
                    (list 'number '--> 'number)))
(shen/declare '/
              (list 'number '-->
                    (list 'number '--> 'number)))
(shen/declare '-
              (list 'number '-->
                    (list 'number '--> 'number)))
(shen/declare '*
              (list 'number '-->
                    (list 'number '--> 'number)))
(shen/declare '==
              (list 'A '-->
                    (list 'B '--> 'boolean)))
(defun shen/shen\.typecheck
    (V15299 V15300)
  (shen/let Curry
            (shen/shen\.curry V15299)
            (shen/let ProcessN
                      (shen/shen\.start-new-prolog-process)
                      (shen/let Type
                                (shen/shen\.insert-prolog-variables
                                 (shen/shen\.demodulate
                                  (shen/shen\.curry-type V15300))
                                 ProcessN)
                                (shen/let Continuation
                                          (shen/freeze
                                           (shen/return Type ProcessN 'shen\.void))
                                          (shen/shen\.t*
                                           (list Curry ': Type)
                                           nil ProcessN Continuation))))))
(defun shen/shen\.curry
    (V15302)
  (cl-flet
      ((tail-trampoline
        (V15302)
        (shen/cond
         ((shen/and
           (shen/cons\? V15302)
           (shen/shen\.special\?
            (shen/hd V15302)))
          (append
           (list
            (shen/hd V15302))
           (shen/map
            (shen/lambda Y
                         (shen/shen\.curry Y))
            (nthcdr 1 V15302))))
         ((shen/and
           (shen/cons\? V15302)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V15302))
            (shen/shen\.extraspecial\?
             (shen/hd V15302))))
          V15302)
         ((shen/and
           (shen/cons\? V15302)
           (shen/and
            (shen/= 'type
                    (shen/hd V15302))
            (shen/and
             (shen/cons\?
              (nthcdr 1 V15302))
             (shen/and
              (shen/cons\?
               (nthcdr 2 V15302))
              (shen/predicate->shen
               (null
                (nthcdr 3 V15302)))))))
          (append
           (list 'type
                 (shen/shen\.curry
                  (shen/hd
                   (nthcdr 1 V15302))))
           (nthcdr 2 V15302)))
         ((shen/and
           (shen/cons\? V15302)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V15302))
            (shen/cons\?
             (nthcdr 2 V15302))))
          (vector
           (list
            (append
             (list
              (list
               (shen/hd V15302)
               (shen/hd
                (nthcdr 1 V15302))))
             (nthcdr 2 V15302)))))
         ((shen/and
           (shen/cons\? V15302)
           (shen/and
            (shen/cons\?
             (nthcdr 1 V15302))
            (shen/predicate->shen
             (null
              (nthcdr 2 V15302)))))
          (list
           (shen/shen\.curry
            (shen/hd V15302))
           (shen/shen\.curry
            (shen/hd
             (nthcdr 1 V15302)))))
         (shen/true V15302))))
    (let
        ((result
          (funcall #'tail-trampoline V15302)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.special\?
    (V15304)
  (shen/element\? V15304
                  (shen/value 'shen\.*special*)))
(defun shen/shen\.extraspecial\?
    (V15306)
  (shen/element\? V15306
                  (shen/value 'shen\.*extraspecial*)))
(defun shen/shen\.t*
    (V15311 V15312 V15313 V15314)
  (shen/let Throwcontrol
            (shen/shen\.catchpoint)
            (shen/shen\.cutpoint Throwcontrol
                                 (shen/let Case
                                           (shen/let Error
                                                     (shen/shen\.newpv V15313)
                                                     (shen/do
                                                      (shen/shen\.incinfs)
                                                      (shen/fwhen
                                                       (shen/shen\.maxinfexceeded\?)
                                                       V15313
                                                       (shen/freeze
                                                        (shen/bind Error
                                                                   (shen/shen\.errormaxinfs)
                                                                   V15313 V15314)))))
                                           (shen/if
                                            (shen/= Case 'false)
                                            (shen/let Case
                                                      (shen/let V15291
                                                                (shen/shen\.lazyderef V15311 V15313)
                                                                (shen/if
                                                                 (shen/= 'fail V15291)
                                                                 (shen/do
                                                                  (shen/shen\.incinfs)
                                                                  (shen/cut Throwcontrol V15313
                                                                            (shen/freeze
                                                                             (shen/shen\.prolog-failure V15313 V15314))))
                                                                 'false))
                                                      (shen/if
                                                       (shen/= Case 'false)
                                                       (shen/let Case
                                                                 (shen/let V15292
                                                                           (shen/shen\.lazyderef V15311 V15313)
                                                                           (shen/if
                                                                            (shen/cons\? V15292)
                                                                            (shen/let X
                                                                                      (shen/hd V15292)
                                                                                      (shen/let V15293
                                                                                                (shen/shen\.lazyderef
                                                                                                 (nthcdr 1 V15292)
                                                                                                 V15313)
                                                                                                (shen/if
                                                                                                 (shen/cons\? V15293)
                                                                                                 (shen/let V15294
                                                                                                           (shen/shen\.lazyderef
                                                                                                            (shen/hd V15293)
                                                                                                            V15313)
                                                                                                           (shen/if
                                                                                                            (shen/= ': V15294)
                                                                                                            (shen/let V15295
                                                                                                                      (shen/shen\.lazyderef
                                                                                                                       (nthcdr 1 V15293)
                                                                                                                       V15313)
                                                                                                                      (shen/if
                                                                                                                       (shen/cons\? V15295)
                                                                                                                       (shen/let A
                                                                                                                                 (shen/hd V15295)
                                                                                                                                 (shen/let V15296
                                                                                                                                           (shen/shen\.lazyderef
                                                                                                                                            (nthcdr 1 V15295)
                                                                                                                                            V15313)
                                                                                                                                           (shen/if
                                                                                                                                            (shen/predicate->shen
                                                                                                                                             (null V15296))
                                                                                                                                            (shen/do
                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                             (shen/fwhen
                                                                                                                                              (shen/shen\.type-theory-enabled\?)
                                                                                                                                              V15313
                                                                                                                                              (shen/freeze
                                                                                                                                               (shen/cut Throwcontrol V15313
                                                                                                                                                         (shen/freeze
                                                                                                                                                          (shen/shen\.th* X A V15312 V15313 V15314))))))
                                                                                                                                            'false)))
                                                                                                                       'false))
                                                                                                            'false))
                                                                                                 'false)))
                                                                            'false))
                                                                 (shen/if
                                                                  (shen/= Case 'false)
                                                                  (shen/let Datatypes
                                                                            (shen/shen\.newpv V15313)
                                                                            (shen/do
                                                                             (shen/shen\.incinfs)
                                                                             (shen/shen\.show V15311 V15312 V15313
                                                                                              (shen/freeze
                                                                                               (shen/bind Datatypes
                                                                                                          (shen/value 'shen\.*datatypes*)
                                                                                                          V15313
                                                                                                          (shen/freeze
                                                                                                           (shen/shen\.udefs* V15311 V15312 Datatypes V15313 V15314)))))))
                                                                  Case))
                                                       Case))
                                            Case)))))
(defun shen/shen\.type-theory-enabled\? nil
  (shen/value 'shen\.*shen-type-theory-enabled\?*))
(defun shen/enable-type-theory
    (V15320)
  (shen/cond
   ((shen/= '+ V15320)
    (shen/set 'shen\.*shen-type-theory-enabled\?* 'true))
   ((shen/= '- V15320)
    (shen/set 'shen\.*shen-type-theory-enabled\?* 'false))
   (shen/true
    (shen/simple-error "enable-type-theory expects a + or a -\n"))))
(defun shen/shen\.prolog-failure
    (V15331 V15332)
  'false)
(defun shen/shen\.maxinfexceeded\? nil
  (shen/>
   (shen/inferences)
   (shen/value 'shen\.*maxinferences*)))
(defun shen/shen\.errormaxinfs nil
  (shen/simple-error "maximum inferences exceeded~%"))
(defun shen/shen\.udefs*
    (V15338 V15339 V15340 V15341 V15342)
  (cl-flet
      ((tail-trampoline
        (V15338 V15339 V15340 V15341 V15342)
        (shen/let Case
                  (shen/let V15287
                            (shen/shen\.lazyderef V15340 V15341)
                            (shen/if
                             (shen/cons\? V15287)
                             (shen/let D
                                       (shen/hd V15287)
                                       (shen/do
                                        (shen/shen\.incinfs)
                                        (shen/call
                                         (list D V15338 V15339)
                                         V15341 V15342)))
                             'false))
                  (shen/if
                   (shen/= Case 'false)
                   (shen/let V15288
                             (shen/shen\.lazyderef V15340 V15341)
                             (shen/if
                              (shen/cons\? V15288)
                              (shen/let Ds
                                        (nthcdr 1 V15288)
                                        (shen/do
                                         (shen/shen\.incinfs)
                                         (vector
                                          (list V15338 V15339 Ds V15341 V15342))))
                              'false))
                   Case))))
    (let
        ((result
          (funcall #'tail-trampoline V15338 V15339 V15340 V15341 V15342)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.th*
    (V15348 V15349 V15350 V15351 V15352)
  (shen/let Throwcontrol
            (shen/shen\.catchpoint)
            (shen/shen\.cutpoint Throwcontrol
                                 (shen/let Case
                                           (shen/do
                                            (shen/shen\.incinfs)
                                            (shen/shen\.show
                                             (list V15348 ': V15349)
                                             V15350 V15351
                                             (shen/freeze
                                              (shen/fwhen 'false V15351 V15352))))
                                           (shen/if
                                            (shen/= Case 'false)
                                            (shen/let Case
                                                      (shen/let F
                                                                (shen/shen\.newpv V15351)
                                                                (shen/do
                                                                 (shen/shen\.incinfs)
                                                                 (shen/fwhen
                                                                  (shen/shen\.typedf\?
                                                                   (shen/shen\.lazyderef V15348 V15351))
                                                                  V15351
                                                                  (shen/freeze
                                                                   (shen/bind F
                                                                              (shen/shen\.sigf
                                                                               (shen/shen\.lazyderef V15348 V15351))
                                                                              V15351
                                                                              (shen/freeze
                                                                               (shen/call
                                                                                (list F V15349)
                                                                                V15351 V15352)))))))
                                                      (shen/if
                                                       (shen/= Case 'false)
                                                       (shen/let Case
                                                                 (shen/do
                                                                  (shen/shen\.incinfs)
                                                                  (shen/shen\.base V15348 V15349 V15351 V15352))
                                                                 (shen/if
                                                                  (shen/= Case 'false)
                                                                  (shen/let Case
                                                                            (shen/do
                                                                             (shen/shen\.incinfs)
                                                                             (shen/shen\.by_hypothesis V15348 V15349 V15350 V15351 V15352))
                                                                            (shen/if
                                                                             (shen/= Case 'false)
                                                                             (shen/let Case
                                                                                       (shen/let V15183
                                                                                                 (shen/shen\.lazyderef V15348 V15351)
                                                                                                 (shen/if
                                                                                                  (shen/cons\? V15183)
                                                                                                  (shen/let F
                                                                                                            (shen/hd V15183)
                                                                                                            (shen/let V15184
                                                                                                                      (shen/shen\.lazyderef
                                                                                                                       (nthcdr 1 V15183)
                                                                                                                       V15351)
                                                                                                                      (shen/if
                                                                                                                       (shen/predicate->shen
                                                                                                                        (null V15184))
                                                                                                                       (shen/do
                                                                                                                        (shen/shen\.incinfs)
                                                                                                                        (shen/shen\.th* F
                                                                                                                                        (list '--> V15349)
                                                                                                                                        V15350 V15351 V15352))
                                                                                                                       'false)))
                                                                                                  'false))
                                                                                       (shen/if
                                                                                        (shen/= Case 'false)
                                                                                        (shen/let Case
                                                                                                  (shen/let V15185
                                                                                                            (shen/shen\.lazyderef V15348 V15351)
                                                                                                            (shen/if
                                                                                                             (shen/cons\? V15185)
                                                                                                             (shen/let F
                                                                                                                       (shen/hd V15185)
                                                                                                                       (shen/let V15186
                                                                                                                                 (shen/shen\.lazyderef
                                                                                                                                  (nthcdr 1 V15185)
                                                                                                                                  V15351)
                                                                                                                                 (shen/if
                                                                                                                                  (shen/cons\? V15186)
                                                                                                                                  (shen/let X
                                                                                                                                            (shen/hd V15186)
                                                                                                                                            (shen/let V15187
                                                                                                                                                      (shen/shen\.lazyderef
                                                                                                                                                       (nthcdr 1 V15186)
                                                                                                                                                       V15351)
                                                                                                                                                      (shen/if
                                                                                                                                                       (shen/predicate->shen
                                                                                                                                                        (null V15187))
                                                                                                                                                       (shen/let B
                                                                                                                                                                 (shen/shen\.newpv V15351)
                                                                                                                                                                 (shen/do
                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                  (shen/shen\.th* F
                                                                                                                                                                                  (list B '--> V15349)
                                                                                                                                                                                  V15350 V15351
                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                   (shen/shen\.th* X B V15350 V15351 V15352)))))
                                                                                                                                                       'false)))
                                                                                                                                  'false)))
                                                                                                             'false))
                                                                                                  (shen/if
                                                                                                   (shen/= Case 'false)
                                                                                                   (shen/let Case
                                                                                                             (shen/let V15188
                                                                                                                       (shen/shen\.lazyderef V15348 V15351)
                                                                                                                       (shen/if
                                                                                                                        (shen/cons\? V15188)
                                                                                                                        (shen/let V15189
                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                   (shen/hd V15188)
                                                                                                                                   V15351)
                                                                                                                                  (shen/if
                                                                                                                                   (shen/= 'cons V15189)
                                                                                                                                   (shen/let V15190
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (nthcdr 1 V15188)
                                                                                                                                              V15351)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/cons\? V15190)
                                                                                                                                              (shen/let X
                                                                                                                                                        (shen/hd V15190)
                                                                                                                                                        (shen/let V15191
                                                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                                                   (nthcdr 1 V15190)
                                                                                                                                                                   V15351)
                                                                                                                                                                  (shen/if
                                                                                                                                                                   (shen/cons\? V15191)
                                                                                                                                                                   (shen/let Y
                                                                                                                                                                             (shen/hd V15191)
                                                                                                                                                                             (shen/let V15192
                                                                                                                                                                                       (shen/shen\.lazyderef
                                                                                                                                                                                        (nthcdr 1 V15191)
                                                                                                                                                                                        V15351)
                                                                                                                                                                                       (shen/if
                                                                                                                                                                                        (shen/predicate->shen
                                                                                                                                                                                         (null V15192))
                                                                                                                                                                                        (shen/let V15193
                                                                                                                                                                                                  (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                  (shen/if
                                                                                                                                                                                                   (shen/cons\? V15193)
                                                                                                                                                                                                   (shen/let V15194
                                                                                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                                                                                              (shen/hd V15193)
                                                                                                                                                                                                              V15351)
                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                              (shen/= 'list V15194)
                                                                                                                                                                                                              (shen/let V15195
                                                                                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                                                                                         (nthcdr 1 V15193)
                                                                                                                                                                                                                         V15351)
                                                                                                                                                                                                                        (shen/if
                                                                                                                                                                                                                         (shen/cons\? V15195)
                                                                                                                                                                                                                         (shen/let A
                                                                                                                                                                                                                                   (shen/hd V15195)
                                                                                                                                                                                                                                   (shen/let V15196
                                                                                                                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                                                                                                                              (nthcdr 1 V15195)
                                                                                                                                                                                                                                              V15351)
                                                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                                                              (shen/predicate->shen
                                                                                                                                                                                                                                               (null V15196))
                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                               (shen/shen\.incinfs)
                                                                                                                                                                                                                                               (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                               (shen/freeze
                                                                                                                                                                                                                                                                (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                (list 'list A)
                                                                                                                                                                                                                                                                                V15350 V15351 V15352))))
                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                               (shen/shen\.pvar\? V15196)
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.bindv V15196 nil V15351)
                                                                                                                                                                                                                                                (shen/let Result
                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                                                           (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                            (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                            (list 'list A)
                                                                                                                                                                                                                                                                                            V15350 V15351 V15352))))
                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                           (shen/shen\.unbindv V15196 V15351)
                                                                                                                                                                                                                                                           Result)))
                                                                                                                                                                                                                                               'false))))
                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                          (shen/shen\.pvar\? V15195)
                                                                                                                                                                                                                          (shen/let A
                                                                                                                                                                                                                                    (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                     (shen/shen\.bindv V15195
                                                                                                                                                                                                                                                       (list A)
                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                     (shen/let Result
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                                                (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                (shen/freeze
                                                                                                                                                                                                                                                                 (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                 (list 'list A)
                                                                                                                                                                                                                                                                                 V15350 V15351 V15352))))
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.unbindv V15195 V15351)
                                                                                                                                                                                                                                                Result))))
                                                                                                                                                                                                                          'false)))
                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                               (shen/shen\.pvar\? V15194)
                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                (shen/shen\.bindv V15194 'list V15351)
                                                                                                                                                                                                                (shen/let Result
                                                                                                                                                                                                                          (shen/let V15197
                                                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                                                     (nthcdr 1 V15193)
                                                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                     (shen/cons\? V15197)
                                                                                                                                                                                                                                     (shen/let A
                                                                                                                                                                                                                                               (shen/hd V15197)
                                                                                                                                                                                                                                               (shen/let V15198
                                                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                                                          (nthcdr 1 V15197)
                                                                                                                                                                                                                                                          V15351)
                                                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                                                          (shen/predicate->shen
                                                                                                                                                                                                                                                           (null V15198))
                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                                                           (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                            (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                            (list 'list A)
                                                                                                                                                                                                                                                                                            V15350 V15351 V15352))))
                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                           (shen/shen\.pvar\? V15198)
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.bindv V15198 nil V15351)
                                                                                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                       (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                        (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                        (list 'list A)
                                                                                                                                                                                                                                                                                                        V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                       (shen/shen\.unbindv V15198 V15351)
                                                                                                                                                                                                                                                                       Result)))
                                                                                                                                                                                                                                                           'false))))
                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                      (shen/shen\.pvar\? V15197)
                                                                                                                                                                                                                                      (shen/let A
                                                                                                                                                                                                                                                (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.bindv V15197
                                                                                                                                                                                                                                                                   (list A)
                                                                                                                                                                                                                                                                   V15351)
                                                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                            (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                            (shen/freeze
                                                                                                                                                                                                                                                                             (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                             (list 'list A)
                                                                                                                                                                                                                                                                                             V15350 V15351 V15352))))
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.unbindv V15197 V15351)
                                                                                                                                                                                                                                                            Result))))
                                                                                                                                                                                                                                      'false)))
                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                           (shen/shen\.unbindv V15194 V15351)
                                                                                                                                                                                                                           Result)))
                                                                                                                                                                                                               'false)))
                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                    (shen/shen\.pvar\? V15193)
                                                                                                                                                                                                    (shen/let A
                                                                                                                                                                                                              (shen/shen\.newpv V15351)
                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                               (shen/shen\.bindv V15193
                                                                                                                                                                                                                                 (list 'list A)
                                                                                                                                                                                                                                 V15351)
                                                                                                                                                                                                               (shen/let Result
                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                                                                                          (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                           (shen/shen\.th* Y
                                                                                                                                                                                                                                                           (list 'list A)
                                                                                                                                                                                                                                                           V15350 V15351 V15352))))
                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                          (shen/shen\.unbindv V15193 V15351)
                                                                                                                                                                                                                          Result))))
                                                                                                                                                                                                    'false)))
                                                                                                                                                                                        'false)))
                                                                                                                                                                   'false)))
                                                                                                                                              'false))
                                                                                                                                   'false))
                                                                                                                        'false))
                                                                                                             (shen/if
                                                                                                              (shen/= Case 'false)
                                                                                                              (shen/let Case
                                                                                                                        (shen/let V15199
                                                                                                                                  (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                  (shen/if
                                                                                                                                   (shen/cons\? V15199)
                                                                                                                                   (shen/let V15200
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (shen/hd V15199)
                                                                                                                                              V15351)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/= '@p V15200)
                                                                                                                                              (shen/let V15201
                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                         (nthcdr 1 V15199)
                                                                                                                                                         V15351)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/cons\? V15201)
                                                                                                                                                         (shen/let X
                                                                                                                                                                   (shen/hd V15201)
                                                                                                                                                                   (shen/let V15202
                                                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                                                              (nthcdr 1 V15201)
                                                                                                                                                                              V15351)
                                                                                                                                                                             (shen/if
                                                                                                                                                                              (shen/cons\? V15202)
                                                                                                                                                                              (shen/let Y
                                                                                                                                                                                        (shen/hd V15202)
                                                                                                                                                                                        (shen/let V15203
                                                                                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                                                                                   (nthcdr 1 V15202)
                                                                                                                                                                                                   V15351)
                                                                                                                                                                                                  (shen/if
                                                                                                                                                                                                   (shen/predicate->shen
                                                                                                                                                                                                    (null V15203))
                                                                                                                                                                                                   (shen/let V15204
                                                                                                                                                                                                             (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                              (shen/cons\? V15204)
                                                                                                                                                                                                              (shen/let A
                                                                                                                                                                                                                        (shen/hd V15204)
                                                                                                                                                                                                                        (shen/let V15205
                                                                                                                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                                                                                                                   (nthcdr 1 V15204)
                                                                                                                                                                                                                                   V15351)
                                                                                                                                                                                                                                  (shen/if
                                                                                                                                                                                                                                   (shen/cons\? V15205)
                                                                                                                                                                                                                                   (shen/let V15206
                                                                                                                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                                                                                                                              (shen/hd V15205)
                                                                                                                                                                                                                                              V15351)
                                                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                                                              (shen/= '* V15206)
                                                                                                                                                                                                                                              (shen/let V15207
                                                                                                                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                                                                                                                         (nthcdr 1 V15205)
                                                                                                                                                                                                                                                         V15351)
                                                                                                                                                                                                                                                        (shen/if
                                                                                                                                                                                                                                                         (shen/cons\? V15207)
                                                                                                                                                                                                                                                         (shen/let B
                                                                                                                                                                                                                                                                   (shen/hd V15207)
                                                                                                                                                                                                                                                                   (shen/let V15208
                                                                                                                                                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                              (nthcdr 1 V15207)
                                                                                                                                                                                                                                                                              V15351)
                                                                                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                                                                                              (shen/predicate->shen
                                                                                                                                                                                                                                                                               (null V15208))
                                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                                               (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                               (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                               (shen/freeze
                                                                                                                                                                                                                                                                                                (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                                                               (shen/shen\.pvar\? V15208)
                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                (shen/shen\.bindv V15208 nil V15351)
                                                                                                                                                                                                                                                                                (shen/let Result
                                                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                           (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                            (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                                                           (shen/shen\.unbindv V15208 V15351)
                                                                                                                                                                                                                                                                                           Result)))
                                                                                                                                                                                                                                                                               'false))))
                                                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                                                          (shen/shen\.pvar\? V15207)
                                                                                                                                                                                                                                                          (shen/let B
                                                                                                                                                                                                                                                                    (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                                                     (shen/shen\.bindv V15207
                                                                                                                                                                                                                                                                                       (list B)
                                                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                                                     (shen/let Result
                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                (shen/freeze
                                                                                                                                                                                                                                                                                                 (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                (shen/shen\.unbindv V15207 V15351)
                                                                                                                                                                                                                                                                                Result))))
                                                                                                                                                                                                                                                          'false)))
                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                               (shen/shen\.pvar\? V15206)
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.bindv V15206 '* V15351)
                                                                                                                                                                                                                                                (shen/let Result
                                                                                                                                                                                                                                                          (shen/let V15209
                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                     (nthcdr 1 V15205)
                                                                                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                                                     (shen/cons\? V15209)
                                                                                                                                                                                                                                                                     (shen/let B
                                                                                                                                                                                                                                                                               (shen/hd V15209)
                                                                                                                                                                                                                                                                               (shen/let V15210
                                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                          (nthcdr 1 V15209)
                                                                                                                                                                                                                                                                                          V15351)
                                                                                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                                                                                          (shen/predicate->shen
                                                                                                                                                                                                                                                                                           (null V15210))
                                                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                           (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                            (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                                                           (shen/shen\.pvar\? V15210)
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.bindv V15210 nil V15351)
                                                                                                                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                       (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                                                        (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                                                       (shen/shen\.unbindv V15210 V15351)
                                                                                                                                                                                                                                                                                                       Result)))
                                                                                                                                                                                                                                                                                           'false))))
                                                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                                                      (shen/shen\.pvar\? V15209)
                                                                                                                                                                                                                                                                      (shen/let B
                                                                                                                                                                                                                                                                                (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                 (shen/shen\.bindv V15209
                                                                                                                                                                                                                                                                                                   (list B)
                                                                                                                                                                                                                                                                                                   V15351)
                                                                                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                            (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                            (shen/freeze
                                                                                                                                                                                                                                                                                                             (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.unbindv V15209 V15351)
                                                                                                                                                                                                                                                                                            Result))))
                                                                                                                                                                                                                                                                      'false)))
                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                           (shen/shen\.unbindv V15206 V15351)
                                                                                                                                                                                                                                                           Result)))
                                                                                                                                                                                                                                               'false)))
                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                    (shen/shen\.pvar\? V15205)
                                                                                                                                                                                                                                    (shen/let B
                                                                                                                                                                                                                                              (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                               (shen/shen\.bindv V15205
                                                                                                                                                                                                                                                                 (list '* B)
                                                                                                                                                                                                                                                                 V15351)
                                                                                                                                                                                                                                               (shen/let Result
                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                                                                                                                          (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                           (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                          (shen/shen\.unbindv V15205 V15351)
                                                                                                                                                                                                                                                          Result))))
                                                                                                                                                                                                                                    'false))))
                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                               (shen/shen\.pvar\? V15204)
                                                                                                                                                                                                               (shen/let A
                                                                                                                                                                                                                         (shen/shen\.newpv V15351)
                                                                                                                                                                                                                         (shen/let B
                                                                                                                                                                                                                                   (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                    (shen/shen\.bindv V15204
                                                                                                                                                                                                                                                      (list A '* B)
                                                                                                                                                                                                                                                      V15351)
                                                                                                                                                                                                                                    (shen/let Result
                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                               (shen/shen\.incinfs)
                                                                                                                                                                                                                                               (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                               (shen/freeze
                                                                                                                                                                                                                                                                (shen/shen\.th* Y B V15350 V15351 V15352))))
                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                               (shen/shen\.unbindv V15204 V15351)
                                                                                                                                                                                                                                               Result)))))
                                                                                                                                                                                                               'false)))
                                                                                                                                                                                                   'false)))
                                                                                                                                                                              'false)))
                                                                                                                                                         'false))
                                                                                                                                              'false))
                                                                                                                                   'false))
                                                                                                                        (shen/if
                                                                                                                         (shen/= Case 'false)
                                                                                                                         (shen/let Case
                                                                                                                                   (shen/let V15211
                                                                                                                                             (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/cons\? V15211)
                                                                                                                                              (shen/let V15212
                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                         (shen/hd V15211)
                                                                                                                                                         V15351)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/= '@v V15212)
                                                                                                                                                         (shen/let V15213
                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                    (nthcdr 1 V15211)
                                                                                                                                                                    V15351)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/cons\? V15213)
                                                                                                                                                                    (shen/let X
                                                                                                                                                                              (shen/hd V15213)
                                                                                                                                                                              (shen/let V15214
                                                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                                                         (nthcdr 1 V15213)
                                                                                                                                                                                         V15351)
                                                                                                                                                                                        (shen/if
                                                                                                                                                                                         (shen/cons\? V15214)
                                                                                                                                                                                         (shen/let Y
                                                                                                                                                                                                   (shen/hd V15214)
                                                                                                                                                                                                   (shen/let V15215
                                                                                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                                                                                              (nthcdr 1 V15214)
                                                                                                                                                                                                              V15351)
                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                              (shen/predicate->shen
                                                                                                                                                                                                               (null V15215))
                                                                                                                                                                                                              (shen/let V15216
                                                                                                                                                                                                                        (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                        (shen/if
                                                                                                                                                                                                                         (shen/cons\? V15216)
                                                                                                                                                                                                                         (shen/let V15217
                                                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                                                    (shen/hd V15216)
                                                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                    (shen/= 'vector V15217)
                                                                                                                                                                                                                                    (shen/let V15218
                                                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                                                               (nthcdr 1 V15216)
                                                                                                                                                                                                                                               V15351)
                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                               (shen/cons\? V15218)
                                                                                                                                                                                                                                               (shen/let A
                                                                                                                                                                                                                                                         (shen/hd V15218)
                                                                                                                                                                                                                                                         (shen/let V15219
                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                    (nthcdr 1 V15218)
                                                                                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                                                    (shen/predicate->shen
                                                                                                                                                                                                                                                                     (null V15219))
                                                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                     (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                     (shen/freeze
                                                                                                                                                                                                                                                                                      (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                      (list 'vector A)
                                                                                                                                                                                                                                                                                                      V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                                                     (shen/shen\.pvar\? V15219)
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.bindv V15219 nil V15351)
                                                                                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                 (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                 (shen/freeze
                                                                                                                                                                                                                                                                                                  (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                                  (list 'vector A)
                                                                                                                                                                                                                                                                                                                  V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                 (shen/shen\.unbindv V15219 V15351)
                                                                                                                                                                                                                                                                                 Result)))
                                                                                                                                                                                                                                                                     'false))))
                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                (shen/shen\.pvar\? V15218)
                                                                                                                                                                                                                                                (shen/let A
                                                                                                                                                                                                                                                          (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                           (shen/shen\.bindv V15218
                                                                                                                                                                                                                                                                             (list A)
                                                                                                                                                                                                                                                                             V15351)
                                                                                                                                                                                                                                                           (shen/let Result
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                      (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                       (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                       (list 'vector A)
                                                                                                                                                                                                                                                                                                       V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.unbindv V15218 V15351)
                                                                                                                                                                                                                                                                      Result))))
                                                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                     (shen/shen\.pvar\? V15217)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.bindv V15217 'vector V15351)
                                                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                                                (shen/let V15220
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                           (nthcdr 1 V15216)
                                                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                           (shen/cons\? V15220)
                                                                                                                                                                                                                                                           (shen/let A
                                                                                                                                                                                                                                                                     (shen/hd V15220)
                                                                                                                                                                                                                                                                     (shen/let V15221
                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                (nthcdr 1 V15220)
                                                                                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                                                                                 (null V15221))
                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                 (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                 (shen/freeze
                                                                                                                                                                                                                                                                                                  (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                                  (list 'vector A)
                                                                                                                                                                                                                                                                                                                  V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                                                 (shen/shen\.pvar\? V15221)
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.bindv V15221 nil V15351)
                                                                                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                             (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                             (shen/freeze
                                                                                                                                                                                                                                                                                                              (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                                              (list 'vector A)
                                                                                                                                                                                                                                                                                                                              V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                             (shen/shen\.unbindv V15221 V15351)
                                                                                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                                                                                 'false))))
                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                            (shen/shen\.pvar\? V15220)
                                                                                                                                                                                                                                                            (shen/let A
                                                                                                                                                                                                                                                                      (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                       (shen/shen\.bindv V15220
                                                                                                                                                                                                                                                                                         (list A)
                                                                                                                                                                                                                                                                                         V15351)
                                                                                                                                                                                                                                                                       (shen/let Result
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                  (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                                                                                                                                   (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                                                   (list 'vector A)
                                                                                                                                                                                                                                                                                                                   V15350 V15351 V15352))))
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.unbindv V15220 V15351)
                                                                                                                                                                                                                                                                                  Result))))
                                                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.unbindv V15217 V15351)
                                                                                                                                                                                                                                                 Result)))
                                                                                                                                                                                                                                     'false)))
                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                          (shen/shen\.pvar\? V15216)
                                                                                                                                                                                                                          (shen/let A
                                                                                                                                                                                                                                    (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                     (shen/shen\.bindv V15216
                                                                                                                                                                                                                                                       (list 'vector A)
                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                     (shen/let Result
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                                                (shen/shen\.th* X A V15350 V15351
                                                                                                                                                                                                                                                                (shen/freeze
                                                                                                                                                                                                                                                                 (shen/shen\.th* Y
                                                                                                                                                                                                                                                                                 (list 'vector A)
                                                                                                                                                                                                                                                                                 V15350 V15351 V15352))))
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.unbindv V15216 V15351)
                                                                                                                                                                                                                                                Result))))
                                                                                                                                                                                                                          'false)))
                                                                                                                                                                                                              'false)))
                                                                                                                                                                                         'false)))
                                                                                                                                                                    'false))
                                                                                                                                                         'false))
                                                                                                                                              'false))
                                                                                                                                   (shen/if
                                                                                                                                    (shen/= Case 'false)
                                                                                                                                    (shen/let Case
                                                                                                                                              (shen/let V15222
                                                                                                                                                        (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/cons\? V15222)
                                                                                                                                                         (shen/let V15223
                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                    (shen/hd V15222)
                                                                                                                                                                    V15351)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/= '@s V15223)
                                                                                                                                                                    (shen/let V15224
                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                               (nthcdr 1 V15222)
                                                                                                                                                                               V15351)
                                                                                                                                                                              (shen/if
                                                                                                                                                                               (shen/cons\? V15224)
                                                                                                                                                                               (shen/let X
                                                                                                                                                                                         (shen/hd V15224)
                                                                                                                                                                                         (shen/let V15225
                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                    (nthcdr 1 V15224)
                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                    (shen/cons\? V15225)
                                                                                                                                                                                                    (shen/let Y
                                                                                                                                                                                                              (shen/hd V15225)
                                                                                                                                                                                                              (shen/let V15226
                                                                                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                                                                                         (nthcdr 1 V15225)
                                                                                                                                                                                                                         V15351)
                                                                                                                                                                                                                        (shen/if
                                                                                                                                                                                                                         (shen/predicate->shen
                                                                                                                                                                                                                          (null V15226))
                                                                                                                                                                                                                         (shen/let V15227
                                                                                                                                                                                                                                   (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                    (shen/= 'string V15227)
                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                                                                                     (shen/shen\.th* X 'string V15350 V15351
                                                                                                                                                                                                                                                     (shen/freeze
                                                                                                                                                                                                                                                      (shen/shen\.th* Y 'string V15350 V15351 V15352))))
                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                     (shen/shen\.pvar\? V15227)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.bindv V15227 'string V15351)
                                                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                 (shen/shen\.th* X 'string V15350 V15351
                                                                                                                                                                                                                                                                 (shen/freeze
                                                                                                                                                                                                                                                                  (shen/shen\.th* Y 'string V15350 V15351 V15352))))
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.unbindv V15227 V15351)
                                                                                                                                                                                                                                                 Result)))
                                                                                                                                                                                                                                     'false)))
                                                                                                                                                                                                                         'false)))
                                                                                                                                                                                                    'false)))
                                                                                                                                                                               'false))
                                                                                                                                                                    'false))
                                                                                                                                                         'false))
                                                                                                                                              (shen/if
                                                                                                                                               (shen/= Case 'false)
                                                                                                                                               (shen/let Case
                                                                                                                                                         (shen/let V15228
                                                                                                                                                                   (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/cons\? V15228)
                                                                                                                                                                    (shen/let V15229
                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                               (shen/hd V15228)
                                                                                                                                                                               V15351)
                                                                                                                                                                              (shen/if
                                                                                                                                                                               (shen/= 'lambda V15229)
                                                                                                                                                                               (shen/let V15230
                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                          (nthcdr 1 V15228)
                                                                                                                                                                                          V15351)
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/cons\? V15230)
                                                                                                                                                                                          (shen/let X
                                                                                                                                                                                                    (shen/hd V15230)
                                                                                                                                                                                                    (shen/let V15231
                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                               (nthcdr 1 V15230)
                                                                                                                                                                                                               V15351)
                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                               (shen/cons\? V15231)
                                                                                                                                                                                                               (shen/let Y
                                                                                                                                                                                                                         (shen/hd V15231)
                                                                                                                                                                                                                         (shen/let V15232
                                                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                                                    (nthcdr 1 V15231)
                                                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                    (shen/predicate->shen
                                                                                                                                                                                                                                     (null V15232))
                                                                                                                                                                                                                                    (shen/let V15233
                                                                                                                                                                                                                                              (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                               (shen/cons\? V15233)
                                                                                                                                                                                                                                               (shen/let A
                                                                                                                                                                                                                                                         (shen/hd V15233)
                                                                                                                                                                                                                                                         (shen/let V15234
                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                    (nthcdr 1 V15233)
                                                                                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                                                    (shen/cons\? V15234)
                                                                                                                                                                                                                                                                    (shen/let V15235
                                                                                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                               (shen/hd V15234)
                                                                                                                                                                                                                                                                               V15351)
                                                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                                                               (shen/= '--> V15235)
                                                                                                                                                                                                                                                                               (shen/let V15236
                                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                          (nthcdr 1 V15234)
                                                                                                                                                                                                                                                                                          V15351)
                                                                                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                                                                                          (shen/cons\? V15236)
                                                                                                                                                                                                                                                                                          (shen/let B
                                                                                                                                                                                                                                                                                                    (shen/hd V15236)
                                                                                                                                                                                                                                                                                                    (shen/let V15237
                                                                                                                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                                               (nthcdr 1 V15236)
                                                                                                                                                                                                                                                                                                               V15351)
                                                                                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                                                                                               (shen/predicate->shen
                                                                                                                                                                                                                                                                                                                (null V15237))
                                                                                                                                                                                                                                                                                                               (shen/let Z
                                                                                                                                                                                                                                                                                                                         (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                         (shen/let X&&
                                                                                                                                                                                                                                                                                                                                   (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                                                                                                    (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                    (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                              (shen/freeze
                                                                                                                                                                                                                                                                                                                                               (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                                          (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                                          V15351
                                                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                                                           (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                                      (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                                      V15351
                                                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                       (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                                                                                                                                         (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                                        V15350)
                                                                                                                                                                                                                                                                                                                                                                                       V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                                                                                (shen/shen\.pvar\? V15237)
                                                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                                                 (shen/shen\.bindv V15237 nil V15351)
                                                                                                                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                                                                                                                           (shen/let Z
                                                                                                                                                                                                                                                                                                                                     (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                     (shen/let X&&
                                                                                                                                                                                                                                                                                                                                               (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                                (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                                                           (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                                                      (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                                                      V15351
                                                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                       (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                                                  V15351
                                                                                                                                                                                                                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                                                   (append
                                                                                                                                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                                                                                                                                     (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                                                    V15350)
                                                                                                                                                                                                                                                                                                                                                                                                   V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                                                            (shen/shen\.unbindv V15237 V15351)
                                                                                                                                                                                                                                                                                                                            Result)))
                                                                                                                                                                                                                                                                                                                'false))))
                                                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                                                           (shen/shen\.pvar\? V15236)
                                                                                                                                                                                                                                                                                           (shen/let B
                                                                                                                                                                                                                                                                                                     (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                                                      (shen/shen\.bindv V15236
                                                                                                                                                                                                                                                                                                                        (list B)
                                                                                                                                                                                                                                                                                                                        V15351)
                                                                                                                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                                                                                                                (shen/let Z
                                                                                                                                                                                                                                                                                                                          (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                          (shen/let X&&
                                                                                                                                                                                                                                                                                                                                    (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                     (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                               (shen/freeze
                                                                                                                                                                                                                                                                                                                                                (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                                           (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                                           V15351
                                                                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                                                                            (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                                       (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                                       V15351
                                                                                                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                                        (append
                                                                                                                                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                                                                                                                                          (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                                         V15350)
                                                                                                                                                                                                                                                                                                                                                                                        V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                                                 (shen/shen\.unbindv V15236 V15351)
                                                                                                                                                                                                                                                                                                                 Result))))
                                                                                                                                                                                                                                                                                           'false)))
                                                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                                                (shen/shen\.pvar\? V15235)
                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                 (shen/shen\.bindv V15235 '--> V15351)
                                                                                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                                                                                           (shen/let V15238
                                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                                      (nthcdr 1 V15234)
                                                                                                                                                                                                                                                                                                      V15351)
                                                                                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                                                                                      (shen/cons\? V15238)
                                                                                                                                                                                                                                                                                                      (shen/let B
                                                                                                                                                                                                                                                                                                                (shen/hd V15238)
                                                                                                                                                                                                                                                                                                                (shen/let V15239
                                                                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                                                           (nthcdr 1 V15238)
                                                                                                                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                                                                                           (shen/predicate->shen
                                                                                                                                                                                                                                                                                                                            (null V15239))
                                                                                                                                                                                                                                                                                                                           (shen/let Z
                                                                                                                                                                                                                                                                                                                                     (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                     (shen/let X&&
                                                                                                                                                                                                                                                                                                                                               (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                                (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                                                           (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                                                      (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                                                      V15351
                                                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                       (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                                                  V15351
                                                                                                                                                                                                                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                                                   (append
                                                                                                                                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                                                                                                                                     (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                                                    V15350)
                                                                                                                                                                                                                                                                                                                                                                                                   V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                                                                                            (shen/shen\.pvar\? V15239)
                                                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                                                             (shen/shen\.bindv V15239 nil V15351)
                                                                                                                                                                                                                                                                                                                             (shen/let Result
                                                                                                                                                                                                                                                                                                                                       (shen/let Z
                                                                                                                                                                                                                                                                                                                                                 (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                                 (shen/let X&&
                                                                                                                                                                                                                                                                                                                                                           (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                                            (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                       (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                                                                  V15351
                                                                                                                                                                                                                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                                   (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                                                              (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                                                              V15351
                                                                                                                                                                                                                                                                                                                                                                                              (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                                               (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                                                               (append
                                                                                                                                                                                                                                                                                                                                                                                                                (list
                                                                                                                                                                                                                                                                                                                                                                                                                 (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                                                                V15350)
                                                                                                                                                                                                                                                                                                                                                                                                               V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                                                                                                                        (shen/shen\.unbindv V15239 V15351)
                                                                                                                                                                                                                                                                                                                                        Result)))
                                                                                                                                                                                                                                                                                                                            'false))))
                                                                                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                                                                                       (shen/shen\.pvar\? V15238)
                                                                                                                                                                                                                                                                                                       (shen/let B
                                                                                                                                                                                                                                                                                                                 (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                                                  (shen/shen\.bindv V15238
                                                                                                                                                                                                                                                                                                                                    (list B)
                                                                                                                                                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                                                                                                                            (shen/let Z
                                                                                                                                                                                                                                                                                                                                      (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                      (shen/let X&&
                                                                                                                                                                                                                                                                                                                                                (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                                 (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                                                                            (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                                                       (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                                                       V15351
                                                                                                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                        (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                                                   (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                                                   V15351
                                                                                                                                                                                                                                                                                                                                                                                   (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                                    (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                                                    (append
                                                                                                                                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                                                                                                                                      (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                                                     V15350)
                                                                                                                                                                                                                                                                                                                                                                                                    V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                                                             (shen/shen\.unbindv V15238 V15351)
                                                                                                                                                                                                                                                                                                                             Result))))
                                                                                                                                                                                                                                                                                                       'false)))
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.unbindv V15235 V15351)
                                                                                                                                                                                                                                                                                            Result)))
                                                                                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                                                     (shen/shen\.pvar\? V15234)
                                                                                                                                                                                                                                                                     (shen/let B
                                                                                                                                                                                                                                                                               (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                (shen/shen\.bindv V15234
                                                                                                                                                                                                                                                                                                  (list '--> B)
                                                                                                                                                                                                                                                                                                  V15351)
                                                                                                                                                                                                                                                                                (shen/let Result
                                                                                                                                                                                                                                                                                          (shen/let Z
                                                                                                                                                                                                                                                                                                    (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                    (shen/let X&&
                                                                                                                                                                                                                                                                                                              (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                                                                               (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                               (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                         (shen/freeze
                                                                                                                                                                                                                                                                                                                          (shen/bind X&&
                                                                                                                                                                                                                                                                                                                                     (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                                     V15351
                                                                                                                                                                                                                                                                                                                                     (shen/freeze
                                                                                                                                                                                                                                                                                                                                      (shen/bind Z
                                                                                                                                                                                                                                                                                                                                                 (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                                 V15351
                                                                                                                                                                                                                                                                                                                                                 (shen/freeze
                                                                                                                                                                                                                                                                                                                                                  (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                                  (append
                                                                                                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                                                                                                    (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                                   V15350)
                                                                                                                                                                                                                                                                                                                                                                  V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                                                           (shen/shen\.unbindv V15234 V15351)
                                                                                                                                                                                                                                                                                           Result))))
                                                                                                                                                                                                                                                                     'false))))
                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                (shen/shen\.pvar\? V15233)
                                                                                                                                                                                                                                                (shen/let A
                                                                                                                                                                                                                                                          (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                          (shen/let B
                                                                                                                                                                                                                                                                    (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                                                     (shen/shen\.bindv V15233
                                                                                                                                                                                                                                                                                       (list A '--> B)
                                                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                                                     (shen/let Result
                                                                                                                                                                                                                                                                               (shen/let Z
                                                                                                                                                                                                                                                                                         (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                         (shen/let X&&
                                                                                                                                                                                                                                                                                                   (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                                                                    (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                    (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                              (shen/freeze
                                                                                                                                                                                                                                                                                                               (shen/bind X&&
                                                                                                                                                                                                                                                                                                                          (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                          V15351
                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                           (shen/bind Z
                                                                                                                                                                                                                                                                                                                                      (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef Y V15351))
                                                                                                                                                                                                                                                                                                                                      V15351
                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                       (shen/shen\.th* Z B
                                                                                                                                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                                                                                                         (list X&& ': A))
                                                                                                                                                                                                                                                                                                                                                        V15350)
                                                                                                                                                                                                                                                                                                                                                       V15351 V15352))))))))))
                                                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                                                (shen/shen\.unbindv V15233 V15351)
                                                                                                                                                                                                                                                                                Result)))))
                                                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                                                    'false)))
                                                                                                                                                                                                               'false)))
                                                                                                                                                                                          'false))
                                                                                                                                                                               'false))
                                                                                                                                                                    'false))
                                                                                                                                                         (shen/if
                                                                                                                                                          (shen/= Case 'false)
                                                                                                                                                          (shen/let Case
                                                                                                                                                                    (shen/let V15240
                                                                                                                                                                              (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                              (shen/if
                                                                                                                                                                               (shen/cons\? V15240)
                                                                                                                                                                               (shen/let V15241
                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                          (shen/hd V15240)
                                                                                                                                                                                          V15351)
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/= 'let V15241)
                                                                                                                                                                                          (shen/let V15242
                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                     (nthcdr 1 V15240)
                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/cons\? V15242)
                                                                                                                                                                                                     (shen/let X
                                                                                                                                                                                                               (shen/hd V15242)
                                                                                                                                                                                                               (shen/let V15243
                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                          (nthcdr 1 V15242)
                                                                                                                                                                                                                          V15351)
                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                          (shen/cons\? V15243)
                                                                                                                                                                                                                          (shen/let Y
                                                                                                                                                                                                                                    (shen/hd V15243)
                                                                                                                                                                                                                                    (shen/let V15244
                                                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                                                               (nthcdr 1 V15243)
                                                                                                                                                                                                                                               V15351)
                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                               (shen/cons\? V15244)
                                                                                                                                                                                                                                               (shen/let Z
                                                                                                                                                                                                                                                         (shen/hd V15244)
                                                                                                                                                                                                                                                         (shen/let V15245
                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                    (nthcdr 1 V15244)
                                                                                                                                                                                                                                                                    V15351)
                                                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                                                    (shen/predicate->shen
                                                                                                                                                                                                                                                                     (null V15245))
                                                                                                                                                                                                                                                                    (shen/let W
                                                                                                                                                                                                                                                                              (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                              (shen/let X&&
                                                                                                                                                                                                                                                                                        (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                        (shen/let B
                                                                                                                                                                                                                                                                                                  (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                                                                   (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                   (shen/shen\.th* Y B V15350 V15351
                                                                                                                                                                                                                                                                                                                   (shen/freeze
                                                                                                                                                                                                                                                                                                                    (shen/bind X&&
                                                                                                                                                                                                                                                                                                                               (shen/shen\.placeholder)
                                                                                                                                                                                                                                                                                                                               V15351
                                                                                                                                                                                                                                                                                                                               (shen/freeze
                                                                                                                                                                                                                                                                                                                                (shen/bind W
                                                                                                                                                                                                                                                                                                                                           (shen/shen\.ebr
                                                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef X&& V15351)
                                                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef X V15351)
                                                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef Z V15351))
                                                                                                                                                                                                                                                                                                                                           V15351
                                                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                                                            (shen/shen\.th* W V15349
                                                                                                                                                                                                                                                                                                                                                            (append
                                                                                                                                                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                                                                                                                                                              (list X&& ': B))
                                                                                                                                                                                                                                                                                                                                                             V15350)
                                                                                                                                                                                                                                                                                                                                                            V15351 V15352)))))))))))
                                                                                                                                                                                                                                                                    'false)))
                                                                                                                                                                                                                                               'false)))
                                                                                                                                                                                                                          'false)))
                                                                                                                                                                                                     'false))
                                                                                                                                                                                          'false))
                                                                                                                                                                               'false))
                                                                                                                                                                    (shen/if
                                                                                                                                                                     (shen/= Case 'false)
                                                                                                                                                                     (shen/let Case
                                                                                                                                                                               (shen/let V15246
                                                                                                                                                                                         (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/cons\? V15246)
                                                                                                                                                                                          (shen/let V15247
                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                     (shen/hd V15246)
                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/= 'open V15247)
                                                                                                                                                                                                     (shen/let V15248
                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                (nthcdr 1 V15246)
                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/cons\? V15248)
                                                                                                                                                                                                                (shen/let FileName
                                                                                                                                                                                                                          (shen/hd V15248)
                                                                                                                                                                                                                          (shen/let V15249
                                                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                                                     (nthcdr 1 V15248)
                                                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                     (shen/cons\? V15249)
                                                                                                                                                                                                                                     (shen/let Direction15179
                                                                                                                                                                                                                                               (shen/hd V15249)
                                                                                                                                                                                                                                               (shen/let V15250
                                                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                                                          (nthcdr 1 V15249)
                                                                                                                                                                                                                                                          V15351)
                                                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                                                          (shen/predicate->shen
                                                                                                                                                                                                                                                           (null V15250))
                                                                                                                                                                                                                                                          (shen/let V15251
                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                                                     (shen/cons\? V15251)
                                                                                                                                                                                                                                                                     (shen/let V15252
                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                (shen/hd V15251)
                                                                                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                                                (shen/= 'stream V15252)
                                                                                                                                                                                                                                                                                (shen/let V15253
                                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                           (nthcdr 1 V15251)
                                                                                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                                                           (shen/cons\? V15253)
                                                                                                                                                                                                                                                                                           (shen/let Direction
                                                                                                                                                                                                                                                                                                     (shen/hd V15253)
                                                                                                                                                                                                                                                                                                     (shen/let V15254
                                                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                                                (nthcdr 1 V15253)
                                                                                                                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                                                                                                                 (null V15254))
                                                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                 (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                                              (shen/freeze
                                                                                                                                                                                                                                                                                                                               (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                         (shen/freeze
                                                                                                                                                                                                                                                                                                                                          (shen/fwhen
                                                                                                                                                                                                                                                                                                                                           (shen/element\?
                                                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                                            (list 'in 'out))
                                                                                                                                                                                                                                                                                                                                           V15351
                                                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                                                            (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                                                                                 (shen/shen\.pvar\? V15254)
                                                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                                                  (shen/shen\.bindv V15254 nil V15351)
                                                                                                                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                             (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                                           (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                     (shen/freeze
                                                                                                                                                                                                                                                                                                                                                      (shen/fwhen
                                                                                                                                                                                                                                                                                                                                                       (shen/element\?
                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                                                        (list 'in 'out))
                                                                                                                                                                                                                                                                                                                                                       V15351
                                                                                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                                                             (shen/shen\.unbindv V15254 V15351)
                                                                                                                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                                                                                                                 'false))))
                                                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                                                            (shen/shen\.pvar\? V15253)
                                                                                                                                                                                                                                                                                            (shen/let Direction
                                                                                                                                                                                                                                                                                                      (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                                                       (shen/shen\.bindv V15253
                                                                                                                                                                                                                                                                                                                         (list Direction)
                                                                                                                                                                                                                                                                                                                         V15351)
                                                                                                                                                                                                                                                                                                       (shen/let Result
                                                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                  (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                                               (shen/freeze
                                                                                                                                                                                                                                                                                                                                (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                                           (shen/fwhen
                                                                                                                                                                                                                                                                                                                                            (shen/element\?
                                                                                                                                                                                                                                                                                                                                             (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                                             (list 'in 'out))
                                                                                                                                                                                                                                                                                                                                            V15351
                                                                                                                                                                                                                                                                                                                                            (shen/freeze
                                                                                                                                                                                                                                                                                                                                             (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                                                  (shen/shen\.unbindv V15253 V15351)
                                                                                                                                                                                                                                                                                                                  Result))))
                                                                                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                                                 (shen/shen\.pvar\? V15252)
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.bindv V15252 'stream V15351)
                                                                                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                                                                                            (shen/let V15255
                                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                                       (nthcdr 1 V15251)
                                                                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                                                                                       (shen/cons\? V15255)
                                                                                                                                                                                                                                                                                                       (shen/let Direction
                                                                                                                                                                                                                                                                                                                 (shen/hd V15255)
                                                                                                                                                                                                                                                                                                                 (shen/let V15256
                                                                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                                                            (nthcdr 1 V15255)
                                                                                                                                                                                                                                                                                                                            V15351)
                                                                                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                                                                                            (shen/predicate->shen
                                                                                                                                                                                                                                                                                                                             (null V15256))
                                                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                             (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                                                                                                           (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                     (shen/freeze
                                                                                                                                                                                                                                                                                                                                                      (shen/fwhen
                                                                                                                                                                                                                                                                                                                                                       (shen/element\?
                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                                                        (list 'in 'out))
                                                                                                                                                                                                                                                                                                                                                       V15351
                                                                                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                                                                                        (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                                                                                                                             (shen/shen\.pvar\? V15256)
                                                                                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                                                                                              (shen/shen\.bindv V15256 nil V15351)
                                                                                                                                                                                                                                                                                                                              (shen/let Result
                                                                                                                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                                                                                                                         (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                                         (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                                       (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                                 (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                  (shen/fwhen
                                                                                                                                                                                                                                                                                                                                                                   (shen/element\?
                                                                                                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                                                                    (list 'in 'out))
                                                                                                                                                                                                                                                                                                                                                                   V15351
                                                                                                                                                                                                                                                                                                                                                                   (shen/freeze
                                                                                                                                                                                                                                                                                                                                                                    (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                                                                                                                         (shen/shen\.unbindv V15256 V15351)
                                                                                                                                                                                                                                                                                                                                         Result)))
                                                                                                                                                                                                                                                                                                                             'false))))
                                                                                                                                                                                                                                                                                                       (shen/if
                                                                                                                                                                                                                                                                                                        (shen/shen\.pvar\? V15255)
                                                                                                                                                                                                                                                                                                        (shen/let Direction
                                                                                                                                                                                                                                                                                                                  (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                                                                                   (shen/shen\.bindv V15255
                                                                                                                                                                                                                                                                                                                                     (list Direction)
                                                                                                                                                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                                                                                                                                   (shen/let Result
                                                                                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                                                                                              (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                              (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                                                           (shen/freeze
                                                                                                                                                                                                                                                                                                                                            (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                                                       (shen/fwhen
                                                                                                                                                                                                                                                                                                                                                        (shen/element\?
                                                                                                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                                                         (list 'in 'out))
                                                                                                                                                                                                                                                                                                                                                        V15351
                                                                                                                                                                                                                                                                                                                                                        (shen/freeze
                                                                                                                                                                                                                                                                                                                                                         (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                                                                                              (shen/shen\.unbindv V15255 V15351)
                                                                                                                                                                                                                                                                                                                              Result))))
                                                                                                                                                                                                                                                                                                        'false)))
                                                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                                                             (shen/shen\.unbindv V15252 V15351)
                                                                                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                                                                                 'false)))
                                                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                                                      (shen/shen\.pvar\? V15251)
                                                                                                                                                                                                                                                                      (shen/let Direction
                                                                                                                                                                                                                                                                                (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                                                 (shen/shen\.bindv V15251
                                                                                                                                                                                                                                                                                                   (list 'stream Direction)
                                                                                                                                                                                                                                                                                                   V15351)
                                                                                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                            (shen/unify! Direction Direction15179 V15351
                                                                                                                                                                                                                                                                                                         (shen/freeze
                                                                                                                                                                                                                                                                                                          (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                    (shen/freeze
                                                                                                                                                                                                                                                                                                                     (shen/fwhen
                                                                                                                                                                                                                                                                                                                      (shen/element\?
                                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef Direction V15351)
                                                                                                                                                                                                                                                                                                                       (list 'in 'out))
                                                                                                                                                                                                                                                                                                                      V15351
                                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                                       (shen/shen\.th* FileName 'string V15350 V15351 V15352))))))))
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.unbindv V15251 V15351)
                                                                                                                                                                                                                                                                                            Result))))
                                                                                                                                                                                                                                                                      'false)))
                                                                                                                                                                                                                                                          'false)))
                                                                                                                                                                                                                                     'false)))
                                                                                                                                                                                                                'false))
                                                                                                                                                                                                     'false))
                                                                                                                                                                                          'false))
                                                                                                                                                                               (shen/if
                                                                                                                                                                                (shen/= Case 'false)
                                                                                                                                                                                (shen/let Case
                                                                                                                                                                                          (shen/let V15257
                                                                                                                                                                                                    (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/cons\? V15257)
                                                                                                                                                                                                     (shen/let V15258
                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                (shen/hd V15257)
                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/= 'type V15258)
                                                                                                                                                                                                                (shen/let V15259
                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                           (nthcdr 1 V15257)
                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/cons\? V15259)
                                                                                                                                                                                                                           (shen/let X
                                                                                                                                                                                                                                     (shen/hd V15259)
                                                                                                                                                                                                                                     (shen/let V15260
                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                (nthcdr 1 V15259)
                                                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                (shen/cons\? V15260)
                                                                                                                                                                                                                                                (shen/let A
                                                                                                                                                                                                                                                          (shen/hd V15260)
                                                                                                                                                                                                                                                          (shen/let V15261
                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                     (nthcdr 1 V15260)
                                                                                                                                                                                                                                                                     V15351)
                                                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                                                     (shen/predicate->shen
                                                                                                                                                                                                                                                                      (null V15261))
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                      (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                (shen/freeze
                                                                                                                                                                                                                                                                                 (shen/unify A V15349 V15351
                                                                                                                                                                                                                                                                                             (shen/freeze
                                                                                                                                                                                                                                                                                              (shen/shen\.th* X A V15350 V15351 V15352))))))
                                                                                                                                                                                                                                                                     'false)))
                                                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                                           'false))
                                                                                                                                                                                                                'false))
                                                                                                                                                                                                     'false))
                                                                                                                                                                                          (shen/if
                                                                                                                                                                                           (shen/= Case 'false)
                                                                                                                                                                                           (shen/let Case
                                                                                                                                                                                                     (shen/let V15262
                                                                                                                                                                                                               (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/cons\? V15262)
                                                                                                                                                                                                                (shen/let V15263
                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                           (shen/hd V15262)
                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/= 'input+ V15263)
                                                                                                                                                                                                                           (shen/let V15264
                                                                                                                                                                                                                                     (shen/shen\.lazyderef
                                                                                                                                                                                                                                      (nthcdr 1 V15262)
                                                                                                                                                                                                                                      V15351)
                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                      (shen/cons\? V15264)
                                                                                                                                                                                                                                      (shen/let A
                                                                                                                                                                                                                                                (shen/hd V15264)
                                                                                                                                                                                                                                                (shen/let V15265
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                           (nthcdr 1 V15264)
                                                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                           (shen/cons\? V15265)
                                                                                                                                                                                                                                                           (shen/let Stream
                                                                                                                                                                                                                                                                     (shen/hd V15265)
                                                                                                                                                                                                                                                                     (shen/let V15266
                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                (nthcdr 1 V15265)
                                                                                                                                                                                                                                                                                V15351)
                                                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                                                                                 (null V15266))
                                                                                                                                                                                                                                                                                (shen/let C
                                                                                                                                                                                                                                                                                          (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                           (shen/bind C
                                                                                                                                                                                                                                                                                                      (shen/shen\.demodulate
                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef A V15351))
                                                                                                                                                                                                                                                                                                      V15351
                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                       (shen/unify V15349 C V15351
                                                                                                                                                                                                                                                                                                                   (shen/freeze
                                                                                                                                                                                                                                                                                                                    (shen/shen\.th* Stream
                                                                                                                                                                                                                                                                                                                                    (list 'stream 'in)
                                                                                                                                                                                                                                                                                                                                    V15350 V15351 V15352)))))))
                                                                                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                                                                           'false)))
                                                                                                                                                                                                                                      'false))
                                                                                                                                                                                                                           'false))
                                                                                                                                                                                                                'false))
                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                      (shen/= Case 'false)
                                                                                                                                                                                                      (shen/let Case
                                                                                                                                                                                                                (shen/let V15267
                                                                                                                                                                                                                          (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/cons\? V15267)
                                                                                                                                                                                                                           (shen/let V15268
                                                                                                                                                                                                                                     (shen/shen\.lazyderef
                                                                                                                                                                                                                                      (shen/hd V15267)
                                                                                                                                                                                                                                      V15351)
                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                      (shen/= 'set V15268)
                                                                                                                                                                                                                                      (shen/let V15269
                                                                                                                                                                                                                                                (shen/shen\.lazyderef
                                                                                                                                                                                                                                                 (nthcdr 1 V15267)
                                                                                                                                                                                                                                                 V15351)
                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                 (shen/cons\? V15269)
                                                                                                                                                                                                                                                 (shen/let Var
                                                                                                                                                                                                                                                           (shen/hd V15269)
                                                                                                                                                                                                                                                           (shen/let V15270
                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                      (nthcdr 1 V15269)
                                                                                                                                                                                                                                                                      V15351)
                                                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                                                      (shen/cons\? V15270)
                                                                                                                                                                                                                                                                      (shen/let Val
                                                                                                                                                                                                                                                                                (shen/hd V15270)
                                                                                                                                                                                                                                                                                (shen/let V15271
                                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                           (nthcdr 1 V15270)
                                                                                                                                                                                                                                                                                           V15351)
                                                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                                                           (shen/predicate->shen
                                                                                                                                                                                                                                                                                            (null V15271))
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                            (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                       (shen/shen\.th* Var 'symbol V15350 V15351
                                                                                                                                                                                                                                                                                                                       (shen/freeze
                                                                                                                                                                                                                                                                                                                        (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                                                                                                                                                                   (shen/shen\.th*
                                                                                                                                                                                                                                                                                                                                    (list 'value Var)
                                                                                                                                                                                                                                                                                                                                    V15349 V15350 V15351
                                                                                                                                                                                                                                                                                                                                    (shen/freeze
                                                                                                                                                                                                                                                                                                                                     (shen/shen\.th* Val V15349 V15350 V15351 V15352))))))))))
                                                                                                                                                                                                                                                                                           'false)))
                                                                                                                                                                                                                                                                      'false)))
                                                                                                                                                                                                                                                 'false))
                                                                                                                                                                                                                                      'false))
                                                                                                                                                                                                                           'false))
                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                 (shen/= Case 'false)
                                                                                                                                                                                                                 (shen/let Case
                                                                                                                                                                                                                           (shen/let NewHyp
                                                                                                                                                                                                                                     (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                      (shen/shen\.t*-hyps V15350 NewHyp V15351
                                                                                                                                                                                                                                                          (shen/freeze
                                                                                                                                                                                                                                                           (shen/shen\.th* V15348 V15349 NewHyp V15351 V15352)))))
                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                            (shen/= Case 'false)
                                                                                                                                                                                                                            (shen/let Case
                                                                                                                                                                                                                                      (shen/let V15272
                                                                                                                                                                                                                                                (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                 (shen/cons\? V15272)
                                                                                                                                                                                                                                                 (shen/let V15273
                                                                                                                                                                                                                                                           (shen/shen\.lazyderef
                                                                                                                                                                                                                                                            (shen/hd V15272)
                                                                                                                                                                                                                                                            V15351)
                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                            (shen/= 'define V15273)
                                                                                                                                                                                                                                                            (shen/let V15274
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                       (nthcdr 1 V15272)
                                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                                                       (shen/cons\? V15274)
                                                                                                                                                                                                                                                                       (shen/let F
                                                                                                                                                                                                                                                                                 (shen/hd V15274)
                                                                                                                                                                                                                                                                                 (shen/let X
                                                                                                                                                                                                                                                                                           (nthcdr 1 V15274)
                                                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                            (shen/cut Throwcontrol V15351
                                                                                                                                                                                                                                                                                                      (shen/freeze
                                                                                                                                                                                                                                                                                                       (shen/shen\.t*-def
                                                                                                                                                                                                                                                                                                        (append
                                                                                                                                                                                                                                                                                                         (list 'define F)
                                                                                                                                                                                                                                                                                                         X)
                                                                                                                                                                                                                                                                                                        V15349 V15350 V15351 V15352))))))
                                                                                                                                                                                                                                                                       'false))
                                                                                                                                                                                                                                                            'false))
                                                                                                                                                                                                                                                 'false))
                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                       (shen/= Case 'false)
                                                                                                                                                                                                                                       (shen/let Case
                                                                                                                                                                                                                                                 (shen/let V15275
                                                                                                                                                                                                                                                           (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                            (shen/cons\? V15275)
                                                                                                                                                                                                                                                            (shen/let V15276
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                       (shen/hd V15275)
                                                                                                                                                                                                                                                                       V15351)
                                                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                                                       (shen/= 'defmacro V15276)
                                                                                                                                                                                                                                                                       (shen/let V15277
                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                                                  (shen/= 'unit V15277)
                                                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                                                   (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                   (shen/cut Throwcontrol V15351 V15352))
                                                                                                                                                                                                                                                                                  (shen/if
                                                                                                                                                                                                                                                                                   (shen/shen\.pvar\? V15277)
                                                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                                                    (shen/shen\.bindv V15277 'unit V15351)
                                                                                                                                                                                                                                                                                    (shen/let Result
                                                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                                                               (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                               (shen/cut Throwcontrol V15351 V15352))
                                                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                                                               (shen/shen\.unbindv V15277 V15351)
                                                                                                                                                                                                                                                                                               Result)))
                                                                                                                                                                                                                                                                                   'false)))
                                                                                                                                                                                                                                                                       'false))
                                                                                                                                                                                                                                                            'false))
                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                  (shen/= Case 'false)
                                                                                                                                                                                                                                                  (shen/let Case
                                                                                                                                                                                                                                                            (shen/let V15278
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                                                       (shen/cons\? V15278)
                                                                                                                                                                                                                                                                       (shen/let V15279
                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                  (shen/hd V15278)
                                                                                                                                                                                                                                                                                  V15351)
                                                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                                                  (shen/= 'shen\.process-datatype V15279)
                                                                                                                                                                                                                                                                                  (shen/let V15280
                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                                                                                             (shen/= 'symbol V15280)
                                                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                                                              (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                              (shen/thaw V15352))
                                                                                                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                                                                                                              (shen/shen\.pvar\? V15280)
                                                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                                                               (shen/shen\.bindv V15280 'symbol V15351)
                                                                                                                                                                                                                                                                                               (shen/let Result
                                                                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                          (shen/thaw V15352))
                                                                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                                                                          (shen/shen\.unbindv V15280 V15351)
                                                                                                                                                                                                                                                                                                          Result)))
                                                                                                                                                                                                                                                                                              'false)))
                                                                                                                                                                                                                                                                                  'false))
                                                                                                                                                                                                                                                                       'false))
                                                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                                                             (shen/= Case 'false)
                                                                                                                                                                                                                                                             (shen/let Case
                                                                                                                                                                                                                                                                       (shen/let V15281
                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef V15348 V15351)
                                                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                                                  (shen/cons\? V15281)
                                                                                                                                                                                                                                                                                  (shen/let V15282
                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                                             (shen/hd V15281)
                                                                                                                                                                                                                                                                                             V15351)
                                                                                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                                                                                             (shen/= 'shen\.synonyms-help V15282)
                                                                                                                                                                                                                                                                                             (shen/let V15283
                                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef V15349 V15351)
                                                                                                                                                                                                                                                                                                       (shen/if
                                                                                                                                                                                                                                                                                                        (shen/= 'symbol V15283)
                                                                                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                                                                                         (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                         (shen/thaw V15352))
                                                                                                                                                                                                                                                                                                        (shen/if
                                                                                                                                                                                                                                                                                                         (shen/shen\.pvar\? V15283)
                                                                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                                                                          (shen/shen\.bindv V15283 'symbol V15351)
                                                                                                                                                                                                                                                                                                          (shen/let Result
                                                                                                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                                                     (shen/thaw V15352))
                                                                                                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                                                                                                     (shen/shen\.unbindv V15283 V15351)
                                                                                                                                                                                                                                                                                                                     Result)))
                                                                                                                                                                                                                                                                                                         'false)))
                                                                                                                                                                                                                                                                                             'false))
                                                                                                                                                                                                                                                                                  'false))
                                                                                                                                                                                                                                                                       (shen/if
                                                                                                                                                                                                                                                                        (shen/= Case 'false)
                                                                                                                                                                                                                                                                        (shen/let Datatypes
                                                                                                                                                                                                                                                                                  (shen/shen\.newpv V15351)
                                                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                                                   (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                   (shen/bind Datatypes
                                                                                                                                                                                                                                                                                              (shen/value 'shen\.*datatypes*)
                                                                                                                                                                                                                                                                                              V15351
                                                                                                                                                                                                                                                                                              (shen/freeze
                                                                                                                                                                                                                                                                                               (shen/shen\.udefs*
                                                                                                                                                                                                                                                                                                (list V15348 ': V15349)
                                                                                                                                                                                                                                                                                                V15350 Datatypes V15351 V15352)))))
                                                                                                                                                                                                                                                                        Case))
                                                                                                                                                                                                                                                             Case))
                                                                                                                                                                                                                                                  Case))
                                                                                                                                                                                                                                       Case))
                                                                                                                                                                                                                            Case))
                                                                                                                                                                                                                 Case))
                                                                                                                                                                                                      Case))
                                                                                                                                                                                           Case))
                                                                                                                                                                                Case))
                                                                                                                                                                     Case))
                                                                                                                                                          Case))
                                                                                                                                               Case))
                                                                                                                                    Case))
                                                                                                                         Case))
                                                                                                              Case))
                                                                                                   Case))
                                                                                        Case))
                                                                             Case))
                                                                  Case))
                                                       Case))
                                            Case)))))
(defun shen/shen\.t*-hyps
    (V15357 V15358 V15359 V15360)
  (shen/let Case
            (shen/let V15094
                      (shen/shen\.lazyderef V15357 V15359)
                      (shen/if
                       (shen/cons\? V15094)
                       (shen/let V15095
                                 (shen/shen\.lazyderef
                                  (shen/hd V15094)
                                  V15359)
                                 (shen/if
                                  (shen/cons\? V15095)
                                  (shen/let V15096
                                            (shen/shen\.lazyderef
                                             (shen/hd V15095)
                                             V15359)
                                            (shen/if
                                             (shen/cons\? V15096)
                                             (shen/let V15097
                                                       (shen/shen\.lazyderef
                                                        (shen/hd V15096)
                                                        V15359)
                                                       (shen/if
                                                        (shen/= 'cons V15097)
                                                        (shen/let V15098
                                                                  (shen/shen\.lazyderef
                                                                   (nthcdr 1 V15096)
                                                                   V15359)
                                                                  (shen/if
                                                                   (shen/cons\? V15098)
                                                                   (shen/let X
                                                                             (shen/hd V15098)
                                                                             (shen/let V15099
                                                                                       (shen/shen\.lazyderef
                                                                                        (nthcdr 1 V15098)
                                                                                        V15359)
                                                                                       (shen/if
                                                                                        (shen/cons\? V15099)
                                                                                        (shen/let Y
                                                                                                  (shen/hd V15099)
                                                                                                  (shen/let V15100
                                                                                                            (shen/shen\.lazyderef
                                                                                                             (nthcdr 1 V15099)
                                                                                                             V15359)
                                                                                                            (shen/if
                                                                                                             (shen/predicate->shen
                                                                                                              (null V15100))
                                                                                                             (shen/let V15101
                                                                                                                       (shen/shen\.lazyderef
                                                                                                                        (nthcdr 1 V15095)
                                                                                                                        V15359)
                                                                                                                       (shen/if
                                                                                                                        (shen/cons\? V15101)
                                                                                                                        (shen/let V15102
                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                   (shen/hd V15101)
                                                                                                                                   V15359)
                                                                                                                                  (shen/if
                                                                                                                                   (shen/= ': V15102)
                                                                                                                                   (shen/let V15103
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (nthcdr 1 V15101)
                                                                                                                                              V15359)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/cons\? V15103)
                                                                                                                                              (shen/let V15104
                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                         (shen/hd V15103)
                                                                                                                                                         V15359)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/cons\? V15104)
                                                                                                                                                         (shen/let V15105
                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                    (shen/hd V15104)
                                                                                                                                                                    V15359)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/= 'list V15105)
                                                                                                                                                                    (shen/let V15106
                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                               (nthcdr 1 V15104)
                                                                                                                                                                               V15359)
                                                                                                                                                                              (shen/if
                                                                                                                                                                               (shen/cons\? V15106)
                                                                                                                                                                               (shen/let A
                                                                                                                                                                                         (shen/hd V15106)
                                                                                                                                                                                         (shen/let V15107
                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                    (nthcdr 1 V15106)
                                                                                                                                                                                                    V15359)
                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                    (shen/predicate->shen
                                                                                                                                                                                                     (null V15107))
                                                                                                                                                                                                    (shen/let V15108
                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                               (nthcdr 1 V15103)
                                                                                                                                                                                                               V15359)
                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                               (shen/predicate->shen
                                                                                                                                                                                                                (null V15108))
                                                                                                                                                                                                               (shen/let Hyp
                                                                                                                                                                                                                         (nthcdr 1 V15094)
                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                                                                                          (shen/bind V15358
                                                                                                                                                                                                                                     (append
                                                                                                                                                                                                                                      (list
                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                        (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                        ':
                                                                                                                                                                                                                                        (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                        (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                        ':
                                                                                                                                                                                                                                        (list 'list
                                                                                                                                                                                                                                              (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                      (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                     V15359 V15360)))
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/shen\.pvar\? V15108)
                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                 (shen/shen\.bindv V15108 nil V15359)
                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                     (nthcdr 1 V15094)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (list 'list
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.unbindv V15108 V15359)
                                                                                                                                                                                                                            Result)))
                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/shen\.pvar\? V15107)
                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                      (shen/shen\.bindv V15107 nil V15359)
                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                (shen/let V15109
                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                           (nthcdr 1 V15103)
                                                                                                                                                                                                                           V15359)
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/predicate->shen
                                                                                                                                                                                                                            (null V15109))
                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                     (nthcdr 1 V15094)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (list 'list
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                            (shen/shen\.pvar\? V15109)
                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                             (shen/shen\.bindv V15109 nil V15359)
                                                                                                                                                                                                                             (shen/let Result
                                                                                                                                                                                                                                       (shen/let Hyp
                                                                                                                                                                                                                                                 (nthcdr 1 V15094)
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                  (shen/bind V15358
                                                                                                                                                                                                                                                             (append
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                (list 'list
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                             V15359 V15360)))
                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                        (shen/shen\.unbindv V15109 V15359)
                                                                                                                                                                                                                                        Result)))
                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                 (shen/shen\.unbindv V15107 V15359)
                                                                                                                                                                                                                 Result)))
                                                                                                                                                                                                     'false))))
                                                                                                                                                                               (shen/if
                                                                                                                                                                                (shen/shen\.pvar\? V15106)
                                                                                                                                                                                (shen/let A
                                                                                                                                                                                          (shen/shen\.newpv V15359)
                                                                                                                                                                                          (shen/do
                                                                                                                                                                                           (shen/shen\.bindv V15106
                                                                                                                                                                                                             (list A)
                                                                                                                                                                                                             V15359)
                                                                                                                                                                                           (shen/let Result
                                                                                                                                                                                                     (shen/let V15110
                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                (nthcdr 1 V15103)
                                                                                                                                                                                                                V15359)
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                 (null V15110))
                                                                                                                                                                                                                (shen/let Hyp
                                                                                                                                                                                                                          (nthcdr 1 V15094)
                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                           (shen/bind V15358
                                                                                                                                                                                                                                      (append
                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                         (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                         ':
                                                                                                                                                                                                                                         (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                         (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                         ':
                                                                                                                                                                                                                                         (list 'list
                                                                                                                                                                                                                                               (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                       (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                      V15359 V15360)))
                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                 (shen/shen\.pvar\? V15110)
                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                  (shen/shen\.bindv V15110 nil V15359)
                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                            (shen/let Hyp
                                                                                                                                                                                                                                      (nthcdr 1 V15094)
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                       (shen/bind V15358
                                                                                                                                                                                                                                                  (append
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                     (list 'list
                                                                                                                                                                                                                                                           (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                  V15359 V15360)))
                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                             (shen/shen\.unbindv V15110 V15359)
                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                 'false)))
                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                      (shen/shen\.unbindv V15106 V15359)
                                                                                                                                                                                                      Result))))
                                                                                                                                                                                'false)))
                                                                                                                                                                    (shen/if
                                                                                                                                                                     (shen/shen\.pvar\? V15105)
                                                                                                                                                                     (shen/do
                                                                                                                                                                      (shen/shen\.bindv V15105 'list V15359)
                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                (shen/let V15111
                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                           (nthcdr 1 V15104)
                                                                                                                                                                                           V15359)
                                                                                                                                                                                          (shen/if
                                                                                                                                                                                           (shen/cons\? V15111)
                                                                                                                                                                                           (shen/let A
                                                                                                                                                                                                     (shen/hd V15111)
                                                                                                                                                                                                     (shen/let V15112
                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                (nthcdr 1 V15111)
                                                                                                                                                                                                                V15359)
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                 (null V15112))
                                                                                                                                                                                                                (shen/let V15113
                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                           (nthcdr 1 V15103)
                                                                                                                                                                                                                           V15359)
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/predicate->shen
                                                                                                                                                                                                                            (null V15113))
                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                     (nthcdr 1 V15094)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (list 'list
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                            (shen/shen\.pvar\? V15113)
                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                             (shen/shen\.bindv V15113 nil V15359)
                                                                                                                                                                                                                             (shen/let Result
                                                                                                                                                                                                                                       (shen/let Hyp
                                                                                                                                                                                                                                                 (nthcdr 1 V15094)
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                  (shen/bind V15358
                                                                                                                                                                                                                                                             (append
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                (list 'list
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                             V15359 V15360)))
                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                        (shen/shen\.unbindv V15113 V15359)
                                                                                                                                                                                                                                        Result)))
                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                 (shen/shen\.pvar\? V15112)
                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                  (shen/shen\.bindv V15112 nil V15359)
                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                            (shen/let V15114
                                                                                                                                                                                                                                      (shen/shen\.lazyderef
                                                                                                                                                                                                                                       (nthcdr 1 V15103)
                                                                                                                                                                                                                                       V15359)
                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                       (shen/predicate->shen
                                                                                                                                                                                                                                        (null V15114))
                                                                                                                                                                                                                                       (shen/let Hyp
                                                                                                                                                                                                                                                 (nthcdr 1 V15094)
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                  (shen/bind V15358
                                                                                                                                                                                                                                                             (append
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                (list 'list
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                             V15359 V15360)))
                                                                                                                                                                                                                                       (shen/if
                                                                                                                                                                                                                                        (shen/shen\.pvar\? V15114)
                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                         (shen/shen\.bindv V15114 nil V15359)
                                                                                                                                                                                                                                         (shen/let Result
                                                                                                                                                                                                                                                   (shen/let Hyp
                                                                                                                                                                                                                                                             (nthcdr 1 V15094)
                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                              (shen/shen\.incinfs)
                                                                                                                                                                                                                                                              (shen/bind V15358
                                                                                                                                                                                                                                                                         (append
                                                                                                                                                                                                                                                                          (list
                                                                                                                                                                                                                                                                           (list
                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                            ':
                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                           (list
                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                            ':
                                                                                                                                                                                                                                                                            (list 'list
                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                         V15359 V15360)))
                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                    (shen/shen\.unbindv V15114 V15359)
                                                                                                                                                                                                                                                    Result)))
                                                                                                                                                                                                                                        'false)))
                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                             (shen/shen\.unbindv V15112 V15359)
                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                 'false))))
                                                                                                                                                                                           (shen/if
                                                                                                                                                                                            (shen/shen\.pvar\? V15111)
                                                                                                                                                                                            (shen/let A
                                                                                                                                                                                                      (shen/shen\.newpv V15359)
                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                       (shen/shen\.bindv V15111
                                                                                                                                                                                                                         (list A)
                                                                                                                                                                                                                         V15359)
                                                                                                                                                                                                       (shen/let Result
                                                                                                                                                                                                                 (shen/let V15115
                                                                                                                                                                                                                           (shen/shen\.lazyderef
                                                                                                                                                                                                                            (nthcdr 1 V15103)
                                                                                                                                                                                                                            V15359)
                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                            (shen/predicate->shen
                                                                                                                                                                                                                             (null V15115))
                                                                                                                                                                                                                            (shen/let Hyp
                                                                                                                                                                                                                                      (nthcdr 1 V15094)
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                       (shen/bind V15358
                                                                                                                                                                                                                                                  (append
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                     (list 'list
                                                                                                                                                                                                                                                           (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                  V15359 V15360)))
                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                             (shen/shen\.pvar\? V15115)
                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                              (shen/shen\.bindv V15115 nil V15359)
                                                                                                                                                                                                                              (shen/let Result
                                                                                                                                                                                                                                        (shen/let Hyp
                                                                                                                                                                                                                                                  (nthcdr 1 V15094)
                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                   (shen/shen\.incinfs)
                                                                                                                                                                                                                                                   (shen/bind V15358
                                                                                                                                                                                                                                                              (append
                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                (list
                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                 ':
                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                (list
                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                 ':
                                                                                                                                                                                                                                                                 (list 'list
                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                              V15359 V15360)))
                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                         (shen/shen\.unbindv V15115 V15359)
                                                                                                                                                                                                                                         Result)))
                                                                                                                                                                                                                             'false)))
                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                  (shen/shen\.unbindv V15111 V15359)
                                                                                                                                                                                                                  Result))))
                                                                                                                                                                                            'false)))
                                                                                                                                                                                (shen/do
                                                                                                                                                                                 (shen/shen\.unbindv V15105 V15359)
                                                                                                                                                                                 Result)))
                                                                                                                                                                     'false)))
                                                                                                                                                         (shen/if
                                                                                                                                                          (shen/shen\.pvar\? V15104)
                                                                                                                                                          (shen/let A
                                                                                                                                                                    (shen/shen\.newpv V15359)
                                                                                                                                                                    (shen/do
                                                                                                                                                                     (shen/shen\.bindv V15104
                                                                                                                                                                                       (list 'list A)
                                                                                                                                                                                       V15359)
                                                                                                                                                                     (shen/let Result
                                                                                                                                                                               (shen/let V15116
                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                          (nthcdr 1 V15103)
                                                                                                                                                                                          V15359)
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/predicate->shen
                                                                                                                                                                                           (null V15116))
                                                                                                                                                                                          (shen/let Hyp
                                                                                                                                                                                                    (nthcdr 1 V15094)
                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                                                     (shen/bind V15358
                                                                                                                                                                                                                (append
                                                                                                                                                                                                                 (list
                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                   (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                   ':
                                                                                                                                                                                                                   (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                   (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                   ':
                                                                                                                                                                                                                   (list 'list
                                                                                                                                                                                                                         (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                 (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                V15359 V15360)))
                                                                                                                                                                                          (shen/if
                                                                                                                                                                                           (shen/shen\.pvar\? V15116)
                                                                                                                                                                                           (shen/do
                                                                                                                                                                                            (shen/shen\.bindv V15116 nil V15359)
                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                      (shen/let Hyp
                                                                                                                                                                                                                (nthcdr 1 V15094)
                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                 (shen/bind V15358
                                                                                                                                                                                                                            (append
                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                               (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                               ':
                                                                                                                                                                                                                               (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                               (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                               ':
                                                                                                                                                                                                                               (list 'list
                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                             (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                            V15359 V15360)))
                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                       (shen/shen\.unbindv V15116 V15359)
                                                                                                                                                                                                       Result)))
                                                                                                                                                                                           'false)))
                                                                                                                                                                               (shen/do
                                                                                                                                                                                (shen/shen\.unbindv V15104 V15359)
                                                                                                                                                                                Result))))
                                                                                                                                                          'false)))
                                                                                                                                              'false))
                                                                                                                                   'false))
                                                                                                                        'false))
                                                                                                             'false)))
                                                                                        'false)))
                                                                   'false))
                                                        'false))
                                             'false))
                                  'false))
                       'false))
            (shen/if
             (shen/= Case 'false)
             (shen/let Case
                       (shen/let V15117
                                 (shen/shen\.lazyderef V15357 V15359)
                                 (shen/if
                                  (shen/cons\? V15117)
                                  (shen/let V15118
                                            (shen/shen\.lazyderef
                                             (shen/hd V15117)
                                             V15359)
                                            (shen/if
                                             (shen/cons\? V15118)
                                             (shen/let V15119
                                                       (shen/shen\.lazyderef
                                                        (shen/hd V15118)
                                                        V15359)
                                                       (shen/if
                                                        (shen/cons\? V15119)
                                                        (shen/let V15120
                                                                  (shen/shen\.lazyderef
                                                                   (shen/hd V15119)
                                                                   V15359)
                                                                  (shen/if
                                                                   (shen/= '@p V15120)
                                                                   (shen/let V15121
                                                                             (shen/shen\.lazyderef
                                                                              (nthcdr 1 V15119)
                                                                              V15359)
                                                                             (shen/if
                                                                              (shen/cons\? V15121)
                                                                              (shen/let X
                                                                                        (shen/hd V15121)
                                                                                        (shen/let V15122
                                                                                                  (shen/shen\.lazyderef
                                                                                                   (nthcdr 1 V15121)
                                                                                                   V15359)
                                                                                                  (shen/if
                                                                                                   (shen/cons\? V15122)
                                                                                                   (shen/let Y
                                                                                                             (shen/hd V15122)
                                                                                                             (shen/let V15123
                                                                                                                       (shen/shen\.lazyderef
                                                                                                                        (nthcdr 1 V15122)
                                                                                                                        V15359)
                                                                                                                       (shen/if
                                                                                                                        (shen/predicate->shen
                                                                                                                         (null V15123))
                                                                                                                        (shen/let V15124
                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                   (nthcdr 1 V15118)
                                                                                                                                   V15359)
                                                                                                                                  (shen/if
                                                                                                                                   (shen/cons\? V15124)
                                                                                                                                   (shen/let V15125
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (shen/hd V15124)
                                                                                                                                              V15359)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/= ': V15125)
                                                                                                                                              (shen/let V15126
                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                         (nthcdr 1 V15124)
                                                                                                                                                         V15359)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/cons\? V15126)
                                                                                                                                                         (shen/let V15127
                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                    (shen/hd V15126)
                                                                                                                                                                    V15359)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/cons\? V15127)
                                                                                                                                                                    (shen/let A
                                                                                                                                                                              (shen/hd V15127)
                                                                                                                                                                              (shen/let V15128
                                                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                                                         (nthcdr 1 V15127)
                                                                                                                                                                                         V15359)
                                                                                                                                                                                        (shen/if
                                                                                                                                                                                         (shen/cons\? V15128)
                                                                                                                                                                                         (shen/let V15129
                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                    (shen/hd V15128)
                                                                                                                                                                                                    V15359)
                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                    (shen/= '* V15129)
                                                                                                                                                                                                    (shen/let V15130
                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                               (nthcdr 1 V15128)
                                                                                                                                                                                                               V15359)
                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                               (shen/cons\? V15130)
                                                                                                                                                                                                               (shen/let B
                                                                                                                                                                                                                         (shen/hd V15130)
                                                                                                                                                                                                                         (shen/let V15131
                                                                                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                                                                                    (nthcdr 1 V15130)
                                                                                                                                                                                                                                    V15359)
                                                                                                                                                                                                                                   (shen/if
                                                                                                                                                                                                                                    (shen/predicate->shen
                                                                                                                                                                                                                                     (null V15131))
                                                                                                                                                                                                                                    (shen/let V15132
                                                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                                                               (nthcdr 1 V15126)
                                                                                                                                                                                                                                               V15359)
                                                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                                                               (shen/predicate->shen
                                                                                                                                                                                                                                                (null V15132))
                                                                                                                                                                                                                                               (shen/let Hyp
                                                                                                                                                                                                                                                         (nthcdr 1 V15117)
                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                                                                                                                          (shen/bind V15358
                                                                                                                                                                                                                                                                     (append
                                                                                                                                                                                                                                                                      (list
                                                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                        ':
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                        ':
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                     V15359 V15360)))
                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                (shen/shen\.pvar\? V15132)
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.bindv V15132 nil V15359)
                                                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                                                     (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.unbindv V15132 V15359)
                                                                                                                                                                                                                                                            Result)))
                                                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                     (shen/shen\.pvar\? V15131)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.bindv V15131 nil V15359)
                                                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                                                (shen/let V15133
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                           (nthcdr 1 V15126)
                                                                                                                                                                                                                                                           V15359)
                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                           (shen/predicate->shen
                                                                                                                                                                                                                                                            (null V15133))
                                                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                                                     (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                            (shen/shen\.pvar\? V15133)
                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                             (shen/shen\.bindv V15133 nil V15359)
                                                                                                                                                                                                                                                             (shen/let Result
                                                                                                                                                                                                                                                                       (shen/let Hyp
                                                                                                                                                                                                                                                                                 (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                  (shen/bind V15358
                                                                                                                                                                                                                                                                                             (append
                                                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                             V15359 V15360)))
                                                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                                                        (shen/shen\.unbindv V15133 V15359)
                                                                                                                                                                                                                                                                        Result)))
                                                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.unbindv V15131 V15359)
                                                                                                                                                                                                                                                 Result)))
                                                                                                                                                                                                                                     'false))))
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/shen\.pvar\? V15130)
                                                                                                                                                                                                                (shen/let B
                                                                                                                                                                                                                          (shen/shen\.newpv V15359)
                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                           (shen/shen\.bindv V15130
                                                                                                                                                                                                                                             (list B)
                                                                                                                                                                                                                                             V15359)
                                                                                                                                                                                                                           (shen/let Result
                                                                                                                                                                                                                                     (shen/let V15134
                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                (nthcdr 1 V15126)
                                                                                                                                                                                                                                                V15359)
                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                                                 (null V15134))
                                                                                                                                                                                                                                                (shen/let Hyp
                                                                                                                                                                                                                                                          (nthcdr 1 V15117)
                                                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                                                           (shen/bind V15358
                                                                                                                                                                                                                                                                      (append
                                                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                         ':
                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                         ':
                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                      V15359 V15360)))
                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                 (shen/shen\.pvar\? V15134)
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.bindv V15134 nil V15359)
                                                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                                                            (shen/let Hyp
                                                                                                                                                                                                                                                                      (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                       (shen/bind V15358
                                                                                                                                                                                                                                                                                  (append
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                  V15359 V15360)))
                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                             (shen/shen\.unbindv V15134 V15359)
                                                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                                                 'false)))
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.unbindv V15130 V15359)
                                                                                                                                                                                                                                      Result))))
                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/shen\.pvar\? V15129)
                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                      (shen/shen\.bindv V15129 '* V15359)
                                                                                                                                                                                                      (shen/let Result
                                                                                                                                                                                                                (shen/let V15135
                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                           (nthcdr 1 V15128)
                                                                                                                                                                                                                           V15359)
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/cons\? V15135)
                                                                                                                                                                                                                           (shen/let B
                                                                                                                                                                                                                                     (shen/hd V15135)
                                                                                                                                                                                                                                     (shen/let V15136
                                                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                                                (nthcdr 1 V15135)
                                                                                                                                                                                                                                                V15359)
                                                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                                                 (null V15136))
                                                                                                                                                                                                                                                (shen/let V15137
                                                                                                                                                                                                                                                          (shen/shen\.lazyderef
                                                                                                                                                                                                                                                           (nthcdr 1 V15126)
                                                                                                                                                                                                                                                           V15359)
                                                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                                                           (shen/predicate->shen
                                                                                                                                                                                                                                                            (null V15137))
                                                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                                                     (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                            (shen/shen\.pvar\? V15137)
                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                             (shen/shen\.bindv V15137 nil V15359)
                                                                                                                                                                                                                                                             (shen/let Result
                                                                                                                                                                                                                                                                       (shen/let Hyp
                                                                                                                                                                                                                                                                                 (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                  (shen/bind V15358
                                                                                                                                                                                                                                                                                             (append
                                                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                             V15359 V15360)))
                                                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                                                        (shen/shen\.unbindv V15137 V15359)
                                                                                                                                                                                                                                                                        Result)))
                                                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                 (shen/shen\.pvar\? V15136)
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.bindv V15136 nil V15359)
                                                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                                                            (shen/let V15138
                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef
                                                                                                                                                                                                                                                                       (nthcdr 1 V15126)
                                                                                                                                                                                                                                                                       V15359)
                                                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                                                       (shen/predicate->shen
                                                                                                                                                                                                                                                                        (null V15138))
                                                                                                                                                                                                                                                                       (shen/let Hyp
                                                                                                                                                                                                                                                                                 (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                                                  (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                  (shen/bind V15358
                                                                                                                                                                                                                                                                                             (append
                                                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                                ':
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                             V15359 V15360)))
                                                                                                                                                                                                                                                                       (shen/if
                                                                                                                                                                                                                                                                        (shen/shen\.pvar\? V15138)
                                                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                                                         (shen/shen\.bindv V15138 nil V15359)
                                                                                                                                                                                                                                                                         (shen/let Result
                                                                                                                                                                                                                                                                                   (shen/let Hyp
                                                                                                                                                                                                                                                                                             (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                                                              (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                              (shen/bind V15358
                                                                                                                                                                                                                                                                                                         (append
                                                                                                                                                                                                                                                                                                          (list
                                                                                                                                                                                                                                                                                                           (list
                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                                            ':
                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                                           (list
                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                                            ':
                                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                                         V15359 V15360)))
                                                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                                                    (shen/shen\.unbindv V15138 V15359)
                                                                                                                                                                                                                                                                                    Result)))
                                                                                                                                                                                                                                                                        'false)))
                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                             (shen/shen\.unbindv V15136 V15359)
                                                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                                                 'false))))
                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                            (shen/shen\.pvar\? V15135)
                                                                                                                                                                                                                            (shen/let B
                                                                                                                                                                                                                                      (shen/shen\.newpv V15359)
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.bindv V15135
                                                                                                                                                                                                                                                         (list B)
                                                                                                                                                                                                                                                         V15359)
                                                                                                                                                                                                                                       (shen/let Result
                                                                                                                                                                                                                                                 (shen/let V15139
                                                                                                                                                                                                                                                           (shen/shen\.lazyderef
                                                                                                                                                                                                                                                            (nthcdr 1 V15126)
                                                                                                                                                                                                                                                            V15359)
                                                                                                                                                                                                                                                           (shen/if
                                                                                                                                                                                                                                                            (shen/predicate->shen
                                                                                                                                                                                                                                                             (null V15139))
                                                                                                                                                                                                                                                            (shen/let Hyp
                                                                                                                                                                                                                                                                      (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                       (shen/bind V15358
                                                                                                                                                                                                                                                                                  (append
                                                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                  V15359 V15360)))
                                                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                                                             (shen/shen\.pvar\? V15139)
                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                              (shen/shen\.bindv V15139 nil V15359)
                                                                                                                                                                                                                                                              (shen/let Result
                                                                                                                                                                                                                                                                        (shen/let Hyp
                                                                                                                                                                                                                                                                                  (nthcdr 1 V15117)
                                                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                                                   (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                   (shen/bind V15358
                                                                                                                                                                                                                                                                                              (append
                                                                                                                                                                                                                                                                                               (list
                                                                                                                                                                                                                                                                                                (list
                                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                                 ':
                                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                                (list
                                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                                 ':
                                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                                                               (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                              V15359 V15360)))
                                                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                                                         (shen/shen\.unbindv V15139 V15359)
                                                                                                                                                                                                                                                                         Result)))
                                                                                                                                                                                                                                                             'false)))
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.unbindv V15135 V15359)
                                                                                                                                                                                                                                                  Result))))
                                                                                                                                                                                                                            'false)))
                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                 (shen/shen\.unbindv V15129 V15359)
                                                                                                                                                                                                                 Result)))
                                                                                                                                                                                                     'false)))
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/shen\.pvar\? V15128)
                                                                                                                                                                                          (shen/let B
                                                                                                                                                                                                    (shen/shen\.newpv V15359)
                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                     (shen/shen\.bindv V15128
                                                                                                                                                                                                                       (list '* B)
                                                                                                                                                                                                                       V15359)
                                                                                                                                                                                                     (shen/let Result
                                                                                                                                                                                                               (shen/let V15140
                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                          (nthcdr 1 V15126)
                                                                                                                                                                                                                          V15359)
                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                          (shen/predicate->shen
                                                                                                                                                                                                                           (null V15140))
                                                                                                                                                                                                                          (shen/let Hyp
                                                                                                                                                                                                                                    (nthcdr 1 V15117)
                                                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                                                                                     (shen/bind V15358
                                                                                                                                                                                                                                                (append
                                                                                                                                                                                                                                                 (list
                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                   ':
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                   ':
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                 (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                V15359 V15360)))
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/shen\.pvar\? V15140)
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.bindv V15140 nil V15359)
                                                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                                                      (shen/let Hyp
                                                                                                                                                                                                                                                (nthcdr 1 V15117)
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                 (shen/bind V15358
                                                                                                                                                                                                                                                            (append
                                                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                               ':
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                               ':
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                             (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                            V15359 V15360)))
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.unbindv V15140 V15359)
                                                                                                                                                                                                                                       Result)))
                                                                                                                                                                                                                           'false)))
                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                (shen/shen\.unbindv V15128 V15359)
                                                                                                                                                                                                                Result))))
                                                                                                                                                                                          'false))))
                                                                                                                                                                    (shen/if
                                                                                                                                                                     (shen/shen\.pvar\? V15127)
                                                                                                                                                                     (shen/let A
                                                                                                                                                                               (shen/shen\.newpv V15359)
                                                                                                                                                                               (shen/let B
                                                                                                                                                                                         (shen/shen\.newpv V15359)
                                                                                                                                                                                         (shen/do
                                                                                                                                                                                          (shen/shen\.bindv V15127
                                                                                                                                                                                                            (list A '* B)
                                                                                                                                                                                                            V15359)
                                                                                                                                                                                          (shen/let Result
                                                                                                                                                                                                    (shen/let V15141
                                                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                                                               (nthcdr 1 V15126)
                                                                                                                                                                                                               V15359)
                                                                                                                                                                                                              (shen/if
                                                                                                                                                                                                               (shen/predicate->shen
                                                                                                                                                                                                                (null V15141))
                                                                                                                                                                                                               (shen/let Hyp
                                                                                                                                                                                                                         (nthcdr 1 V15117)
                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                                                                                          (shen/bind V15358
                                                                                                                                                                                                                                     (append
                                                                                                                                                                                                                                      (list
                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                        (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                        ':
                                                                                                                                                                                                                                        (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                        (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                        ':
                                                                                                                                                                                                                                        (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                      (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                     V15359 V15360)))
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/shen\.pvar\? V15141)
                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                 (shen/shen\.bindv V15141 nil V15359)
                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                           (shen/let Hyp
                                                                                                                                                                                                                                     (nthcdr 1 V15117)
                                                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                                                      (shen/shen\.incinfs)
                                                                                                                                                                                                                                      (shen/bind V15358
                                                                                                                                                                                                                                                 (append
                                                                                                                                                                                                                                                  (list
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                    ':
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef B V15359)))
                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                 V15359 V15360)))
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.unbindv V15141 V15359)
                                                                                                                                                                                                                            Result)))
                                                                                                                                                                                                                'false)))
                                                                                                                                                                                                    (shen/do
                                                                                                                                                                                                     (shen/shen\.unbindv V15127 V15359)
                                                                                                                                                                                                     Result)))))
                                                                                                                                                                     'false)))
                                                                                                                                                         'false))
                                                                                                                                              'false))
                                                                                                                                   'false))
                                                                                                                        'false)))
                                                                                                   'false)))
                                                                              'false))
                                                                   'false))
                                                        'false))
                                             'false))
                                  'false))
                       (shen/if
                        (shen/= Case 'false)
                        (shen/let Case
                                  (shen/let V15142
                                            (shen/shen\.lazyderef V15357 V15359)
                                            (shen/if
                                             (shen/cons\? V15142)
                                             (shen/let V15143
                                                       (shen/shen\.lazyderef
                                                        (shen/hd V15142)
                                                        V15359)
                                                       (shen/if
                                                        (shen/cons\? V15143)
                                                        (shen/let V15144
                                                                  (shen/shen\.lazyderef
                                                                   (shen/hd V15143)
                                                                   V15359)
                                                                  (shen/if
                                                                   (shen/cons\? V15144)
                                                                   (shen/let V15145
                                                                             (shen/shen\.lazyderef
                                                                              (shen/hd V15144)
                                                                              V15359)
                                                                             (shen/if
                                                                              (shen/= '@v V15145)
                                                                              (shen/let V15146
                                                                                        (shen/shen\.lazyderef
                                                                                         (nthcdr 1 V15144)
                                                                                         V15359)
                                                                                        (shen/if
                                                                                         (shen/cons\? V15146)
                                                                                         (shen/let X
                                                                                                   (shen/hd V15146)
                                                                                                   (shen/let V15147
                                                                                                             (shen/shen\.lazyderef
                                                                                                              (nthcdr 1 V15146)
                                                                                                              V15359)
                                                                                                             (shen/if
                                                                                                              (shen/cons\? V15147)
                                                                                                              (shen/let Y
                                                                                                                        (shen/hd V15147)
                                                                                                                        (shen/let V15148
                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                   (nthcdr 1 V15147)
                                                                                                                                   V15359)
                                                                                                                                  (shen/if
                                                                                                                                   (shen/predicate->shen
                                                                                                                                    (null V15148))
                                                                                                                                   (shen/let V15149
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (nthcdr 1 V15143)
                                                                                                                                              V15359)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/cons\? V15149)
                                                                                                                                              (shen/let V15150
                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                         (shen/hd V15149)
                                                                                                                                                         V15359)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/= ': V15150)
                                                                                                                                                         (shen/let V15151
                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                    (nthcdr 1 V15149)
                                                                                                                                                                    V15359)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/cons\? V15151)
                                                                                                                                                                    (shen/let V15152
                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                               (shen/hd V15151)
                                                                                                                                                                               V15359)
                                                                                                                                                                              (shen/if
                                                                                                                                                                               (shen/cons\? V15152)
                                                                                                                                                                               (shen/let V15153
                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                          (shen/hd V15152)
                                                                                                                                                                                          V15359)
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/= 'vector V15153)
                                                                                                                                                                                          (shen/let V15154
                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                     (nthcdr 1 V15152)
                                                                                                                                                                                                     V15359)
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/cons\? V15154)
                                                                                                                                                                                                     (shen/let A
                                                                                                                                                                                                               (shen/hd V15154)
                                                                                                                                                                                                               (shen/let V15155
                                                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                                                          (nthcdr 1 V15154)
                                                                                                                                                                                                                          V15359)
                                                                                                                                                                                                                         (shen/if
                                                                                                                                                                                                                          (shen/predicate->shen
                                                                                                                                                                                                                           (null V15155))
                                                                                                                                                                                                                          (shen/let V15156
                                                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                                                     (nthcdr 1 V15151)
                                                                                                                                                                                                                                     V15359)
                                                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                                                     (shen/predicate->shen
                                                                                                                                                                                                                                      (null V15156))
                                                                                                                                                                                                                                     (shen/let Hyp
                                                                                                                                                                                                                                               (nthcdr 1 V15142)
                                                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                                                (shen/bind V15358
                                                                                                                                                                                                                                                           (append
                                                                                                                                                                                                                                                            (list
                                                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                                                              (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                              ':
                                                                                                                                                                                                                                                              (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                                                              (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                              ':
                                                                                                                                                                                                                                                              (list 'vector
                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                            (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                           V15359 V15360)))
                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                      (shen/shen\.pvar\? V15156)
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.bindv V15156 nil V15359)
                                                                                                                                                                                                                                       (shen/let Result
                                                                                                                                                                                                                                                 (shen/let Hyp
                                                                                                                                                                                                                                                           (nthcdr 1 V15142)
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                            (shen/bind V15358
                                                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                          ':
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                          ':
                                                                                                                                                                                                                                                                          (list 'vector
                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                       V15359 V15360)))
                                                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                                                  (shen/shen\.unbindv V15156 V15359)
                                                                                                                                                                                                                                                  Result)))
                                                                                                                                                                                                                                      'false)))
                                                                                                                                                                                                                          (shen/if
                                                                                                                                                                                                                           (shen/shen\.pvar\? V15155)
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.bindv V15155 nil V15359)
                                                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                                                      (shen/let V15157
                                                                                                                                                                                                                                                (shen/shen\.lazyderef
                                                                                                                                                                                                                                                 (nthcdr 1 V15151)
                                                                                                                                                                                                                                                 V15359)
                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                 (shen/predicate->shen
                                                                                                                                                                                                                                                  (null V15157))
                                                                                                                                                                                                                                                 (shen/let Hyp
                                                                                                                                                                                                                                                           (nthcdr 1 V15142)
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                            (shen/bind V15358
                                                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                          ':
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                          ':
                                                                                                                                                                                                                                                                          (list 'vector
                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                       V15359 V15360)))
                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                  (shen/shen\.pvar\? V15157)
                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                   (shen/shen\.bindv V15157 nil V15359)
                                                                                                                                                                                                                                                   (shen/let Result
                                                                                                                                                                                                                                                             (shen/let Hyp
                                                                                                                                                                                                                                                                       (nthcdr 1 V15142)
                                                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                                                        (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                        (shen/bind V15358
                                                                                                                                                                                                                                                                                   (append
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                      ':
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                      ':
                                                                                                                                                                                                                                                                                      (list 'vector
                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                   V15359 V15360)))
                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                              (shen/shen\.unbindv V15157 V15359)
                                                                                                                                                                                                                                                              Result)))
                                                                                                                                                                                                                                                  'false)))
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.unbindv V15155 V15359)
                                                                                                                                                                                                                                       Result)))
                                                                                                                                                                                                                           'false))))
                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                      (shen/shen\.pvar\? V15154)
                                                                                                                                                                                                      (shen/let A
                                                                                                                                                                                                                (shen/shen\.newpv V15359)
                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                 (shen/shen\.bindv V15154
                                                                                                                                                                                                                                   (list A)
                                                                                                                                                                                                                                   V15359)
                                                                                                                                                                                                                 (shen/let Result
                                                                                                                                                                                                                           (shen/let V15158
                                                                                                                                                                                                                                     (shen/shen\.lazyderef
                                                                                                                                                                                                                                      (nthcdr 1 V15151)
                                                                                                                                                                                                                                      V15359)
                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                      (shen/predicate->shen
                                                                                                                                                                                                                                       (null V15158))
                                                                                                                                                                                                                                      (shen/let Hyp
                                                                                                                                                                                                                                                (nthcdr 1 V15142)
                                                                                                                                                                                                                                                (shen/do
                                                                                                                                                                                                                                                 (shen/shen\.incinfs)
                                                                                                                                                                                                                                                 (shen/bind V15358
                                                                                                                                                                                                                                                            (append
                                                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                               ':
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                              (list
                                                                                                                                                                                                                                                               (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                               ':
                                                                                                                                                                                                                                                               (list 'vector
                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                             (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                            V15359 V15360)))
                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                       (shen/shen\.pvar\? V15158)
                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                        (shen/shen\.bindv V15158 nil V15359)
                                                                                                                                                                                                                                        (shen/let Result
                                                                                                                                                                                                                                                  (shen/let Hyp
                                                                                                                                                                                                                                                            (nthcdr 1 V15142)
                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                                                                                                                                             (shen/bind V15358
                                                                                                                                                                                                                                                                        (append
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (list
                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                           ':
                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                          (list
                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                           ':
                                                                                                                                                                                                                                                                           (list 'vector
                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                        V15359 V15360)))
                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                   (shen/shen\.unbindv V15158 V15359)
                                                                                                                                                                                                                                                   Result)))
                                                                                                                                                                                                                                       'false)))
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.unbindv V15154 V15359)
                                                                                                                                                                                                                            Result))))
                                                                                                                                                                                                      'false)))
                                                                                                                                                                                          (shen/if
                                                                                                                                                                                           (shen/shen\.pvar\? V15153)
                                                                                                                                                                                           (shen/do
                                                                                                                                                                                            (shen/shen\.bindv V15153 'vector V15359)
                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                      (shen/let V15159
                                                                                                                                                                                                                (shen/shen\.lazyderef
                                                                                                                                                                                                                 (nthcdr 1 V15152)
                                                                                                                                                                                                                 V15359)
                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                 (shen/cons\? V15159)
                                                                                                                                                                                                                 (shen/let A
                                                                                                                                                                                                                           (shen/hd V15159)
                                                                                                                                                                                                                           (shen/let V15160
                                                                                                                                                                                                                                     (shen/shen\.lazyderef
                                                                                                                                                                                                                                      (nthcdr 1 V15159)
                                                                                                                                                                                                                                      V15359)
                                                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                                                      (shen/predicate->shen
                                                                                                                                                                                                                                       (null V15160))
                                                                                                                                                                                                                                      (shen/let V15161
                                                                                                                                                                                                                                                (shen/shen\.lazyderef
                                                                                                                                                                                                                                                 (nthcdr 1 V15151)
                                                                                                                                                                                                                                                 V15359)
                                                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                                                 (shen/predicate->shen
                                                                                                                                                                                                                                                  (null V15161))
                                                                                                                                                                                                                                                 (shen/let Hyp
                                                                                                                                                                                                                                                           (nthcdr 1 V15142)
                                                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                                                            (shen/bind V15358
                                                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                          ':
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                          ':
                                                                                                                                                                                                                                                                          (list 'vector
                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                       V15359 V15360)))
                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                  (shen/shen\.pvar\? V15161)
                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                   (shen/shen\.bindv V15161 nil V15359)
                                                                                                                                                                                                                                                   (shen/let Result
                                                                                                                                                                                                                                                             (shen/let Hyp
                                                                                                                                                                                                                                                                       (nthcdr 1 V15142)
                                                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                                                        (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                        (shen/bind V15358
                                                                                                                                                                                                                                                                                   (append
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                      ':
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                      ':
                                                                                                                                                                                                                                                                                      (list 'vector
                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                   V15359 V15360)))
                                                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                                                              (shen/shen\.unbindv V15161 V15359)
                                                                                                                                                                                                                                                              Result)))
                                                                                                                                                                                                                                                  'false)))
                                                                                                                                                                                                                                      (shen/if
                                                                                                                                                                                                                                       (shen/shen\.pvar\? V15160)
                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                        (shen/shen\.bindv V15160 nil V15359)
                                                                                                                                                                                                                                        (shen/let Result
                                                                                                                                                                                                                                                  (shen/let V15162
                                                                                                                                                                                                                                                            (shen/shen\.lazyderef
                                                                                                                                                                                                                                                             (nthcdr 1 V15151)
                                                                                                                                                                                                                                                             V15359)
                                                                                                                                                                                                                                                            (shen/if
                                                                                                                                                                                                                                                             (shen/predicate->shen
                                                                                                                                                                                                                                                              (null V15162))
                                                                                                                                                                                                                                                             (shen/let Hyp
                                                                                                                                                                                                                                                                       (nthcdr 1 V15142)
                                                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                                                        (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                        (shen/bind V15358
                                                                                                                                                                                                                                                                                   (append
                                                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                      ':
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                      ':
                                                                                                                                                                                                                                                                                      (list 'vector
                                                                                                                                                                                                                                                                                            (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                   V15359 V15360)))
                                                                                                                                                                                                                                                             (shen/if
                                                                                                                                                                                                                                                              (shen/shen\.pvar\? V15162)
                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                               (shen/shen\.bindv V15162 nil V15359)
                                                                                                                                                                                                                                                               (shen/let Result
                                                                                                                                                                                                                                                                         (shen/let Hyp
                                                                                                                                                                                                                                                                                   (nthcdr 1 V15142)
                                                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                                                    (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                                    (shen/bind V15358
                                                                                                                                                                                                                                                                                               (append
                                                                                                                                                                                                                                                                                                (list
                                                                                                                                                                                                                                                                                                 (list
                                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                                  ':
                                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                                 (list
                                                                                                                                                                                                                                                                                                  (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                                  ':
                                                                                                                                                                                                                                                                                                  (list 'vector
                                                                                                                                                                                                                                                                                                        (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                                                (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                               V15359 V15360)))
                                                                                                                                                                                                                                                                         (shen/do
                                                                                                                                                                                                                                                                          (shen/shen\.unbindv V15162 V15359)
                                                                                                                                                                                                                                                                          Result)))
                                                                                                                                                                                                                                                              'false)))
                                                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                                                   (shen/shen\.unbindv V15160 V15359)
                                                                                                                                                                                                                                                   Result)))
                                                                                                                                                                                                                                       'false))))
                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                  (shen/shen\.pvar\? V15159)
                                                                                                                                                                                                                  (shen/let A
                                                                                                                                                                                                                            (shen/shen\.newpv V15359)
                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                             (shen/shen\.bindv V15159
                                                                                                                                                                                                                                               (list A)
                                                                                                                                                                                                                                               V15359)
                                                                                                                                                                                                                             (shen/let Result
                                                                                                                                                                                                                                       (shen/let V15163
                                                                                                                                                                                                                                                 (shen/shen\.lazyderef
                                                                                                                                                                                                                                                  (nthcdr 1 V15151)
                                                                                                                                                                                                                                                  V15359)
                                                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                                                  (shen/predicate->shen
                                                                                                                                                                                                                                                   (null V15163))
                                                                                                                                                                                                                                                  (shen/let Hyp
                                                                                                                                                                                                                                                            (nthcdr 1 V15142)
                                                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                                                                                                                                             (shen/bind V15358
                                                                                                                                                                                                                                                                        (append
                                                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                                                          (list
                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                           ':
                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                          (list
                                                                                                                                                                                                                                                                           (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                           ':
                                                                                                                                                                                                                                                                           (list 'vector
                                                                                                                                                                                                                                                                                 (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                         (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                        V15359 V15360)))
                                                                                                                                                                                                                                                  (shen/if
                                                                                                                                                                                                                                                   (shen/shen\.pvar\? V15163)
                                                                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                                                                    (shen/shen\.bindv V15163 nil V15359)
                                                                                                                                                                                                                                                    (shen/let Result
                                                                                                                                                                                                                                                              (shen/let Hyp
                                                                                                                                                                                                                                                                        (nthcdr 1 V15142)
                                                                                                                                                                                                                                                                        (shen/do
                                                                                                                                                                                                                                                                         (shen/shen\.incinfs)
                                                                                                                                                                                                                                                                         (shen/bind V15358
                                                                                                                                                                                                                                                                                    (append
                                                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                                                      (list
                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                                                       ':
                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                                                      (list
                                                                                                                                                                                                                                                                                       (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                                                       ':
                                                                                                                                                                                                                                                                                       (list 'vector
                                                                                                                                                                                                                                                                                             (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                                                     (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                                                    V15359 V15360)))
                                                                                                                                                                                                                                                              (shen/do
                                                                                                                                                                                                                                                               (shen/shen\.unbindv V15163 V15359)
                                                                                                                                                                                                                                                               Result)))
                                                                                                                                                                                                                                                   'false)))
                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                        (shen/shen\.unbindv V15159 V15359)
                                                                                                                                                                                                                                        Result))))
                                                                                                                                                                                                                  'false)))
                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                       (shen/shen\.unbindv V15153 V15359)
                                                                                                                                                                                                       Result)))
                                                                                                                                                                                           'false)))
                                                                                                                                                                               (shen/if
                                                                                                                                                                                (shen/shen\.pvar\? V15152)
                                                                                                                                                                                (shen/let A
                                                                                                                                                                                          (shen/shen\.newpv V15359)
                                                                                                                                                                                          (shen/do
                                                                                                                                                                                           (shen/shen\.bindv V15152
                                                                                                                                                                                                             (list 'vector A)
                                                                                                                                                                                                             V15359)
                                                                                                                                                                                           (shen/let Result
                                                                                                                                                                                                     (shen/let V15164
                                                                                                                                                                                                               (shen/shen\.lazyderef
                                                                                                                                                                                                                (nthcdr 1 V15151)
                                                                                                                                                                                                                V15359)
                                                                                                                                                                                                               (shen/if
                                                                                                                                                                                                                (shen/predicate->shen
                                                                                                                                                                                                                 (null V15164))
                                                                                                                                                                                                                (shen/let Hyp
                                                                                                                                                                                                                          (nthcdr 1 V15142)
                                                                                                                                                                                                                          (shen/do
                                                                                                                                                                                                                           (shen/shen\.incinfs)
                                                                                                                                                                                                                           (shen/bind V15358
                                                                                                                                                                                                                                      (append
                                                                                                                                                                                                                                       (list
                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                         (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                         ':
                                                                                                                                                                                                                                         (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                         (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                         ':
                                                                                                                                                                                                                                         (list 'vector
                                                                                                                                                                                                                                               (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                       (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                      V15359 V15360)))
                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                 (shen/shen\.pvar\? V15164)
                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                  (shen/shen\.bindv V15164 nil V15359)
                                                                                                                                                                                                                  (shen/let Result
                                                                                                                                                                                                                            (shen/let Hyp
                                                                                                                                                                                                                                      (nthcdr 1 V15142)
                                                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                                                       (shen/shen\.incinfs)
                                                                                                                                                                                                                                       (shen/bind V15358
                                                                                                                                                                                                                                                  (append
                                                                                                                                                                                                                                                   (list
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef A V15359))
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                     ':
                                                                                                                                                                                                                                                     (list 'vector
                                                                                                                                                                                                                                                           (shen/shen\.lazyderef A V15359))))
                                                                                                                                                                                                                                                   (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                  V15359 V15360)))
                                                                                                                                                                                                                            (shen/do
                                                                                                                                                                                                                             (shen/shen\.unbindv V15164 V15359)
                                                                                                                                                                                                                             Result)))
                                                                                                                                                                                                                 'false)))
                                                                                                                                                                                                     (shen/do
                                                                                                                                                                                                      (shen/shen\.unbindv V15152 V15359)
                                                                                                                                                                                                      Result))))
                                                                                                                                                                                'false)))
                                                                                                                                                                    'false))
                                                                                                                                                         'false))
                                                                                                                                              'false))
                                                                                                                                   'false)))
                                                                                                              'false)))
                                                                                         'false))
                                                                              'false))
                                                                   'false))
                                                        'false))
                                             'false))
                                  (shen/if
                                   (shen/= Case 'false)
                                   (shen/let Case
                                             (shen/let V15165
                                                       (shen/shen\.lazyderef V15357 V15359)
                                                       (shen/if
                                                        (shen/cons\? V15165)
                                                        (shen/let V15166
                                                                  (shen/shen\.lazyderef
                                                                   (shen/hd V15165)
                                                                   V15359)
                                                                  (shen/if
                                                                   (shen/cons\? V15166)
                                                                   (shen/let V15167
                                                                             (shen/shen\.lazyderef
                                                                              (shen/hd V15166)
                                                                              V15359)
                                                                             (shen/if
                                                                              (shen/cons\? V15167)
                                                                              (shen/let V15168
                                                                                        (shen/shen\.lazyderef
                                                                                         (shen/hd V15167)
                                                                                         V15359)
                                                                                        (shen/if
                                                                                         (shen/= '@s V15168)
                                                                                         (shen/let V15169
                                                                                                   (shen/shen\.lazyderef
                                                                                                    (nthcdr 1 V15167)
                                                                                                    V15359)
                                                                                                   (shen/if
                                                                                                    (shen/cons\? V15169)
                                                                                                    (shen/let X
                                                                                                              (shen/hd V15169)
                                                                                                              (shen/let V15170
                                                                                                                        (shen/shen\.lazyderef
                                                                                                                         (nthcdr 1 V15169)
                                                                                                                         V15359)
                                                                                                                        (shen/if
                                                                                                                         (shen/cons\? V15170)
                                                                                                                         (shen/let Y
                                                                                                                                   (shen/hd V15170)
                                                                                                                                   (shen/let V15171
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (nthcdr 1 V15170)
                                                                                                                                              V15359)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/predicate->shen
                                                                                                                                               (null V15171))
                                                                                                                                              (shen/let V15172
                                                                                                                                                        (shen/shen\.lazyderef
                                                                                                                                                         (nthcdr 1 V15166)
                                                                                                                                                         V15359)
                                                                                                                                                        (shen/if
                                                                                                                                                         (shen/cons\? V15172)
                                                                                                                                                         (shen/let V15173
                                                                                                                                                                   (shen/shen\.lazyderef
                                                                                                                                                                    (shen/hd V15172)
                                                                                                                                                                    V15359)
                                                                                                                                                                   (shen/if
                                                                                                                                                                    (shen/= ': V15173)
                                                                                                                                                                    (shen/let V15174
                                                                                                                                                                              (shen/shen\.lazyderef
                                                                                                                                                                               (nthcdr 1 V15172)
                                                                                                                                                                               V15359)
                                                                                                                                                                              (shen/if
                                                                                                                                                                               (shen/cons\? V15174)
                                                                                                                                                                               (shen/let V15175
                                                                                                                                                                                         (shen/shen\.lazyderef
                                                                                                                                                                                          (shen/hd V15174)
                                                                                                                                                                                          V15359)
                                                                                                                                                                                         (shen/if
                                                                                                                                                                                          (shen/= 'string V15175)
                                                                                                                                                                                          (shen/let V15176
                                                                                                                                                                                                    (shen/shen\.lazyderef
                                                                                                                                                                                                     (nthcdr 1 V15174)
                                                                                                                                                                                                     V15359)
                                                                                                                                                                                                    (shen/if
                                                                                                                                                                                                     (shen/predicate->shen
                                                                                                                                                                                                      (null V15176))
                                                                                                                                                                                                     (shen/let Hyp
                                                                                                                                                                                                               (nthcdr 1 V15165)
                                                                                                                                                                                                               (shen/do
                                                                                                                                                                                                                (shen/shen\.incinfs)
                                                                                                                                                                                                                (shen/bind V15358
                                                                                                                                                                                                                           (append
                                                                                                                                                                                                                            (list
                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                              (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                              ': 'string)
                                                                                                                                                                                                                             (list
                                                                                                                                                                                                                              (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                              ': 'string))
                                                                                                                                                                                                                            (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                           V15359 V15360)))
                                                                                                                                                                                                     (shen/if
                                                                                                                                                                                                      (shen/shen\.pvar\? V15176)
                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                       (shen/shen\.bindv V15176 nil V15359)
                                                                                                                                                                                                       (shen/let Result
                                                                                                                                                                                                                 (shen/let Hyp
                                                                                                                                                                                                                           (nthcdr 1 V15165)
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                            (shen/bind V15358
                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                          (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                          ': 'string)
                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                          (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                          ': 'string))
                                                                                                                                                                                                                                        (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                       V15359 V15360)))
                                                                                                                                                                                                                 (shen/do
                                                                                                                                                                                                                  (shen/shen\.unbindv V15176 V15359)
                                                                                                                                                                                                                  Result)))
                                                                                                                                                                                                      'false)))
                                                                                                                                                                                          (shen/if
                                                                                                                                                                                           (shen/shen\.pvar\? V15175)
                                                                                                                                                                                           (shen/do
                                                                                                                                                                                            (shen/shen\.bindv V15175 'string V15359)
                                                                                                                                                                                            (shen/let Result
                                                                                                                                                                                                      (shen/let V15177
                                                                                                                                                                                                                (shen/shen\.lazyderef
                                                                                                                                                                                                                 (nthcdr 1 V15174)
                                                                                                                                                                                                                 V15359)
                                                                                                                                                                                                                (shen/if
                                                                                                                                                                                                                 (shen/predicate->shen
                                                                                                                                                                                                                  (null V15177))
                                                                                                                                                                                                                 (shen/let Hyp
                                                                                                                                                                                                                           (nthcdr 1 V15165)
                                                                                                                                                                                                                           (shen/do
                                                                                                                                                                                                                            (shen/shen\.incinfs)
                                                                                                                                                                                                                            (shen/bind V15358
                                                                                                                                                                                                                                       (append
                                                                                                                                                                                                                                        (list
                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                          (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                          ': 'string)
                                                                                                                                                                                                                                         (list
                                                                                                                                                                                                                                          (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                          ': 'string))
                                                                                                                                                                                                                                        (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                       V15359 V15360)))
                                                                                                                                                                                                                 (shen/if
                                                                                                                                                                                                                  (shen/shen\.pvar\? V15177)
                                                                                                                                                                                                                  (shen/do
                                                                                                                                                                                                                   (shen/shen\.bindv V15177 nil V15359)
                                                                                                                                                                                                                   (shen/let Result
                                                                                                                                                                                                                             (shen/let Hyp
                                                                                                                                                                                                                                       (nthcdr 1 V15165)
                                                                                                                                                                                                                                       (shen/do
                                                                                                                                                                                                                                        (shen/shen\.incinfs)
                                                                                                                                                                                                                                        (shen/bind V15358
                                                                                                                                                                                                                                                   (append
                                                                                                                                                                                                                                                    (list
                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                      (shen/shen\.lazyderef X V15359)
                                                                                                                                                                                                                                                      ': 'string)
                                                                                                                                                                                                                                                     (list
                                                                                                                                                                                                                                                      (shen/shen\.lazyderef Y V15359)
                                                                                                                                                                                                                                                      ': 'string))
                                                                                                                                                                                                                                                    (shen/shen\.lazyderef Hyp V15359))
                                                                                                                                                                                                                                                   V15359 V15360)))
                                                                                                                                                                                                                             (shen/do
                                                                                                                                                                                                                              (shen/shen\.unbindv V15177 V15359)
                                                                                                                                                                                                                              Result)))
                                                                                                                                                                                                                  'false)))
                                                                                                                                                                                                      (shen/do
                                                                                                                                                                                                       (shen/shen\.unbindv V15175 V15359)
                                                                                                                                                                                                       Result)))
                                                                                                                                                                                           'false)))
                                                                                                                                                                               'false))
                                                                                                                                                                    'false))
                                                                                                                                                         'false))
                                                                                                                                              'false)))
                                                                                                                         'false)))
                                                                                                    'false))
                                                                                         'false))
                                                                              'false))
                                                                   'false))
                                                        'false))
                                             (shen/if
                                              (shen/= Case 'false)
                                              (shen/let V15178
                                                        (shen/shen\.lazyderef V15357 V15359)
                                                        (shen/if
                                                         (shen/cons\? V15178)
                                                         (shen/let X
                                                                   (shen/hd V15178)
                                                                   (shen/let Hyp
                                                                             (nthcdr 1 V15178)
                                                                             (shen/let NewHyps
                                                                                       (shen/shen\.newpv V15359)
                                                                                       (shen/do
                                                                                        (shen/shen\.incinfs)
                                                                                        (shen/bind V15358
                                                                                                   (append
                                                                                                    (list
                                                                                                     (shen/shen\.lazyderef X V15359))
                                                                                                    (shen/shen\.lazyderef NewHyps V15359))
                                                                                                   V15359
                                                                                                   (shen/freeze
                                                                                                    (shen/shen\.t*-hyps Hyp NewHyps V15359 V15360)))))))
                                                         'false))
                                              Case))
                                   Case))
                        Case))
             Case)))
(defun shen/shen\.show
    (V15377 V15378 V15379 V15380)
  (shen/cond
   ((shen/value 'shen\.*spy*)
    (shen/do
     (shen/shen\.line)
     (shen/do
      (shen/shen\.show-p
       (shen/shen\.deref V15377 V15379))
      (shen/do
       (shen/nl 1)
       (shen/do
        (shen/nl 1)
        (shen/do
         (shen/shen\.show-assumptions
          (shen/shen\.deref V15378 V15379)
          1)
         (shen/do
          (shen/shen\.prhush "\n> "
                             (shen/stoutput))
          (shen/do
           (shen/shen\.pause-for-user)
           (shen/thaw V15380)))))))))
   (shen/true
    (shen/thaw V15380))))
(defun shen/shen\.line nil
  (shen/let Infs
            (shen/inferences)
            (shen/shen\.prhush
             (shen/cn "____________________________________________________________ "
                      (shen/shen\.app Infs
                                      (shen/cn " inference"
                                               (shen/shen\.app
                                                (shen/if
                                                 (shen/= 1 Infs)
                                                 "" "s")
                                                " \n?- " 'shen\.a))
                                      'shen\.a))
             (shen/stoutput))))
(defun shen/shen\.show-p
    (V15382)
  (shen/cond
   ((shen/and
     (shen/cons\? V15382)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V15382))
      (shen/and
       (shen/= ':
               (shen/hd
                (nthcdr 1 V15382)))
       (shen/and
        (shen/cons\?
         (nthcdr 2 V15382))
        (shen/predicate->shen
         (null
          (nthcdr 3 V15382)))))))
    (shen/shen\.prhush
     (shen/shen\.app
      (shen/hd V15382)
      (shen/cn " : "
               (shen/shen\.app
                (shen/hd
                 (nthcdr 2 V15382))
                "" 'shen\.r))
      'shen\.r)
     (shen/stoutput)))
   (shen/true
    (shen/shen\.prhush
     (shen/shen\.app V15382 "" 'shen\.r)
     (shen/stoutput)))))
(defun shen/shen\.show-assumptions
    (V15387 V15388)
  (cl-flet
      ((tail-trampoline
        (V15387 V15388)
        (shen/cond
         ((shen/predicate->shen
           (null V15387))
          'shen\.skip)
         ((shen/cons\? V15387)
          (shen/do
           (shen/shen\.prhush
            (shen/shen\.app V15388 ". " 'shen\.a)
            (shen/stoutput))
           (shen/do
            (shen/shen\.show-p
             (shen/hd V15387))
            (shen/do
             (shen/nl 1)
             (vector
              (list
               (nthcdr 1 V15387)
               (1+ V15388)))))))
         (shen/true
          (shen/shen\.f_error 'shen\.show-assumptions)))))
    (let
        ((result
          (funcall #'tail-trampoline V15387 V15388)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.pause-for-user nil
  (shen/let Byte
            (shen/read-byte
             (shen/stinput))
            (shen/if
             (shen/= Byte 94)
             (shen/simple-error "input aborted\n")
             (shen/nl 1))))
(defun shen/shen\.typedf\?
    (V15390)
  (shen/cons\?
   (shen/assoc V15390
               (shen/value 'shen\.*signedfuncs*))))
(defun shen/shen\.sigf
    (V15392)
  (shen/concat 'shen\.type-signature-of- V15392))
(defun shen/shen\.placeholder nil
  (shen/gensym '&&))
(defun shen/shen\.base
    (V15397 V15398 V15399 V15400)
  (shen/let Case
            (shen/let V15081
                      (shen/shen\.lazyderef V15398 V15399)
                      (shen/if
                       (shen/= 'number V15081)
                       (shen/do
                        (shen/shen\.incinfs)
                        (shen/fwhen
                         (shen/number\?
                          (shen/shen\.lazyderef V15397 V15399))
                         V15399 V15400))
                       (shen/if
                        (shen/shen\.pvar\? V15081)
                        (shen/do
                         (shen/shen\.bindv V15081 'number V15399)
                         (shen/let Result
                                   (shen/do
                                    (shen/shen\.incinfs)
                                    (shen/fwhen
                                     (shen/number\?
                                      (shen/shen\.lazyderef V15397 V15399))
                                     V15399 V15400))
                                   (shen/do
                                    (shen/shen\.unbindv V15081 V15399)
                                    Result)))
                        'false)))
            (shen/if
             (shen/= Case 'false)
             (shen/let Case
                       (shen/let V15082
                                 (shen/shen\.lazyderef V15398 V15399)
                                 (shen/if
                                  (shen/= 'boolean V15082)
                                  (shen/do
                                   (shen/shen\.incinfs)
                                   (shen/fwhen
                                    (shen/boolean\?
                                     (shen/shen\.lazyderef V15397 V15399))
                                    V15399 V15400))
                                  (shen/if
                                   (shen/shen\.pvar\? V15082)
                                   (shen/do
                                    (shen/shen\.bindv V15082 'boolean V15399)
                                    (shen/let Result
                                              (shen/do
                                               (shen/shen\.incinfs)
                                               (shen/fwhen
                                                (shen/boolean\?
                                                 (shen/shen\.lazyderef V15397 V15399))
                                                V15399 V15400))
                                              (shen/do
                                               (shen/shen\.unbindv V15082 V15399)
                                               Result)))
                                   'false)))
                       (shen/if
                        (shen/= Case 'false)
                        (shen/let Case
                                  (shen/let V15083
                                            (shen/shen\.lazyderef V15398 V15399)
                                            (shen/if
                                             (shen/= 'string V15083)
                                             (shen/do
                                              (shen/shen\.incinfs)
                                              (shen/fwhen
                                               (shen/string\?
                                                (shen/shen\.lazyderef V15397 V15399))
                                               V15399 V15400))
                                             (shen/if
                                              (shen/shen\.pvar\? V15083)
                                              (shen/do
                                               (shen/shen\.bindv V15083 'string V15399)
                                               (shen/let Result
                                                         (shen/do
                                                          (shen/shen\.incinfs)
                                                          (shen/fwhen
                                                           (shen/string\?
                                                            (shen/shen\.lazyderef V15397 V15399))
                                                           V15399 V15400))
                                                         (shen/do
                                                          (shen/shen\.unbindv V15083 V15399)
                                                          Result)))
                                              'false)))
                                  (shen/if
                                   (shen/= Case 'false)
                                   (shen/let Case
                                             (shen/let V15084
                                                       (shen/shen\.lazyderef V15398 V15399)
                                                       (shen/if
                                                        (shen/= 'symbol V15084)
                                                        (shen/do
                                                         (shen/shen\.incinfs)
                                                         (shen/fwhen
                                                          (shen/symbol\?
                                                           (shen/shen\.lazyderef V15397 V15399))
                                                          V15399
                                                          (shen/freeze
                                                           (shen/fwhen
                                                            (shen/not
                                                             (shen/shen\.ue\?
                                                              (shen/shen\.lazyderef V15397 V15399)))
                                                            V15399 V15400))))
                                                        (shen/if
                                                         (shen/shen\.pvar\? V15084)
                                                         (shen/do
                                                          (shen/shen\.bindv V15084 'symbol V15399)
                                                          (shen/let Result
                                                                    (shen/do
                                                                     (shen/shen\.incinfs)
                                                                     (shen/fwhen
                                                                      (shen/symbol\?
                                                                       (shen/shen\.lazyderef V15397 V15399))
                                                                      V15399
                                                                      (shen/freeze
                                                                       (shen/fwhen
                                                                        (shen/not
                                                                         (shen/shen\.ue\?
                                                                          (shen/shen\.lazyderef V15397 V15399)))
                                                                        V15399 V15400))))
                                                                    (shen/do
                                                                     (shen/shen\.unbindv V15084 V15399)
                                                                     Result)))
                                                         'false)))
                                             (shen/if
                                              (shen/= Case 'false)
                                              (shen/let V15085
                                                        (shen/shen\.lazyderef V15397 V15399)
                                                        (shen/if
                                                         (shen/predicate->shen
                                                          (null V15085))
                                                         (shen/let V15086
                                                                   (shen/shen\.lazyderef V15398 V15399)
                                                                   (shen/if
                                                                    (shen/cons\? V15086)
                                                                    (shen/let V15087
                                                                              (shen/shen\.lazyderef
                                                                               (shen/hd V15086)
                                                                               V15399)
                                                                              (shen/if
                                                                               (shen/= 'list V15087)
                                                                               (shen/let V15088
                                                                                         (shen/shen\.lazyderef
                                                                                          (nthcdr 1 V15086)
                                                                                          V15399)
                                                                                         (shen/if
                                                                                          (shen/cons\? V15088)
                                                                                          (shen/let A
                                                                                                    (shen/hd V15088)
                                                                                                    (shen/let V15089
                                                                                                              (shen/shen\.lazyderef
                                                                                                               (nthcdr 1 V15088)
                                                                                                               V15399)
                                                                                                              (shen/if
                                                                                                               (shen/predicate->shen
                                                                                                                (null V15089))
                                                                                                               (shen/do
                                                                                                                (shen/shen\.incinfs)
                                                                                                                (shen/thaw V15400))
                                                                                                               (shen/if
                                                                                                                (shen/shen\.pvar\? V15089)
                                                                                                                (shen/do
                                                                                                                 (shen/shen\.bindv V15089 nil V15399)
                                                                                                                 (shen/let Result
                                                                                                                           (shen/do
                                                                                                                            (shen/shen\.incinfs)
                                                                                                                            (shen/thaw V15400))
                                                                                                                           (shen/do
                                                                                                                            (shen/shen\.unbindv V15089 V15399)
                                                                                                                            Result)))
                                                                                                                'false))))
                                                                                          (shen/if
                                                                                           (shen/shen\.pvar\? V15088)
                                                                                           (shen/let A
                                                                                                     (shen/shen\.newpv V15399)
                                                                                                     (shen/do
                                                                                                      (shen/shen\.bindv V15088
                                                                                                                        (list A)
                                                                                                                        V15399)
                                                                                                      (shen/let Result
                                                                                                                (shen/do
                                                                                                                 (shen/shen\.incinfs)
                                                                                                                 (shen/thaw V15400))
                                                                                                                (shen/do
                                                                                                                 (shen/shen\.unbindv V15088 V15399)
                                                                                                                 Result))))
                                                                                           'false)))
                                                                               (shen/if
                                                                                (shen/shen\.pvar\? V15087)
                                                                                (shen/do
                                                                                 (shen/shen\.bindv V15087 'list V15399)
                                                                                 (shen/let Result
                                                                                           (shen/let V15090
                                                                                                     (shen/shen\.lazyderef
                                                                                                      (nthcdr 1 V15086)
                                                                                                      V15399)
                                                                                                     (shen/if
                                                                                                      (shen/cons\? V15090)
                                                                                                      (shen/let A
                                                                                                                (shen/hd V15090)
                                                                                                                (shen/let V15091
                                                                                                                          (shen/shen\.lazyderef
                                                                                                                           (nthcdr 1 V15090)
                                                                                                                           V15399)
                                                                                                                          (shen/if
                                                                                                                           (shen/predicate->shen
                                                                                                                            (null V15091))
                                                                                                                           (shen/do
                                                                                                                            (shen/shen\.incinfs)
                                                                                                                            (shen/thaw V15400))
                                                                                                                           (shen/if
                                                                                                                            (shen/shen\.pvar\? V15091)
                                                                                                                            (shen/do
                                                                                                                             (shen/shen\.bindv V15091 nil V15399)
                                                                                                                             (shen/let Result
                                                                                                                                       (shen/do
                                                                                                                                        (shen/shen\.incinfs)
                                                                                                                                        (shen/thaw V15400))
                                                                                                                                       (shen/do
                                                                                                                                        (shen/shen\.unbindv V15091 V15399)
                                                                                                                                        Result)))
                                                                                                                            'false))))
                                                                                                      (shen/if
                                                                                                       (shen/shen\.pvar\? V15090)
                                                                                                       (shen/let A
                                                                                                                 (shen/shen\.newpv V15399)
                                                                                                                 (shen/do
                                                                                                                  (shen/shen\.bindv V15090
                                                                                                                                    (list A)
                                                                                                                                    V15399)
                                                                                                                  (shen/let Result
                                                                                                                            (shen/do
                                                                                                                             (shen/shen\.incinfs)
                                                                                                                             (shen/thaw V15400))
                                                                                                                            (shen/do
                                                                                                                             (shen/shen\.unbindv V15090 V15399)
                                                                                                                             Result))))
                                                                                                       'false)))
                                                                                           (shen/do
                                                                                            (shen/shen\.unbindv V15087 V15399)
                                                                                            Result)))
                                                                                'false)))
                                                                    (shen/if
                                                                     (shen/shen\.pvar\? V15086)
                                                                     (shen/let A
                                                                               (shen/shen\.newpv V15399)
                                                                               (shen/do
                                                                                (shen/shen\.bindv V15086
                                                                                                  (list 'list A)
                                                                                                  V15399)
                                                                                (shen/let Result
                                                                                          (shen/do
                                                                                           (shen/shen\.incinfs)
                                                                                           (shen/thaw V15400))
                                                                                          (shen/do
                                                                                           (shen/shen\.unbindv V15086 V15399)
                                                                                           Result))))
                                                                     'false)))
                                                         'false))
                                              Case))
                                   Case))
                        Case))
             Case)))
(defun shen/shen\.by_hypothesis
    (V15406 V15407 V15408 V15409 V15410)
  (cl-flet
      ((tail-trampoline
        (V15406 V15407 V15408 V15409 V15410)
        (shen/let Case
                  (shen/let V15072
                            (shen/shen\.lazyderef V15408 V15409)
                            (shen/if
                             (shen/cons\? V15072)
                             (shen/let V15073
                                       (shen/shen\.lazyderef
                                        (shen/hd V15072)
                                        V15409)
                                       (shen/if
                                        (shen/cons\? V15073)
                                        (shen/let Y
                                                  (shen/hd V15073)
                                                  (shen/let V15074
                                                            (shen/shen\.lazyderef
                                                             (nthcdr 1 V15073)
                                                             V15409)
                                                            (shen/if
                                                             (shen/cons\? V15074)
                                                             (shen/let V15075
                                                                       (shen/shen\.lazyderef
                                                                        (shen/hd V15074)
                                                                        V15409)
                                                                       (shen/if
                                                                        (shen/= ': V15075)
                                                                        (shen/let V15076
                                                                                  (shen/shen\.lazyderef
                                                                                   (nthcdr 1 V15074)
                                                                                   V15409)
                                                                                  (shen/if
                                                                                   (shen/cons\? V15076)
                                                                                   (shen/let B
                                                                                             (shen/hd V15076)
                                                                                             (shen/let V15077
                                                                                                       (shen/shen\.lazyderef
                                                                                                        (nthcdr 1 V15076)
                                                                                                        V15409)
                                                                                                       (shen/if
                                                                                                        (shen/predicate->shen
                                                                                                         (null V15077))
                                                                                                        (shen/do
                                                                                                         (shen/shen\.incinfs)
                                                                                                         (shen/identical V15406 Y V15409
                                                                                                                         (shen/freeze
                                                                                                                          (shen/unify! V15407 B V15409 V15410))))
                                                                                                        'false)))
                                                                                   'false))
                                                                        'false))
                                                             'false)))
                                        'false))
                             'false))
                  (shen/if
                   (shen/= Case 'false)
                   (shen/let V15078
                             (shen/shen\.lazyderef V15408 V15409)
                             (shen/if
                              (shen/cons\? V15078)
                              (shen/let Hyp
                                        (nthcdr 1 V15078)
                                        (shen/do
                                         (shen/shen\.incinfs)
                                         (vector
                                          (list V15406 V15407 Hyp V15409 V15410))))
                              'false))
                   Case))))
    (let
        ((result
          (funcall #'tail-trampoline V15406 V15407 V15408 V15409 V15410)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.t*-def
    (V15416 V15417 V15418 V15419 V15420)
  (shen/let V15066
            (shen/shen\.lazyderef V15416 V15419)
            (shen/if
             (shen/cons\? V15066)
             (shen/let V15067
                       (shen/shen\.lazyderef
                        (shen/hd V15066)
                        V15419)
                       (shen/if
                        (shen/= 'define V15067)
                        (shen/let V15068
                                  (shen/shen\.lazyderef
                                   (nthcdr 1 V15066)
                                   V15419)
                                  (shen/if
                                   (shen/cons\? V15068)
                                   (shen/let F
                                             (shen/hd V15068)
                                             (shen/let X
                                                       (nthcdr 1 V15068)
                                                       (shen/let Y
                                                                 (shen/shen\.newpv V15419)
                                                                 (shen/let E
                                                                           (shen/shen\.newpv V15419)
                                                                           (shen/do
                                                                            (shen/shen\.incinfs)
                                                                            (shen/shen\.t*-defh
                                                                             (shen/compile
                                                                              (shen/lambda Y
                                                                                           (shen/shen\.<sig+rules> Y))
                                                                              X
                                                                              (shen/lambda E
                                                                                           (shen/if
                                                                                            (shen/cons\? E)
                                                                                            (shen/simple-error
                                                                                             (shen/cn "parse error here: "
                                                                                                      (shen/shen\.app E "\n" 'shen\.s)))
                                                                                            (shen/simple-error "parse error\n"))))
                                                                             F V15417 V15418 V15419 V15420))))))
                                   'false))
                        'false))
             'false)))
(defun shen/shen\.t*-defh
    (V15427 V15428 V15429 V15430 V15431 V15432)
  (shen/let V15062
            (shen/shen\.lazyderef V15427 V15431)
            (shen/if
             (shen/cons\? V15062)
             (shen/let Sig
                       (shen/hd V15062)
                       (shen/let Rules
                                 (nthcdr 1 V15062)
                                 (shen/do
                                  (shen/shen\.incinfs)
                                  (shen/shen\.t*-defhh Sig
                                                       (shen/shen\.ue-sig Sig)
                                                       V15428 V15429 V15430 Rules V15431 V15432))))
             'false)))
(defun shen/shen\.t*-defhh
    (V15441 V15442 V15443 V15444 V15445 V15446 V15447 V15448)
  (shen/do
   (shen/shen\.incinfs)
   (shen/shen\.t*-rules V15446 V15442 1 V15443
                        (append
                         (list
                          (list V15443 ': V15442))
                         V15445)
                        V15447
                        (shen/freeze
                         (shen/shen\.memo V15443 V15441 V15444 V15447 V15448)))))
(defun shen/shen\.memo
    (V15454 V15455 V15456 V15457 V15458)
  (shen/let Jnk
            (shen/shen\.newpv V15457)
            (shen/do
             (shen/shen\.incinfs)
             (shen/unify! V15456 V15455 V15457
                          (shen/freeze
                           (shen/bind Jnk
                                      (shen/declare
                                       (shen/shen\.lazyderef V15454 V15457)
                                       (shen/shen\.lazyderef V15456 V15457))
                                      V15457 V15458))))))
(defun shen/shen\.<sig+rules>
    (V15460)
  (shen/let Parse_shen\.<signature>
            (shen/shen\.<signature> V15460)
            (shen/if
             (shen/not
              (shen/=
               (shen/fail)
               Parse_shen\.<signature>))
             (shen/let Parse_shen\.<non-ll-rules>
                       (shen/shen\.<non-ll-rules> Parse_shen\.<signature>)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<non-ll-rules>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<non-ll-rules>)
                         (append
                          (list
                           (shen/shen\.hdtl Parse_shen\.<signature>))
                          (shen/shen\.hdtl Parse_shen\.<non-ll-rules>)))
                        (shen/fail)))
             (shen/fail))))
(defun shen/shen\.<non-ll-rules>
    (V15462)
  (shen/let YaccParse
            (shen/let Parse_shen\.<rule>
                      (shen/shen\.<rule> V15462)
                      (shen/if
                       (shen/not
                        (shen/=
                         (shen/fail)
                         Parse_shen\.<rule>))
                       (shen/let Parse_shen\.<non-ll-rules>
                                 (shen/shen\.<non-ll-rules> Parse_shen\.<rule>)
                                 (shen/if
                                  (shen/not
                                   (shen/=
                                    (shen/fail)
                                    Parse_shen\.<non-ll-rules>))
                                  (shen/shen\.pair
                                   (shen/hd Parse_shen\.<non-ll-rules>)
                                   (append
                                    (list
                                     (shen/shen\.hdtl Parse_shen\.<rule>))
                                    (shen/shen\.hdtl Parse_shen\.<non-ll-rules>)))
                                  (shen/fail)))
                       (shen/fail)))
            (shen/if
             (shen/= YaccParse
                     (shen/fail))
             (shen/let Parse_shen\.<rule>
                       (shen/shen\.<rule> V15462)
                       (shen/if
                        (shen/not
                         (shen/=
                          (shen/fail)
                          Parse_shen\.<rule>))
                        (shen/shen\.pair
                         (shen/hd Parse_shen\.<rule>)
                         (list
                          (shen/shen\.hdtl Parse_shen\.<rule>)))
                        (shen/fail)))
             YaccParse)))
(defun shen/shen\.ue
    (V15464)
  (shen/cond
   ((shen/and
     (shen/cons\? V15464)
     (shen/and
      (shen/cons\?
       (nthcdr 1 V15464))
      (shen/and
       (shen/predicate->shen
        (null
         (nthcdr 2 V15464)))
       (shen/=
        (shen/hd V15464)
        'protect))))
    V15464)
   ((shen/cons\? V15464)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.ue Z))
     V15464))
   ((shen/variable\? V15464)
    (shen/concat '&& V15464))
   (shen/true V15464)))
(defun shen/shen\.ue-sig
    (V15466)
  (shen/cond
   ((shen/cons\? V15466)
    (shen/map
     (shen/lambda Z
                  (shen/shen\.ue-sig Z))
     V15466))
   ((shen/variable\? V15466)
    (shen/concat '&&& V15466))
   (shen/true V15466)))
(defun shen/shen\.ues
    (V15472)
  (shen/cond
   ((shen/shen\.ue\? V15472)
    (list V15472))
   ((shen/cons\? V15472)
    (shen/union
     (shen/shen\.ues
      (shen/hd V15472))
     (shen/shen\.ues
      (nthcdr 1 V15472))))
   (shen/true nil)))
(defun shen/shen\.ue\?
    (V15474)
  (shen/and
   (shen/symbol\? V15474)
   (shen/shen\.ue-h\?
    (shen/str V15474))))
(defun shen/shen\.ue-h\?
    (V15482)
  (shen/cond
   ((shen/and
     (shen/shen\.+string\? V15482)
     (shen/and
      (shen/= "&"
              (shen/pos V15482 0))
      (shen/and
       (shen/shen\.+string\?
        (shen/tlstr V15482))
       (shen/= "&"
               (shen/pos
                (shen/tlstr V15482)
                0)))))
    'true)
   (shen/true 'false)))
(defun shen/shen\.t*-rules
    (V15490 V15491 V15492 V15493 V15494 V15495 V15496)
  (shen/let Throwcontrol
            (shen/shen\.catchpoint)
            (shen/shen\.cutpoint Throwcontrol
                                 (shen/let Case
                                           (shen/let V15046
                                                     (shen/shen\.lazyderef V15490 V15495)
                                                     (shen/if
                                                      (shen/predicate->shen
                                                       (null V15046))
                                                      (shen/do
                                                       (shen/shen\.incinfs)
                                                       (shen/thaw V15496))
                                                      'false))
                                           (shen/if
                                            (shen/= Case 'false)
                                            (shen/let Case
                                                      (shen/let V15047
                                                                (shen/shen\.lazyderef V15490 V15495)
                                                                (shen/if
                                                                 (shen/cons\? V15047)
                                                                 (shen/let Rule
                                                                           (shen/hd V15047)
                                                                           (shen/let Rules
                                                                                     (nthcdr 1 V15047)
                                                                                     (shen/do
                                                                                      (shen/shen\.incinfs)
                                                                                      (shen/shen\.t*-rule
                                                                                       (shen/shen\.ue Rule)
                                                                                       V15491 V15494 V15495
                                                                                       (shen/freeze
                                                                                        (shen/cut Throwcontrol V15495
                                                                                                  (shen/freeze
                                                                                                   (shen/shen\.t*-rules Rules V15491
                                                                                                                        (1+ V15492)
                                                                                                                        V15493 V15494 V15495 V15496))))))))
                                                                 'false))
                                                      (shen/if
                                                       (shen/= Case 'false)
                                                       (shen/let Err
                                                                 (shen/shen\.newpv V15495)
                                                                 (shen/do
                                                                  (shen/shen\.incinfs)
                                                                  (shen/bind Err
                                                                             (shen/simple-error
                                                                              (shen/cn "type error in rule "
                                                                                       (shen/shen\.app
                                                                                        (shen/shen\.lazyderef V15492 V15495)
                                                                                        (shen/cn " of "
                                                                                                 (shen/shen\.app
                                                                                                  (shen/shen\.lazyderef V15493 V15495)
                                                                                                  "" 'shen\.a))
                                                                                        'shen\.a)))
                                                                             V15495 V15496)))
                                                       Case))
                                            Case)))))
(defun shen/shen\.t*-rule
    (V15502 V15503 V15504 V15505 V15506)
  (shen/let Throwcontrol
            (shen/shen\.catchpoint)
            (shen/shen\.cutpoint Throwcontrol
                                 (shen/let V15038
                                           (shen/shen\.lazyderef V15502 V15505)
                                           (shen/if
                                            (shen/cons\? V15038)
                                            (shen/let Patterns
                                                      (shen/hd V15038)
                                                      (shen/let V15039
                                                                (shen/shen\.lazyderef
                                                                 (nthcdr 1 V15038)
                                                                 V15505)
                                                                (shen/if
                                                                 (shen/cons\? V15039)
                                                                 (shen/let Action
                                                                           (shen/hd V15039)
                                                                           (shen/let V15040
                                                                                     (shen/shen\.lazyderef
                                                                                      (nthcdr 1 V15039)
                                                                                      V15505)
                                                                                     (shen/if
                                                                                      (shen/predicate->shen
                                                                                       (null V15040))
                                                                                      (shen/let NewHyps
                                                                                                (shen/shen\.newpv V15505)
                                                                                                (shen/do
                                                                                                 (shen/shen\.incinfs)
                                                                                                 (shen/shen\.newhyps
                                                                                                  (shen/shen\.placeholders Patterns)
                                                                                                  V15504 NewHyps V15505
                                                                                                  (shen/freeze
                                                                                                   (shen/shen\.t*-patterns Patterns V15503 NewHyps V15505
                                                                                                                           (shen/freeze
                                                                                                                            (shen/cut Throwcontrol V15505
                                                                                                                                      (shen/freeze
                                                                                                                                       (shen/shen\.t*-action
                                                                                                                                        (shen/shen\.curry
                                                                                                                                         (shen/shen\.ue Action))
                                                                                                                                        (shen/shen\.result-type Patterns V15503)
                                                                                                                                        (shen/shen\.patthyps Patterns V15503 V15504)
                                                                                                                                        V15505 V15506)))))))))
                                                                                      'false)))
                                                                 'false)))
                                            'false)))))
(defun shen/shen\.placeholders
    (V15512)
  (shen/cond
   ((shen/shen\.ue\? V15512)
    (list V15512))
   ((shen/cons\? V15512)
    (shen/union
     (shen/shen\.placeholders
      (shen/hd V15512))
     (shen/shen\.placeholders
      (nthcdr 1 V15512))))
   (shen/true nil)))
(defun shen/shen\.newhyps
    (V15518 V15519 V15520 V15521 V15522)
  (shen/let Case
            (shen/let V15025
                      (shen/shen\.lazyderef V15518 V15521)
                      (shen/if
                       (shen/predicate->shen
                        (null V15025))
                       (shen/do
                        (shen/shen\.incinfs)
                        (shen/unify! V15520 V15519 V15521 V15522))
                       'false))
            (shen/if
             (shen/= Case 'false)
             (shen/let V15026
                       (shen/shen\.lazyderef V15518 V15521)
                       (shen/if
                        (shen/cons\? V15026)
                        (shen/let V15021
                                  (shen/hd V15026)
                                  (shen/let Vs
                                            (nthcdr 1 V15026)
                                            (shen/let V15027
                                                      (shen/shen\.lazyderef V15520 V15521)
                                                      (shen/if
                                                       (shen/cons\? V15027)
                                                       (shen/let V15028
                                                                 (shen/shen\.lazyderef
                                                                  (shen/hd V15027)
                                                                  V15521)
                                                                 (shen/if
                                                                  (shen/cons\? V15028)
                                                                  (shen/let V
                                                                            (shen/hd V15028)
                                                                            (shen/let V15029
                                                                                      (shen/shen\.lazyderef
                                                                                       (nthcdr 1 V15028)
                                                                                       V15521)
                                                                                      (shen/if
                                                                                       (shen/cons\? V15029)
                                                                                       (shen/let V15030
                                                                                                 (shen/shen\.lazyderef
                                                                                                  (shen/hd V15029)
                                                                                                  V15521)
                                                                                                 (shen/if
                                                                                                  (shen/= ': V15030)
                                                                                                  (shen/let V15031
                                                                                                            (shen/shen\.lazyderef
                                                                                                             (nthcdr 1 V15029)
                                                                                                             V15521)
                                                                                                            (shen/if
                                                                                                             (shen/cons\? V15031)
                                                                                                             (shen/let A
                                                                                                                       (shen/hd V15031)
                                                                                                                       (shen/let V15032
                                                                                                                                 (shen/shen\.lazyderef
                                                                                                                                  (nthcdr 1 V15031)
                                                                                                                                  V15521)
                                                                                                                                 (shen/if
                                                                                                                                  (shen/predicate->shen
                                                                                                                                   (null V15032))
                                                                                                                                  (shen/let NewHyp
                                                                                                                                            (nthcdr 1 V15027)
                                                                                                                                            (shen/do
                                                                                                                                             (shen/shen\.incinfs)
                                                                                                                                             (shen/unify! V V15021 V15521
                                                                                                                                                          (shen/freeze
                                                                                                                                                           (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                                                  (shen/if
                                                                                                                                   (shen/shen\.pvar\? V15032)
                                                                                                                                   (shen/do
                                                                                                                                    (shen/shen\.bindv V15032 nil V15521)
                                                                                                                                    (shen/let Result
                                                                                                                                              (shen/let NewHyp
                                                                                                                                                        (nthcdr 1 V15027)
                                                                                                                                                        (shen/do
                                                                                                                                                         (shen/shen\.incinfs)
                                                                                                                                                         (shen/unify! V V15021 V15521
                                                                                                                                                                      (shen/freeze
                                                                                                                                                                       (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                                                              (shen/do
                                                                                                                                               (shen/shen\.unbindv V15032 V15521)
                                                                                                                                               Result)))
                                                                                                                                   'false))))
                                                                                                             (shen/if
                                                                                                              (shen/shen\.pvar\? V15031)
                                                                                                              (shen/let A
                                                                                                                        (shen/shen\.newpv V15521)
                                                                                                                        (shen/do
                                                                                                                         (shen/shen\.bindv V15031
                                                                                                                                           (list A)
                                                                                                                                           V15521)
                                                                                                                         (shen/let Result
                                                                                                                                   (shen/let NewHyp
                                                                                                                                             (nthcdr 1 V15027)
                                                                                                                                             (shen/do
                                                                                                                                              (shen/shen\.incinfs)
                                                                                                                                              (shen/unify! V V15021 V15521
                                                                                                                                                           (shen/freeze
                                                                                                                                                            (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                                                   (shen/do
                                                                                                                                    (shen/shen\.unbindv V15031 V15521)
                                                                                                                                    Result))))
                                                                                                              'false)))
                                                                                                  (shen/if
                                                                                                   (shen/shen\.pvar\? V15030)
                                                                                                   (shen/do
                                                                                                    (shen/shen\.bindv V15030 ': V15521)
                                                                                                    (shen/let Result
                                                                                                              (shen/let V15033
                                                                                                                        (shen/shen\.lazyderef
                                                                                                                         (nthcdr 1 V15029)
                                                                                                                         V15521)
                                                                                                                        (shen/if
                                                                                                                         (shen/cons\? V15033)
                                                                                                                         (shen/let A
                                                                                                                                   (shen/hd V15033)
                                                                                                                                   (shen/let V15034
                                                                                                                                             (shen/shen\.lazyderef
                                                                                                                                              (nthcdr 1 V15033)
                                                                                                                                              V15521)
                                                                                                                                             (shen/if
                                                                                                                                              (shen/predicate->shen
                                                                                                                                               (null V15034))
                                                                                                                                              (shen/let NewHyp
                                                                                                                                                        (nthcdr 1 V15027)
                                                                                                                                                        (shen/do
                                                                                                                                                         (shen/shen\.incinfs)
                                                                                                                                                         (shen/unify! V V15021 V15521
                                                                                                                                                                      (shen/freeze
                                                                                                                                                                       (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                                                              (shen/if
                                                                                                                                               (shen/shen\.pvar\? V15034)
                                                                                                                                               (shen/do
                                                                                                                                                (shen/shen\.bindv V15034 nil V15521)
                                                                                                                                                (shen/let Result
                                                                                                                                                          (shen/let NewHyp
                                                                                                                                                                    (nthcdr 1 V15027)
                                                                                                                                                                    (shen/do
                                                                                                                                                                     (shen/shen\.incinfs)
                                                                                                                                                                     (shen/unify! V V15021 V15521
                                                                                                                                                                                  (shen/freeze
                                                                                                                                                                                   (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                                                                          (shen/do
                                                                                                                                                           (shen/shen\.unbindv V15034 V15521)
                                                                                                                                                           Result)))
                                                                                                                                               'false))))
                                                                                                                         (shen/if
                                                                                                                          (shen/shen\.pvar\? V15033)
                                                                                                                          (shen/let A
                                                                                                                                    (shen/shen\.newpv V15521)
                                                                                                                                    (shen/do
                                                                                                                                     (shen/shen\.bindv V15033
                                                                                                                                                       (list A)
                                                                                                                                                       V15521)
                                                                                                                                     (shen/let Result
                                                                                                                                               (shen/let NewHyp
                                                                                                                                                         (nthcdr 1 V15027)
                                                                                                                                                         (shen/do
                                                                                                                                                          (shen/shen\.incinfs)
                                                                                                                                                          (shen/unify! V V15021 V15521
                                                                                                                                                                       (shen/freeze
                                                                                                                                                                        (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                                                               (shen/do
                                                                                                                                                (shen/shen\.unbindv V15033 V15521)
                                                                                                                                                Result))))
                                                                                                                          'false)))
                                                                                                              (shen/do
                                                                                                               (shen/shen\.unbindv V15030 V15521)
                                                                                                               Result)))
                                                                                                   'false)))
                                                                                       (shen/if
                                                                                        (shen/shen\.pvar\? V15029)
                                                                                        (shen/let A
                                                                                                  (shen/shen\.newpv V15521)
                                                                                                  (shen/do
                                                                                                   (shen/shen\.bindv V15029
                                                                                                                     (list ': A)
                                                                                                                     V15521)
                                                                                                   (shen/let Result
                                                                                                             (shen/let NewHyp
                                                                                                                       (nthcdr 1 V15027)
                                                                                                                       (shen/do
                                                                                                                        (shen/shen\.incinfs)
                                                                                                                        (shen/unify! V V15021 V15521
                                                                                                                                     (shen/freeze
                                                                                                                                      (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                             (shen/do
                                                                                                              (shen/shen\.unbindv V15029 V15521)
                                                                                                              Result))))
                                                                                        'false))))
                                                                  (shen/if
                                                                   (shen/shen\.pvar\? V15028)
                                                                   (shen/let V
                                                                             (shen/shen\.newpv V15521)
                                                                             (shen/let A
                                                                                       (shen/shen\.newpv V15521)
                                                                                       (shen/do
                                                                                        (shen/shen\.bindv V15028
                                                                                                          (list V ': A)
                                                                                                          V15521)
                                                                                        (shen/let Result
                                                                                                  (shen/let NewHyp
                                                                                                            (nthcdr 1 V15027)
                                                                                                            (shen/do
                                                                                                             (shen/shen\.incinfs)
                                                                                                             (shen/unify! V V15021 V15521
                                                                                                                          (shen/freeze
                                                                                                                           (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522)))))
                                                                                                  (shen/do
                                                                                                   (shen/shen\.unbindv V15028 V15521)
                                                                                                   Result)))))
                                                                   'false)))
                                                       (shen/if
                                                        (shen/shen\.pvar\? V15027)
                                                        (shen/let V
                                                                  (shen/shen\.newpv V15521)
                                                                  (shen/let A
                                                                            (shen/shen\.newpv V15521)
                                                                            (shen/let NewHyp
                                                                                      (shen/shen\.newpv V15521)
                                                                                      (shen/do
                                                                                       (shen/shen\.bindv V15027
                                                                                                         (append
                                                                                                          (list
                                                                                                           (list V ': A))
                                                                                                          NewHyp)
                                                                                                         V15521)
                                                                                       (shen/let Result
                                                                                                 (shen/do
                                                                                                  (shen/shen\.incinfs)
                                                                                                  (shen/unify! V V15021 V15521
                                                                                                               (shen/freeze
                                                                                                                (shen/shen\.newhyps Vs V15519 NewHyp V15521 V15522))))
                                                                                                 (shen/do
                                                                                                  (shen/shen\.unbindv V15027 V15521)
                                                                                                  Result))))))
                                                        'false)))))
                        'false))
             Case)))
(defun shen/shen\.patthyps
    (V15528 V15529 V15530)
  (shen/cond
   ((shen/predicate->shen
     (null V15528))
    V15530)
   ((shen/and
     (shen/cons\? V15528)
     (shen/and
      (shen/cons\? V15529)
      (shen/and
       (shen/cons\?
        (nthcdr 1 V15529))
       (shen/and
        (shen/= '-->
                (shen/hd
                 (nthcdr 1 V15529)))
        (shen/and
         (shen/cons\?
          (nthcdr 2 V15529))
         (shen/predicate->shen
          (null
           (nthcdr 3 V15529))))))))
    (shen/adjoin
     (list
      (shen/hd V15528)
      ':
      (shen/hd V15529))
     (shen/shen\.patthyps
      (nthcdr 1 V15528)
      (shen/hd
       (nthcdr 2 V15529))
      V15530)))
   (shen/true
    (shen/shen\.f_error 'shen\.patthyps))))
(defun shen/shen\.result-type
    (V15537 V15538)
  (cl-flet
      ((tail-trampoline
        (V15537 V15538)
        (shen/cond
         ((shen/and
           (shen/predicate->shen
            (null V15537))
           (shen/and
            (shen/cons\? V15538)
            (shen/and
             (shen/= '-->
                     (shen/hd V15538))
             (shen/and
              (shen/cons\?
               (nthcdr 1 V15538))
              (shen/predicate->shen
               (null
                (nthcdr 2 V15538)))))))
          (shen/hd
           (nthcdr 1 V15538)))
         ((shen/predicate->shen
           (null V15537))
          V15538)
         ((shen/and
           (shen/cons\? V15537)
           (shen/and
            (shen/cons\? V15538)
            (shen/and
             (shen/cons\?
              (nthcdr 1 V15538))
             (shen/and
              (shen/= '-->
                      (shen/hd
                       (nthcdr 1 V15538)))
              (shen/and
               (shen/cons\?
                (nthcdr 2 V15538))
               (shen/predicate->shen
                (null
                 (nthcdr 3 V15538))))))))
          (vector
           (list
            (nthcdr 1 V15537)
            (shen/hd
             (nthcdr 2 V15538)))))
         (shen/true
          (shen/shen\.f_error 'shen\.result-type)))))
    (let
        ((result
          (funcall #'tail-trampoline V15537 V15538)))
      (while
          (vectorp result)
        (setq result
              (apply #'tail-trampoline
                     (aref result 0))))
      result)))
(defun shen/shen\.t*-patterns
    (V15544 V15545 V15546 V15547 V15548)
  (shen/let Case
            (shen/let V15013
                      (shen/shen\.lazyderef V15544 V15547)
                      (shen/if
                       (shen/predicate->shen
                        (null V15013))
                       (shen/do
                        (shen/shen\.incinfs)
                        (shen/thaw V15548))
                       'false))
            (shen/if
             (shen/= Case 'false)
             (shen/let V15014
                       (shen/shen\.lazyderef V15544 V15547)
                       (shen/if
                        (shen/cons\? V15014)
                        (shen/let Pattern
                                  (shen/hd V15014)
                                  (shen/let Patterns
                                            (nthcdr 1 V15014)
                                            (shen/let V15015
                                                      (shen/shen\.lazyderef V15545 V15547)
                                                      (shen/if
                                                       (shen/cons\? V15015)
                                                       (shen/let A
                                                                 (shen/hd V15015)
                                                                 (shen/let V15016
                                                                           (shen/shen\.lazyderef
                                                                            (nthcdr 1 V15015)
                                                                            V15547)
                                                                           (shen/if
                                                                            (shen/cons\? V15016)
                                                                            (shen/let V15017
                                                                                      (shen/shen\.lazyderef
                                                                                       (shen/hd V15016)
                                                                                       V15547)
                                                                                      (shen/if
                                                                                       (shen/= '--> V15017)
                                                                                       (shen/let V15018
                                                                                                 (shen/shen\.lazyderef
                                                                                                  (nthcdr 1 V15016)
                                                                                                  V15547)
                                                                                                 (shen/if
                                                                                                  (shen/cons\? V15018)
                                                                                                  (shen/let B
                                                                                                            (shen/hd V15018)
                                                                                                            (shen/let V15019
                                                                                                                      (shen/shen\.lazyderef
                                                                                                                       (nthcdr 1 V15018)
                                                                                                                       V15547)
                                                                                                                      (shen/if
                                                                                                                       (shen/predicate->shen
                                                                                                                        (null V15019))
                                                                                                                       (shen/do
                                                                                                                        (shen/shen\.incinfs)
                                                                                                                        (shen/shen\.t*
                                                                                                                         (list Pattern ': A)
                                                                                                                         V15546 V15547
                                                                                                                         (shen/freeze
                                                                                                                          (shen/shen\.t*-patterns Patterns B V15546 V15547 V15548))))
                                                                                                                       'false)))
                                                                                                  'false))
                                                                                       'false))
                                                                            'false)))
                                                       'false))))
                        'false))
             Case)))
(defun shen/shen\.t*-action
    (V15554 V15555 V15556 V15557 V15558)
  (shen/let Throwcontrol
            (shen/shen\.catchpoint)
            (shen/shen\.cutpoint Throwcontrol
                                 (shen/let Case
                                           (shen/let V14990
                                                     (shen/shen\.lazyderef V15554 V15557)
                                                     (shen/if
                                                      (shen/cons\? V14990)
                                                      (shen/let V14991
                                                                (shen/shen\.lazyderef
                                                                 (shen/hd V14990)
                                                                 V15557)
                                                                (shen/if
                                                                 (shen/= 'where V14991)
                                                                 (shen/let V14992
                                                                           (shen/shen\.lazyderef
                                                                            (nthcdr 1 V14990)
                                                                            V15557)
                                                                           (shen/if
                                                                            (shen/cons\? V14992)
                                                                            (shen/let P
                                                                                      (shen/hd V14992)
                                                                                      (shen/let V14993
                                                                                                (shen/shen\.lazyderef
                                                                                                 (nthcdr 1 V14992)
                                                                                                 V15557)
                                                                                                (shen/if
                                                                                                 (shen/cons\? V14993)
                                                                                                 (shen/let Action
                                                                                                           (shen/hd V14993)
                                                                                                           (shen/let V14994
                                                                                                                     (shen/shen\.lazyderef
                                                                                                                      (nthcdr 1 V14993)
                                                                                                                      V15557)
                                                                                                                     (shen/if
                                                                                                                      (shen/predicate->shen
                                                                                                                       (null V14994))
                                                                                                                      (shen/do
                                                                                                                       (shen/shen\.incinfs)
                                                                                                                       (shen/cut Throwcontrol V15557
                                                                                                                                 (shen/freeze
                                                                                                                                  (shen/shen\.t*
                                                                                                                                   (list P ': 'boolean)
                                                                                                                                   V15556 V15557
                                                                                                                                   (shen/freeze
                                                                                                                                    (shen/cut Throwcontrol V15557
                                                                                                                                              (shen/freeze
                                                                                                                                               (shen/shen\.t*-action Action V15555
                                                                                                                                                                     (append
                                                                                                                                                                      (list
                                                                                                                                                                       (list P ': 'verified))
                                                                                                                                                                      V15556)
                                                                                                                                                                     V15557 V15558))))))))
                                                                                                                      'false)))
                                                                                                 'false)))
                                                                            'false))
                                                                 'false))
                                                      'false))
                                           (shen/if
                                            (shen/= Case 'false)
                                            (shen/let Case
                                                      (shen/let V14995
                                                                (shen/shen\.lazyderef V15554 V15557)
                                                                (shen/if
                                                                 (shen/cons\? V14995)
                                                                 (shen/let V14996
                                                                           (shen/shen\.lazyderef
                                                                            (shen/hd V14995)
                                                                            V15557)
                                                                           (shen/if
                                                                            (shen/= 'shen\.choicepoint! V14996)
                                                                            (shen/let V14997
                                                                                      (shen/shen\.lazyderef
                                                                                       (nthcdr 1 V14995)
                                                                                       V15557)
                                                                                      (shen/if
                                                                                       (shen/cons\? V14997)
                                                                                       (shen/let V14998
                                                                                                 (shen/shen\.lazyderef
                                                                                                  (shen/hd V14997)
                                                                                                  V15557)
                                                                                                 (shen/if
                                                                                                  (shen/cons\? V14998)
                                                                                                  (shen/let V14999
                                                                                                            (shen/shen\.lazyderef
                                                                                                             (shen/hd V14998)
                                                                                                             V15557)
                                                                                                            (shen/if
                                                                                                             (shen/cons\? V14999)
                                                                                                             (shen/let V15000
                                                                                                                       (shen/shen\.lazyderef
                                                                                                                        (shen/hd V14999)
                                                                                                                        V15557)
                                                                                                                       (shen/if
                                                                                                                        (shen/= 'fail-if V15000)
                                                                                                                        (shen/let V15001
                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                   (nthcdr 1 V14999)
                                                                                                                                   V15557)
                                                                                                                                  (shen/if
                                                                                                                                   (shen/cons\? V15001)
                                                                                                                                   (shen/let F
                                                                                                                                             (shen/hd V15001)
                                                                                                                                             (shen/let V15002
                                                                                                                                                       (shen/shen\.lazyderef
                                                                                                                                                        (nthcdr 1 V15001)
                                                                                                                                                        V15557)
                                                                                                                                                       (shen/if
                                                                                                                                                        (shen/predicate->shen
                                                                                                                                                         (null V15002))
                                                                                                                                                        (shen/let V15003
                                                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                                                   (nthcdr 1 V14998)
                                                                                                                                                                   V15557)
                                                                                                                                                                  (shen/if
                                                                                                                                                                   (shen/cons\? V15003)
                                                                                                                                                                   (shen/let Action
                                                                                                                                                                             (shen/hd V15003)
                                                                                                                                                                             (shen/let V15004
                                                                                                                                                                                       (shen/shen\.lazyderef
                                                                                                                                                                                        (nthcdr 1 V15003)
                                                                                                                                                                                        V15557)
                                                                                                                                                                                       (shen/if
                                                                                                                                                                                        (shen/predicate->shen
                                                                                                                                                                                         (null V15004))
                                                                                                                                                                                        (shen/let V15005
                                                                                                                                                                                                  (shen/shen\.lazyderef
                                                                                                                                                                                                   (nthcdr 1 V14997)
                                                                                                                                                                                                   V15557)
                                                                                                                                                                                                  (shen/if
                                                                                                                                                                                                   (shen/predicate->shen
                                                                                                                                                                                                    (null V15005))
                                                                                                                                                                                                   (shen/do
                                                                                                                                                                                                    (shen/shen\.incinfs)
                                                                                                                                                                                                    (shen/cut Throwcontrol V15557
                                                                                                                                                                                                              (shen/freeze
                                                                                                                                                                                                               (shen/shen\.t*-action
                                                                                                                                                                                                                (list 'where
                                                                                                                                                                                                                      (list 'not
                                                                                                                                                                                                                            (list F Action))
                                                                                                                                                                                                                      Action)
                                                                                                                                                                                                                V15555 V15556 V15557 V15558))))
                                                                                                                                                                                                   'false))
                                                                                                                                                                                        'false)))
                                                                                                                                                                   'false))
                                                                                                                                                        'false)))
                                                                                                                                   'false))
                                                                                                                        'false))
                                                                                                             'false))
                                                                                                  'false))
                                                                                       'false))
                                                                            'false))
                                                                 'false))
                                                      (shen/if
                                                       (shen/= Case 'false)
                                                       (shen/let Case
                                                                 (shen/let V15006
                                                                           (shen/shen\.lazyderef V15554 V15557)
                                                                           (shen/if
                                                                            (shen/cons\? V15006)
                                                                            (shen/let V15007
                                                                                      (shen/shen\.lazyderef
                                                                                       (shen/hd V15006)
                                                                                       V15557)
                                                                                      (shen/if
                                                                                       (shen/= 'shen\.choicepoint! V15007)
                                                                                       (shen/let V15008
                                                                                                 (shen/shen\.lazyderef
                                                                                                  (nthcdr 1 V15006)
                                                                                                  V15557)
                                                                                                 (shen/if
                                                                                                  (shen/cons\? V15008)
                                                                                                  (shen/let Action
                                                                                                            (shen/hd V15008)
                                                                                                            (shen/let V15009
                                                                                                                      (shen/shen\.lazyderef
                                                                                                                       (nthcdr 1 V15008)
                                                                                                                       V15557)
                                                                                                                      (shen/if
                                                                                                                       (shen/predicate->shen
                                                                                                                        (null V15009))
                                                                                                                       (shen/do
                                                                                                                        (shen/shen\.incinfs)
                                                                                                                        (shen/cut Throwcontrol V15557
                                                                                                                                  (shen/freeze
                                                                                                                                   (shen/shen\.t*-action
                                                                                                                                    (list 'where
                                                                                                                                          (list 'not
                                                                                                                                                (list
                                                                                                                                                 (list '= Action)
                                                                                                                                                 (list 'fail)))
                                                                                                                                          Action)
                                                                                                                                    V15555 V15556 V15557 V15558))))
                                                                                                                       'false)))
                                                                                                  'false))
                                                                                       'false))
                                                                            'false))
                                                                 (shen/if
                                                                  (shen/= Case 'false)
                                                                  (shen/do
                                                                   (shen/shen\.incinfs)
                                                                   (shen/shen\.t*
                                                                    (list V15554 ': V15555)
                                                                    V15556 V15557 V15558))
                                                                  Case))
                                                       Case))
                                            Case)))))
(defun shen/findall
    (V15564 V15565 V15566 V15567 V15568)
  (shen/let B
            (shen/shen\.newpv V15567)
            (shen/let A
                      (shen/shen\.newpv V15567)
                      (shen/do
                       (shen/shen\.incinfs)
                       (shen/bind A
                                  (shen/gensym 'shen\.a)
                                  V15567
                                  (shen/freeze
                                   (shen/bind B
                                              (shen/set
                                               (shen/shen\.lazyderef A V15567)
                                               nil)
                                              V15567
                                              (shen/freeze
                                               (shen/shen\.findallhelp V15564 V15565 V15566 A V15567 V15568)))))))))
(defun shen/shen\.findallhelp
    (V15575 V15576 V15577 V15578 V15579 V15580)
  (shen/let Case
            (shen/do
             (shen/shen\.incinfs)
             (shen/call V15576 V15579
                        (shen/freeze
                         (shen/shen\.remember V15578 V15575 V15579
                                              (shen/freeze
                                               (shen/fwhen 'false V15579 V15580))))))
            (shen/if
             (shen/= Case 'false)
             (shen/do
              (shen/shen\.incinfs)
              (shen/bind V15577
                         (shen/value
                          (shen/shen\.lazyderef V15578 V15579))
                         V15579 V15580))
             Case)))
(defun shen/shen\.remember
    (V15585 V15586 V15587 V15588)
  (shen/let B
            (shen/shen\.newpv V15587)
            (shen/do
             (shen/shen\.incinfs)
             (shen/bind B
                        (shen/set
                         (shen/shen\.deref V15585 V15587)
                         (append
                          (list
                           (shen/shen\.deref V15586 V15587))
                          (shen/value
                           (shen/shen\.deref V15585 V15587))))
                        V15587 V15588))))
(provide 'shen)
